;---------------------------------------------------------------------------
; Stand
[Statedef 0]
type = S
physics = S
sprpriority = 0

[State 0, CtrlSet]
type = CtrlSet
trigger1 = enemy,var(47) > 0
trigger1 = time = 0
value = 0

[State 0, CtrlSet]
type = CtrlSet
trigger1 = time = 1
value = 1

;===HS

[State 0, 1]
type = ChangeAnim
triggerall=var(27)=0
trigger1 = Anim != 0 && Anim != 5
trigger2 = Anim = 5 && AnimTime = 0 ;Turn anim over
value = 0

[State 0, 1]
type = ChangeAnim
triggerall=var(27)=1
trigger1 = Anim != 1 && Anim != 5
trigger2 = Anim = 5 && AnimTime = 0 ;Turn anim over
value = 1

[State 0, 1]
type = ChangeAnim
triggerall=var(27)=2
;triggerall=fvar(7)=0
trigger1 = Anim != 2 && Anim != 5
trigger2 = Anim = 5 && AnimTime = 0 ;Turn anim over
value = 2

[State 0, 2]
type = VelSet
trigger1 = Time = 0
y = 0

[State 0, 3] ;Stop moving if low velocity or 4 ticks pass
type = VelSet
trigger1 = abs(ceil(vel x)) < 2
trigger2 = Time = 4
x = 0

[state 0, super armor anim change]
type = ChangeAnim
trigger1=var(27)=0
;trigger1=fvar(7)=1
trigger1 = Time = 0 && Anim != 2
value = 0

[State 0, super armor damage]
type = LifeAdd
trigger1 = Time = 0
value = -(gethitvar(damage))

[state 0, super armor hitcounter]
type=varadd
trigger1=enemynear,movetype=A
trigger1=enemynear,movecontact
fv=5
value=1
persistent=0

[state 0, ctrlset]
type=ctrlset
trigger1=var(27)=0
trigger1=fvar(7)=1
value=1

[State 0, 4] ;Are you dead?
type = ChangeState
trigger1 = !alive
value = 5050

;---------------------------------------------------------------------------
; Stand to Crouch
[Statedef 10]
type    = C
physics = C
;anim = 10

;===HS

[State 10, 1]
type = VelMul
trigger1 = Time = 0
x = .75

[state 0, anim]
type = ChangeAnim
;triggerall = name!="Oliver"
triggerall = name!="Roy" 
trigger1 = Time = 0
value =10

[state 0, anim]
type = ChangeAnim
triggerall = name="Roy" 
trigger1 = var(27)=2
trigger1 = Time = 0
value =10

[state 0, anim]
type = ChangeAnim
triggerall = name="Roy" 
trigger1 = var(27)=1
trigger1 = Time = 0
value =101

[State 0, super armor damage]
type = LifeAdd
trigger1 = Time = 0
value = -(gethitvar(damage))

[state 0, super armor hitcounter]
type=varadd
trigger1=enemynear,movetype=A
trigger1=enemynear,movecontact
fv=5
value=1
persistent=0

[state 0, ctrlset]
type=ctrlset
trigger1=var(27)=0
trigger1=fvar(7)=1
value=1

[State 0, ChangeState]
type = ChangeState
trigger1 = command = "holdup"
value = 7000
ctrl = 1

[State 10, 2]
type = ChangeState
trigger1 = AnimTime = 0
value = 11

;---------------------------------------------------------------------------
; Crouching
[Statedef 11]
type    = C
physics = C
;anim=F11
sprpriority = 0



;===HS

[state 0, anim]
type = ChangeAnim
;triggerall = name!="Oliver"
triggerall = name!="Roy" 
trigger1 = Time = 0
value =11

[state 0, anim]
type = ChangeAnim
triggerall = name="Roy" 
trigger1 = var(27)=2
trigger1 = Time = 0
value =11

[state 0, anim]
type = ChangeAnim
triggerall = name="Roy" 
trigger1 = var(27)=1
trigger1 = Time = 0
value =110

;[state 0, anim]
;type = ChangeAnim
;triggerall = name!="Oliver"
;triggerall = name!="Roy" 
;trigger1 = var(27)!=0
;trigger1 = Time = 0
;value =11
;
;[state 0, super armor anim change]
;type = ChangeAnim
;triggerall = name!="Oliver"
;triggerall = name!="Roy" 
;trigger1 = var(27)!=0
;trigger1 = Time = 0 && Anim != 11
;value = 11
;
;[state 0, anim]
;type = ChangeAnim
;triggerall = name!="Oliver"
;triggerall = name!="Roy" 
;trigger1 = var(27)!=1
;trigger1 = Time = 0
;value =11
;
;[state 0, super armor anim change]
;type = ChangeAnim
;triggerall = name="Oliver"
;triggerall = name="Roy"
;trigger1 = var(27)!=1
;trigger1 = Time = 0 && Anim != 11
;value = 11
;
;[state 0, anim]
;type = ChangeAnim
;triggerall = name="Oliver"
;triggerall = name="Roy"
;trigger1 = var(27)=1
;trigger1 = Time = 0
;value =110
;
;[state 0, super armor anim change]
;type = ChangeAnim
;triggerall = name="Oliver"
;triggerall = name="Roy"
;trigger1 = var(27)=1
;trigger1 = Time = 0 && Anim != 110
;value = 110

[State 0, super armor damage]
type = LifeAdd
trigger1 = Time = 0
value = -(gethitvar(damage))

[state 0, super armor hitcounter]
type=varadd
trigger1=enemynear,movetype=A
trigger1=enemynear,movecontact
fv=5
value=1
persistent=0

[state 0, ctrlset]
type=ctrlset
trigger1=var(27)=0
trigger1=fvar(7)=1
value=1

[State 11, 1] ;Change from turning animation
type = ChangeAnim
trigger1 = Anim = 6 && AnimTime = 0
value = 11

;---------------------------------------------------------------------------
; Crouch to Stand
[Statedef 12]
type    = S
physics = S
anim = 12

;===HS

[state 0, anim]
type = ChangeAnim
;triggerall = name!="Oliver"
triggerall = name!="Roy" 
trigger1 = Time = 0
value =12

[state 0, anim]
type = ChangeAnim
triggerall = name="Roy" 
trigger1 = var(27)=2
trigger1 = Time = 0
value =12

[state 0, anim]
type = ChangeAnim
triggerall = name="Roy" 
trigger1 = var(27)=1
trigger1 = Time = 0
value =120

[State 0, super armor damage]
type = LifeAdd
trigger1 = var(27)=0
trigger1 = fvar(7)=1
trigger1 = Time = 0
value = -(gethitvar(damage))

[state 0, super armor hitcounter]
type=varadd
trigger1=var(27)=0
trigger1 = fvar(7)=1
trigger1=enemynear,movetype=A
trigger1=enemynear,movecontact
fv=5
value=1
persistent=0

[state 0, ctrlset]
type=ctrlset
trigger1=var(27)=0
trigger1=fvar(7)=1
value=1

[state 0, ctrlset]
type=ctrlset
trigger1=1
value=1

[State 12, 1]
type = ChangeState
triggerall = !(ishelper)
trigger1 = AnimTime = 0
value = 0

[State 12, 1]
type = ChangeState
triggerall = ishelper
trigger1 = time>=0
value = 40012


;---------------------------------------------------------------------------
; Walk
[Statedef 20]
type    = S
physics = S
sprpriority = 0

;===HS

[State 20, 1]
type = VelSet
trigger1 = command = "holdfwd"
x = const(velocity.walk.fwd.x)

[State 20, 2]
type = VelSet
trigger1 = command = "holdback"
x = const(velocity.walk.back.x)

;[state 0, parry]
;type = HitOverride
;triggerall = command != "236"
;triggerall = command != "214"
;triggerall = command != "623"
;triggerall = command != "421"
;trigger1 = var(18)=0
;trigger1 = command="fwd";"fwd"
;trigger2 = var(18)>0
;trigger2 = command="fwd+"
;trigger3 = command="holdfwd"
;trigger2 = var(18)=1
;trigger1 = 1
;attr = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
;slot = 7
;stateno = 11070
;time = 4+var(18)
;forceair = 0

[state 0, anim]
type = ChangeAnim
trigger1 = var(27)!=0
trigger1 = Time = 0
value =20

[state 0, super armor anim change]
type = ChangeAnim
trigger1 = var(27)=0
;trigger1 = fvar(7)=1
trigger1 = Time = 0 && Anim !=20
value =20

[state 0, super armor anim change]
type = ChangeAnim
trigger1 = var(27)=0
;trigger1 = fvar(7)=1
trigger1 = Time = 0 && Anim !=21
value =21

[State 0, super armor damage]
type = LifeAdd
trigger1 = var(27)=0
trigger1 = fvar(7)=1
trigger1 = Time = 0
value = -(gethitvar(damage))

[state 0, super armor hitcounter]
type=varadd
trigger1=var(27)=0
trigger1 = fvar(7)=1
trigger1=enemynear,movetype=A
trigger1=enemynear,movecontact
fv=5
value=1
persistent=0

[state 0, ctrlset]
type=ctrlset
trigger1=var(27)=0
trigger1=fvar(7)=1
value=1

[State 20, 3]
type = ChangeAnim
triggerall = vel x > 0
trigger1 = Anim != 20 && Anim != 5
trigger2 = Anim = 5 && AnimTime = 0
value = 20

[State 20, 4]
type = ChangeAnim
triggerall = vel x < 0
trigger1 = Anim != 21 && Anim != 5
trigger2 = Anim = 5 && AnimTime = 0
value = 21

;---------------------------------------------------------------------------
; Jump Start
[Statedef 40]
type    = S
physics = S
anim = 40
ctrl = 0
sprpriority = 1
facep2=1

;===HS

[State 0, HitBy]
type = HitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 1
;ignorehitpause = 
;persistent = 


[State 40, 1]
type = VarSet
trigger1 = Time = 0
sysvar(1) = 0

[State 40, 2]
type = VarSet
trigger1 = command = "holdfwd"
sysvar(1) = 1

[State 40, 3]
type = VarSet
trigger1 = command = "holdback"
sysvar(1) = -1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = F20,2
volume = 255
channel = -1

; [State 40, 4]
; type = VelSet
; trigger1 = AnimTime = 0
; trigger1 = command!="holdup"
; x = ifelse(sysvar(1)=0, const(velocity.jump.neu.x), ifelse(sysvar(1)=1, const(velocity.jump.fwd.x), const(velocity.jump.back.x)))
; y = (const(velocity.jump.y))*0.6

[State 40, 4]
type = VelSet
trigger1 = animtime = 0
;trigger1 = command="holdup"
x = ifelse(sysvar(1)=0, const(velocity.jump.neu.x), ifelse(sysvar(1)=1, const(velocity.jump.fwd.x), const(velocity.jump.back.x)))
y = const(velocity.jump.y)

[State 40, 5]
type = VelSet
trigger1 = AnimTime = 0
trigger1 = prevstateno = 100 || prevstateno = 101 ;RUN_FWD
trigger1 = sysvar(1) = 1
x = const(velocity.runjump.fwd.x)

;[State 0, PlaySnd]
;type = PlaySnd
;trigger1 = AnimTime = 0
;trigger1 = prevstateno = 100 ;RUN_FWD
;trigger1 = sysvar(1) = 1
;value = S20,1

[State 40, 6]
type = ChangeState
trigger1 = AnimTime = 0
value = 50
ctrl = 1

;---------------------------------------------------------------------------
; AirJump Start
[Statedef 45]
type    = A
physics = N
ctrl = 0
velset = 0,0

;===HS

[state 0, super armor anim change]
type = ChangeAnim
trigger1 = var(27)=0
;trigger1 = fvar(7)=1
trigger1 = Time = 0 && Anim !=44
value =44

[state 0, super armor anim change]
type = ChangeAnim
trigger1 = var(27)=0
;trigger1 = fvar(7)=1
trigger1 = Time = 0 && Anim !=41
value =41

[State 0, super armor damage]
type = LifeAdd
trigger1 = var(27)=0
trigger1 = fvar(7)=1
trigger1 = Time = 0
value = -(gethitvar(damage))

[state 0, super armor hitcounter]
type=varadd
trigger1=var(27)=0
trigger1 = fvar(7)=1
trigger1=enemynear,movetype=A
trigger1=enemynear,movecontact
fv=5
value=1
persistent=0

[state 0, ctrlset]
type=ctrlset
trigger1=var(27)=0
trigger1=fvar(7)=1
value=1

[State 45, air jump - finish]
type = VarSet
trigger1 = !Time
trigger1 = p1name!="Charlotte"
var(30) = 3

[State 45, air jump - finish + 1]
type = VarSet
trigger1 = !Time
trigger1 = p1name="Charlotte"
var(30) = 4

[State 45, 1]
type = ChangeAnim
trigger1 = SelfAnimExist(44)
value = 44

[State 45, 2]
type = ChangeAnim
trigger1 = !SelfAnimExist(44)
value = 41

[State 45, 3]
type = VarSet
trigger1 = Time = 0
sysvar(1) = 0

[State 45, 4]
type = VarSet
trigger1 = command = "holdfwd"
sysvar(1) = 1

[State 45, 5]
type = VarSet
trigger1 = command = "holdback"
sysvar(1) = -1

[State 45, 6]
type = VelSet
trigger1 = Time = 2
x = ifelse(sysvar(1)=0, const(velocity.airjump.neu.x), ifelse(sysvar(1)=1, const(velocity.airjump.fwd.x), const(velocity.airjump.back.x)))
y = const(velocity.airjump.y)

[State 45, 7]
type = ChangeState
trigger1 = Time = 2
value = 50
ctrl = 1

;---------------------------------------------------------------------------
; Jump Up
[Statedef 50]
type    = A
physics = A

;===HS

;[state 0, parry]
;type = HitOverride
;triggerall = command != "236"
;triggerall = command != "214"
;triggerall = command != "623"
;triggerall = command != "421"
;trigger1 = var(18)=0
;trigger1 = command="fwd";"fwd"
;trigger2 = var(18)>0
;trigger2 = command="fwd+"
;trigger3 = command="holdfwd"
;trigger2 = var(18)=1
;trigger1 = 1
;attr = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
;slot = 7
;stateno = 11070
;time = 4+var(18)
;forceair = 0

[state 0, super armor anim change]
type = ChangeAnim
trigger1 = var(27)=0
;trigger1 = fvar(7)=1
trigger1 = Time = 0 && Anim !=41
value =41

[state 0, super armor anim change]
type = ChangeAnim
trigger1 = var(27)=0
;trigger1 = fvar(7)=1
trigger1 = Time = 0 && Anim !=42
value =42

[state 0, super armor anim change]
type = ChangeAnim
trigger1 = var(27)=0
;trigger1 = fvar(7)=1
trigger1 = Time = 0 && Anim !=43
value =43

[State 0, super armor damage]
type = LifeAdd
trigger1 = var(27)=0
trigger1 = fvar(7)=1
trigger1 = Time = 0
value = -(gethitvar(damage))

[state 0, super armor hitcounter]
type=varadd
trigger1=var(27)=0
trigger1 = fvar(7)=1
trigger1=enemynear,movetype=A
trigger1=enemynear,movecontact
fv=5
value=1
persistent=0

[state 0, ctrlset]
type=ctrlset
trigger1=var(27)=0
trigger1=fvar(7)=1
value=1

[State 0, PlaySnd]
type = PlaySnd
trigger1=time=0
value = 20,2

[State 50, 1]
type = VarSet
trigger1 = Time = 0
sysvar(1) = 0

[State 50, 2]
type = ChangeAnim
trigger1 = Time = 0
value = ifelse((vel x)=0, 41, ifelse((vel x)>0, 42, 43))

[State 50, 3]
type = ChangeAnim
trigger1 = Vel y > -2
trigger1 = SelfAnimExist(anim + 3)
persistent = 0
value = Anim + 3

;---------------------------------------------------------------------------
; Jump Down (empty state for compatibility)
[Statedef 51]
type    = A
physics = A

[State 51, 1]
type = Null
trigger1 = 1

;---------------------------------------------------------------------------
; Jump Land
[Statedef 52]
type    = S
physics = S
ctrl = 0
facep2 = 1
;anim = 47

;===HS

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time=0
value = F500,1
volume = 255
channel = -1
freqmul = 1.0
loop = 0
pan = 0
ignorehitpause = 1

[state 0, anim]
type = ChangeAnim
trigger1 = var(27)!=0
trigger1 = Time = 0
value =47

[state 0, super armor anim change]
type = ChangeAnim
trigger1 = var(27)=0
;trigger1 = fvar(7)=1
trigger1 = Time = 0 && Anim !=47
value =47

[State 0, super armor damage]
type = LifeAdd
trigger1 = var(27)=0
trigger1 = fvar(7)=1
trigger1 = Time = 0
value = -(gethitvar(damage))

[state 0, super armor hitcounter]
type=varadd
trigger1=var(27)=0
trigger1 = fvar(7)=1
trigger1=enemynear,movetype=A
trigger1=enemynear,movecontact
fv=5
value=1
persistent=0

[state 0, ctrlset]
type=ctrlset
trigger1=var(27)=0
trigger1=fvar(7)=1
value=1

[State 52, 1]
type = VelSet
trigger1 = Time = 0
y = 0

[State 52, 2]
type = PosSet
triggerall = !(ishelper)
trigger1 = Time = 0
y = 0

[State 52, 2]
type = PosSet
triggerall = ishelper
trigger1 = Time = 0
y = -5

[State 52, 3]
type = CtrlSet
trigger1 = Time = 3
value = 1

[State 52, 4]
type = ChangeState
triggerall=!(ishelper)
trigger1 = AnimTime = 0
value = 0
ctrl = 1

[State 52, 4]
type = ChangeState
triggerall=ishelper
trigger1 = time>=0
value = 40052
ctrl = 1

;---------------------------------------------------------------------------
; Light attack land
[Statedef 53]
type    = S
physics = S
ctrl = 0
;anim = 48

;===HS

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time=0
value = F500,1
volume = 255
channel = -1
freqmul = 1.0
loop = 0
pan = 0
ignorehitpause = 1

[state 0, anim]
type = ChangeAnim
trigger1 = var(27)!=0
trigger1 = Time = 0
value =48

[state 0, super armor anim change]
type = ChangeAnim
trigger1 = var(27)=0
;trigger1 = fvar(7)=1
trigger1 = Time = 0 && Anim !=48
value =48

[State 0, super armor damage]
type = LifeAdd
trigger1 = var(27)=0
trigger1 = fvar(7)=1
trigger1 = Time = 0
value = -(gethitvar(damage))

[state 0, super armor hitcounter]
type=varadd
trigger1=var(27)=0
trigger1 = fvar(7)=1
trigger1=enemynear,movetype=A
trigger1=enemynear,movecontact
fv=5
value=1
persistent=0

[state 0, ctrlset]
type=ctrlset
trigger1=var(27)=0
trigger1=fvar(7)=1
value=1

[State 52, 1]
type = VelSet
trigger1 = Time = 0
y = 0

[State 52, 2]
type = PosSet
trigger1 = Time = 0
y = 0

[State 52, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Mid attack land
[Statedef 54]
type    = S
physics = S
ctrl = 0
;anim = 49

;===HS

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time=0
value = F500,1
volume = 255
channel = -1
freqmul = 1.0
loop = 0
pan = 0
ignorehitpause = 1

[state 0, anim]
type = ChangeAnim
trigger1 = var(27)!=0
trigger1 = Time = 0
value =49

[state 0, super armor anim change]
type = ChangeAnim
trigger1 = var(27)=0
;trigger1 = fvar(7)=1
trigger1 = Time = 0 && Anim !=49
value =49

[State 0, super armor damage]
type = LifeAdd
trigger1 = var(27)=0
trigger1 = fvar(7)=1
trigger1 = Time = 0
value = -(gethitvar(damage))

[state 0, super armor hitcounter]
type=varadd
trigger1=var(27)=0
trigger1 = fvar(7)=1
trigger1=enemynear,movetype=A
trigger1=enemynear,movecontact
fv=5
value=1
persistent=0

[state 0, ctrlset]
type=ctrlset
trigger1=var(27)=0
trigger1=fvar(7)=1
value=1

[State 52, 1]
type = VelSet
trigger1 = Time = 0
y = 0

[State 52, 2]
type = PosSet
trigger1 = Time = 0
y = 0

[State 52, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Strong attack land
[Statedef 55]
type    = S
physics = S
ctrl = 0
;anim = 50

;===HS

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time=0
value = F500,1
volume = 255
channel = -1
freqmul = 1.0
loop = 0
pan = 0
ignorehitpause = 1

[state 0, anim]
type = ChangeAnim
trigger1 = var(27)!=0
trigger1 = Time = 0
value =50

[state 0, super armor anim change]
type = ChangeAnim
trigger1 = var(27)=0
;trigger1 = fvar(7)=1
trigger1 = Time = 0 && Anim !=50
value =50

[State 0, super armor damage]
type = LifeAdd
trigger1 = var(27)=0
trigger1 = fvar(7)=1
trigger1 = Time = 0
value = -(gethitvar(damage))

[state 0, super armor hitcounter]
type=varadd
trigger1=var(27)=0
trigger1 = fvar(7)=1
trigger1=enemynear,movetype=A
trigger1=enemynear,movecontact
fv=5
value=1
persistent=0

;[state 0, ctrlset]
;type=ctrlset
;trigger1=var(27)=0
;trigger1=fvar(7)=1
;value=1

[State 52, 1]
type = VelSet
trigger1 = Time = 0
y = 0

[State 52, 2]
type = PosSet
trigger1 = Time = 0
y = 0

[State 52, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; RUN_FWD
[Statedef 100]
type    = S
physics = S
anim = 100
sprpriority = 1

;===HS

[state 100, (air)dash spark]
type=explod
trigger1=animelem=3
sprpriority=7
anim=11010
ID=11010
vel=Vel X
scale=1,1
postype=p1
pos=0,0
supermove=1
supermovetime=9999
pausemovetime=9999

[state 0, ctrlset]
type=ctrlset
trigger1=var(27)=0
trigger1=fvar(7)=1
value=0

[State 100, 1]
type = VelSet
trigger1 = 1
x = const(velocity.run.fwd.x)

[State 100, 2] ;Prevent run from canceling into walk
type = AssertSpecial
trigger1 = 1
flag = NoWalk

[State 100, 3] ;Prevent from turning
type = AssertSpecial
trigger1 = 1
flag = NoAutoTurn

[state 200, jump cancel]
type=changestate
trigger1=movecontact
trigger1=command="holdup"
value=40
ctrl=1

[State 100, 4]
type = ChangeState
trigger1 = animtime=0
value = 0

;---------------------------------------------------------------------------
; RUNBACK
[Statedef 105]
type    = S
physics = S
ctrl = 0
anim = 105
sprpriority = 1

;===HS

[state 0, super armor hitcounter]
type=varadd
trigger1=var(27)=0
trigger1 = fvar(7)=1
trigger1=enemynear,movetype=A
trigger1=enemynear,movecontact
fv=5
value=1
persistent=0

[state 0, ctrlset]
type=ctrlset
trigger1=var(27)=0
trigger1=fvar(7)=1
value=1

[State 3, PlaySnd]
type = PlaySnd
trigger1 = time=0
value = 20,2
volume = 0

[State 105, 1]
type = VelSet
trigger1 = Time = 0
x = const(velocity.run.back.x)
y = 0;const(velocity.run.back.y)

[State 105, 2]
type = CtrlSet
trigger1 = Time = 2
value = 1

[State 105, 3]
type = selfstate
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 106

;---------------------------------------------------------------------------
; RUNBACK2 (land)
[Statedef 106]
type    = S
physics = S
ctrl = 0
anim = 47

;===HS

[state 0, ctrlset]
type=ctrlset
;trigger1=var(27)=0
;trigger1=fvar(7)=1
trigger1=time=2
value=1

[State 106, 1]
type = VelSet
trigger1 = Time = 0
y = 0

[State 106, 2]
type = PosSet
trigger1 = Time = 0
y = 0

[State 106, 3]
type = MakeDust
trigger1 = Time = 2
pos = -5,-2
spacing = 1

[State 106, 4]
type = ChangeState
trigger1 = Time = 7
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; RUN_UP
[Statedef 110]
type    = S
physics = N
anim=110

[State 110, 0]
type = CtrlSet
trigger1 = Time = 0
value = 0

;===HS

[state 0, ctrlset]
type=ctrlset
trigger1=var(27)=0
trigger1=fvar(7)=1
value=1

[State 110, 2]
type = HitBy
trigger1 = Time = 0
value = SCA, NT, ST, HT
time = 30

[State 110, 3]
type = VelSet
trigger1 = Time = 0
x = 0
z = -7

[State 110, 4]
type = VelMul
trigger1 = 1
z = 0.8

[State 110, 5]
type = VelSet
trigger1 = AnimTime = -8
z = 0

[State 110, 7]
type = CtrlSet
trigger1 = AnimTime = 0
value = 1

[State 110, 8]
type = ChangeState
trigger1 = AnimTime = 0
value = 0

;---------------------------------------------------------------------------
; RUN_DOWN
[Statedef 115]
type    = S
physics = N
anim=110

;===HS

[State 115, 0]
type = CtrlSet
trigger1 = Time = 0
value = 0

[state 0, ctrlset]
type=ctrlset
trigger1=var(27)=0
trigger1=fvar(7)=1
value=1

[State 115, 2]
type = HitBy
trigger1 = Time = 0
value = SCA, NT, ST, HT
time = 30

[State 115, 3]
type = VelSet
trigger1 = Time = 0
x = 0
z = 7

[State 115, 4]
type = VelMul
trigger1 = 1
z = 0.8

[State 115, 5]
type = VelSet
trigger1 = AnimTime = -8
z = 0

[State 115, 7]
type = CtrlSet
trigger1 = AnimTime = 0
value = 1

[State 115, 8]
type = ChangeState
trigger1 = AnimTime = 0
value = 0

;---------------------------------------------------------------------------
; GUARD (start)
[Statedef 120]
type = U    ;Leave state type unchanged
physics = U ;Leave physics unchanged

[State -1, Repel Shield SC 11000]
type = ChangeState
value = 11000
triggerall = !(ishelper)
triggerall = !(enemynear,ishelper)
triggerall = var(27) = 0
triggerall = power >= 500
trigger1 = command = "x"
ignorehitpause=1

;===HS

[State 120]
Type=CtrlSet
Trigger1=var(15)>0
value=0

[State 120, 1]
type = ChangeAnim
trigger1 = Time = 0
value = 120 + (statetype = C) + (statetype = A)*2

[State 120, 2]
type = StateTypeSet
trigger1 = Time = 0 && statetype = S
physics = S

[State 120, 3]
type = StateTypeSet
trigger1 = Time = 0 && statetype = C
physics = C

[State 120, 4]
type = StateTypeSet
trigger1 = Time = 0 && statetype = A
physics = A

[State 120, Hi to Lo]
type = StateTypeSet
triggerall = statetype = S
trigger1 = var(15)=0
trigger1 = command = "holddown"
trigger2 = var(15)>0
trigger2 = (abs(P2Dist X)>120) || (P2MoveType=H) || (P2StateType=C)
trigger2 = P2StateType!=A
trigger2 = AILevel>=3
statetype = C
physics = C

[State 120, Lo to Hi]
type = StateTypeSet
triggerall = statetype = C
trigger1 = var(15)=0
trigger1 = command != "holddown"
trigger2 = var(15) > 0
trigger2 = p2statetype = A
trigger2 = abs(P2BodyDist X)<50
trigger2 = AILevel>=3
statetype = S
physics = S

[State 120, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 130 + (statetype = C) + (statetype = A)*2

[State 120, Stop Guarding]
type = ChangeState
trigger1 = command != "holdback"
trigger1 = var(15)=0
trigger2 = !inguarddist
;trigger3 = facing = enemynear,facing
value = 140

;---------------------------------------------------------------------------
; Stand guard (guarding)
[Statedef 130]
type    = S
physics = S

;===HS

[State 120]
Type=CtrlSet
Trigger1=var(15)>0
value=0

[State 130, 1]
type = ChangeAnim
trigger1 = Anim != 130
value = 130

[State -1, Repel Shield SC 11000]
type = ChangeState
value = 11000
triggerall = !(ishelper)
triggerall = !(enemynear,ishelper)
triggerall = var(27) = 0
triggerall = power >= 500
trigger1 = command = "x"
ignorehitpause=1

[State 130, Hi to Lo]
type = ChangeState
trigger1 = command = "holddown"
trigger1 = var(15)=0
trigger2 = var(15)>0
trigger2 = (abs(P2Dist X)>120) || (P2MoveType=H) || (P2StateType=C)
trigger2 = P2StateType!=A
trigger2 = AILevel>=3
value = 131

[State 130, Stop Guarding]
type = ChangeState
trigger1 = var(15)=0
trigger1 = command != "holdback"
trigger2 = !inguarddist
;trigger3 = facing = enemynear,facing
value = 140

;---------------------------------------------------------------------------
; Crouch guard (guarding)
[Statedef 131]
type    = C
physics = C

;===HS

[State 120]
Type=CtrlSet
Trigger1=var(15)>0
value=0

[State 131, 1]
type = ChangeAnim
trigger1 = Anim != 131
value = 131

[State -1, Repel Shield SC 11000]
type = ChangeState
value = 11000
triggerall = !(ishelper)
triggerall = !(enemynear,ishelper)
triggerall = var(27) = 0
triggerall = power >= 500
trigger1 = command = "x"
ignorehitpause=1

[State 131, Lo to Hi]
type = ChangeState
trigger1 = command != "holddown"
trigger1 = var(15)=0
trigger2 = var(15) > 0
trigger2 = p2statetype = A
trigger2 = abs(P2BodyDist X)<50
trigger2 = AILevel>=3
value = 130

[State 131, Stop Guarding]
type = ChangeState
trigger1 = var(15)=0
trigger1 = command != "holdback"
trigger2 = !inguarddist
;trigger3 = facing = enemynear,facing
value = 140

;---------------------------------------------------------------------------
; Air guard (guarding)
[Statedef 132]
type    = A
physics = N

;===HS

[State 120]
Type=CtrlSet
Trigger1=var(15)>0
value=0

[State -1, Repel Shield SC 11000]
type = ChangeState
value = 11000
triggerall = !(ishelper)
triggerall = !(enemynear,ishelper)
triggerall = var(27) = 0
triggerall = power >= 500
trigger1 = command = "x"
ignorehitpause=1

[State 132, 1]
type = ChangeAnim
trigger1 = Anim != 132
value = 132

[State 132, 2]
type = VelAdd
trigger1 = 1
y = Const(movement.yaccel)

[State 132, 3]
type = VarSet
trigger1 = 1
sysvar(0) = (pos y >= 0) && (vel y > 0)

[State 132, 4]
type = VelSet
trigger1 = sysvar(0)
y = 0

[State 132, 5]
type = PosSet
trigger1 = sysvar(0)
y = 0

[State 132, 6]
type = ChangeState
trigger1 = sysvar(0)
trigger1 = command = "holdback" || (var(15)>0)
trigger1 = inguarddist
value = 130

[State 132, 7]
type = ChangeState
trigger1 = sysvar(0)
value = 52

[State 132, Stop Guarding]
type = ChangeState
trigger1 = var(15)=0
trigger1 = command != "holdback"
trigger2 = !inguarddist
;trigger3 = facing = enemynear,facing
value = 140

;---------------------------------------------------------------------------
; GUARD (end)
[Statedef 140]
type     = U
physics  = U
ctrl     = 1

[State -1, Repel Shield SC 11000]
type = ChangeState
value = 11000
triggerall = !(ishelper)
triggerall = !(enemynear,ishelper)
triggerall = var(27) = 0
triggerall = power >= 500
trigger1 = command = "x"
ignorehitpause=1

;===HS

[State 140, 1]
type = ChangeAnim
trigger1 = time = 0
value = 140+(statetype = C)+(statetype = A)*2

; [State -2, 0]
; type = VarSet
; trigger1 = 1
; persistent = 1
; ignorehitpause = 1
; v = 24
; value = ctrl
; 
; [State -2, 0]
; type = VarSet
; trigger1 = 1
; persistent = 1
; ignorehitpause = 1
; v = 25
; value = stateno

[State 140, 2]
type = StateTypeSet
trigger1 = time = 0 && statetype = S
physics = S

[State 140, 3]
type = StateTypeSet
trigger1 = time = 0 && statetype = C
physics = C

[State 140, 4]
type = StateTypeSet
trigger1 = time = 0 && statetype = A
physics = A

[State 140, Hi to Lo]
type = StateTypeSet
trigger1 = var(59)   = 0
trigger1 = statetype = S && command = "holddown"
statetype = C
physics = C

[State 140, Lo to Hi]
type = StateTypeSet
trigger1 = var(59)   = 0
trigger1 = statetype = C && command != "holddown"
statetype = S
physics = S

;[State 140, 5] ;Implemented within engine
;type = ChangeState
;trigger1 = AnimTime = 0
;value = (statetype = C)*11 + (statetype = A)*51

;---------------------------------------------------------------------------
; Stand guard hit (shaking)
[Statedef 150]
type    = S
movetype= H
physics = N
velset = 0,0

;===HS

[State -1, Repel Shield SC 11000]
type = ChangeState
value = 11000
triggerall = !(ishelper)
triggerall = !(enemynear,ishelper)
triggerall = var(27) = 0
triggerall = power >= 500
trigger1 = command = "x"
ignorehitpause=1

;[State -1, Push Block 13550]
;type = ChangeState
;value = 13550
;triggerall = !(ishelper)
;triggerall = var(27) = 0
;trigger1 = command = "x"
;ignorehitpause=1
;
;[State -1, Burst Dash 13600]
;type = ChangeState
;value = 13600
;triggerall = power>1000
;triggerall = !(ishelper)
;triggerall = var(27) = 2
;trigger1 = command = "x"
;ignorehitpause=1

[State 150, 1]
type = ChangeAnim
trigger1 = 1
value = 150

[State 150, 2]
type = ChangeState
trigger1 = HitShakeOver
;trigger2 = facing = enemynear,facing
value = 151 + 2*(StateType=C)

[State 120, Hi to Lo]
type = StateTypeSet
triggerall = statetype = S
trigger1 = var(15)=0
trigger1 = command = "holddown"
trigger2 = var(15)>0
trigger2 = (abs(P2Dist X)>120) || (P2MoveType=H) || (P2StateType=C)
trigger2 = P2StateType!=A
trigger2 = AILevel>=3
statetype = C
physics = C

[State 120, Lo to Hi]
type = StateTypeSet
triggerall = statetype = C
trigger1 = var(15)=0
trigger1 = command != "holddown"
trigger2 = var(15) > 0
trigger2 = p2statetype = A
trigger2 = abs(P2BodyDist X)<50
trigger2 = AILevel>=3
statetype = S
physics = S

[State 150, 3]
type = ForceFeedback
trigger1 = time = 0
waveform = square
time = 3

;---------------------------------------------------------------------------
; Stand guard hit (knocked back)
[Statedef 151]
type    = S
movetype= H
physics = S
anim = 150

;===HS

[State -1, Repel Shield SC 11000]
type = ChangeState
value = 11000
triggerall = !(ishelper)
triggerall = !(enemynear,ishelper)
triggerall = var(27) = 0
triggerall = power >= 500
trigger1 = command = "x"
ignorehitpause=1

[State 151, 1]
type = HitVelSet
trigger1 = Time = 0
x = 1

[State 151, 2]
type = VelSet
trigger1 = Time = GetHitVar(slidetime)
trigger2 = HitOver
x = 0

[State 151, 3]
type = CtrlSet
trigger1 = Time = GetHitVar(ctrltime)
trigger1 = var(15)=0
value = 1

[State 120, Hi to Lo]
type = StateTypeSet
triggerall = statetype = S
trigger1 = var(15)=0
trigger1 = command = "holddown"
trigger2 = var(15)>0
trigger2 = (abs(P2Dist X)>120) || (P2MoveType=H) || (P2StateType=C)
trigger2 = P2StateType!=A
trigger2 = AILevel>=3
statetype = C
physics = C

[State 120, Lo to Hi]
type = StateTypeSet
triggerall = statetype = C
trigger1 = var(15)=0
trigger1 = command != "holddown"
trigger2 = var(15) > 0
trigger2 = p2statetype = A
trigger2 = abs(P2BodyDist X)<50
trigger2 = AILevel>=3
statetype = S
physics = S

[State 151, 4]
type = ChangeState
trigger1 = HitOver
;trigger2 = facing = enemynear,facing
value = 130
ctrl = !var(15)

;---------------------------------------------------------------------------
; Crouch guard hit (shaking)
[Statedef 152]
type    = C
movetype= H
physics = N
velset = 0,0

;===HS

[State -1, Repel Shield SC 11000]
type = ChangeState
value = 11000
triggerall = !(ishelper)
triggerall = !(enemynear,ishelper)
triggerall = var(27) = 0
triggerall = power >= 500
trigger1 = command = "x"
ignorehitpause=1

;[State -1, Push Block 13550]
;type = ChangeState
;value = 13550
;triggerall = !(ishelper)
;triggerall = var(27) = 0
;trigger1 = command = "x"
;ignorehitpause=1

;[State -1, Burst Dash 13600]
;type = ChangeState
;value = 13600
;triggerall = power>1000
;triggerall = !(ishelper)
;triggerall = var(27) = 2
;trigger1 = command = "x"
;ignorehitpause=1

[State 152, 1]
type = ChangeAnim
trigger1 = 1
value = 151

[State 152, 3]
type = ChangeState
trigger1 = HitShakeOver
;trigger2 = facing = enemynear,facing
value = 151 + 2*(StateType=C)

[State 120, Hi to Lo]
type = StateTypeSet
triggerall = statetype = S
trigger1 = var(15)=0
trigger1 = command = "holddown"
trigger2 = var(15)>0
trigger2 = (abs(P2Dist X)>120) || (P2MoveType=H) || (P2StateType=C)
trigger2 = P2StateType!=A
trigger2 = AILevel>=3
statetype = C
physics = C

[State 120, Lo to Hi]
type = StateTypeSet
triggerall = statetype = C
trigger1 = var(15)=0
trigger1 = command != "holddown"
trigger2 = var(15) > 0
trigger2 = p2statetype = A
trigger2 = abs(P2BodyDist X)<50
trigger2 = AILevel>=3
statetype = S
physics = S

[State 152, 4]
type = ForceFeedback
trigger1 = time = 0
waveform = square
time = 4

;---------------------------------------------------------------------------
; Crouch guard hit (knocked back)
[Statedef 153]
type    = C
movetype= H
physics = C
anim = 151

[State -1, Repel Shield SC 11000]
type = ChangeState
value = 11000
triggerall = !(ishelper)
triggerall = !(enemynear,ishelper)
triggerall = var(27) = 0
triggerall = power >= 500
trigger1 = command = "x"
ignorehitpause=1

;===HS

[State 153, 1]
type = HitVelSet
trigger1 = Time = 0
x = 1

[State 153, 2]
type = VelSet
trigger1 = Time = GetHitVar(slidetime)
trigger2 = HitOver
x = 0

[State 151, 3]
type = CtrlSet
trigger1 = Time = GetHitVar(ctrltime)
trigger1 = var(15)=0
value = 1

[State 120, Hi to Lo]
type = StateTypeSet
triggerall = statetype = S
trigger1 = var(15)=0
trigger1 = command = "holddown"
trigger2 = var(15)>0
trigger2 = (abs(P2Dist X)>120) || (P2MoveType=H) || (P2StateType=C)
trigger2 = P2StateType!=A
trigger2 = AILevel>=3
statetype = C
physics = C

[State 120, Lo to Hi]
type = StateTypeSet
triggerall = statetype = C
trigger1 = var(15)=0
trigger1 = command != "holddown"
trigger2 = var(15) > 0
trigger2 = p2statetype = A
trigger2 = abs(P2BodyDist X)<50
trigger2 = AILevel>=3
statetype = S
physics = S

[State 153, 4]
type = ChangeState
trigger1 = HitOver
;trigger2 = facing = enemynear,facing
value = 131
ctrl = !var(15)

;---------------------------------------------------------------------------
; Air guard hit (shaking)
[Statedef 154]
type    = A
movetype= H
physics = N
velset = 0,0

;===HS

[State -1, Repel Shield SC 11000]
type = ChangeState
value = 11000
triggerall = !(ishelper)
triggerall = !(enemynear,ishelper)
triggerall = var(27) = 0
triggerall = power >= 500
trigger1 = command = "x"
ignorehitpause=1

;[State -1, Push Block 13550]
;type = ChangeState
;value = 13550
;triggerall = !(ishelper)
;triggerall = var(27) = 0
;trigger1 = command = "x"
;ignorehitpause=1

;[State -1, Burst Dash 13600]
;type = ChangeState
;value = 13600
;triggerall = power>1000
;triggerall = !(ishelper)
;triggerall = var(27) = 2
;trigger1 = command = "x"
;ignorehitpause=1

[State 154, 1]
type = ChangeAnim
trigger1 = 1
value = 152

[State 154, 2]
type = ChangeState
trigger1 = HitShakeOver
;trigger2 = facing = enemynear,facing
value = 155 ;AGUARDHIT2

[State 154, 3]
type = ForceFeedback
trigger1 = time = 0
waveform = square
time = 4

;---------------------------------------------------------------------------
; Air guard hit (knocked away)
[Statedef 155]
type    = A
movetype= H
physics = N
anim = 152

[State -1, Repel Shield SC 11000]
type = ChangeState
value = 11000
triggerall = !(ishelper)
triggerall = !(enemynear,ishelper)
triggerall = var(27) = 0
triggerall = power >= 500
trigger1 = command = "x"
ignorehitpause=1

;===HS

[State 155, 1]
type = HitVelSet
trigger1 = Time = 0
x = 1
y = 1

[State 155, 2]
type = VelAdd
trigger1 = 1
y = Const(movement.yaccel)

[State 151, 3]
type = CtrlSet
trigger1 = Time = GetHitVar(ctrltime)
trigger1 = var(15)=0
value = 1

[State 155, 4]
type = VarSet
trigger1 = 1
sysvar(0) = (pos y >= 0) && (vel y > 0)

[State 155, 5]
type = VelSet
trigger1 = sysvar(0)
y = 0

[State 155, 6]
type = PosSet
trigger1 = sysvar(0)
y = 0

[State 155, 6]
type = ChangeState
trigger1 = sysvar(0)
trigger1 = command = "holdback" || var(15)>0
trigger1 = inguarddist
value = 130

[State 155, 7]
type = ChangeState
trigger1 = sysvar(0)
value = 52

;---------------------------------------------------------------------------
; LOSE (Time over)
[Statedef 170]
type = S
ctrl = 0
anim = 170
velset = 0,0

[State 170, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

;---------------------------------------------------------------------------
; DRAWGAME (Time over)
[Statedef 175]
type = S
ctrl = 0
velset = 0,0

[State 175, 1] ; If no anim, use go to lose state.
type = ChangeState
trigger1 = Time = 0
trigger1 = !SelfAnimExist(175)
value = 170

[State 175, 2]
type = ChangeAnim
trigger1 = Time = 0
value = 175

[State 175, 3]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

;---------------------------------------------------------------------------
; PREINTRO
[Statedef 190]
type = S
ctrl = 0
velset = 0,0

[State 190, 1]
type = ChangeAnim
trigger1 = SelfAnimExist(190)
value = 190

[State 190, 2] ;Go straight to intro.
type = ChangeState
trigger1 = Time = 0
value = 191

;---------------------------------------------------------------------------
; INTRO
[Statedef 191]
type = S
ctrl = 0
anim = 190
velset = 0,0

[State 191, 2] ;Assert this until you want "round 1, fight" to begin
type = AssertSpecial
trigger1 = 1
flag = Intro
flag2 = nobardisplay

[State 190, 2] ;Go straight to intro.
type = ChangeState
trigger1 = animtime = 0
trigger2 = command = "holddown" || command = "holdup" || command = "holdfwd" || command = "holdback"
value = 192

;---------------------------------------------------------------------------
 ;Style Select
[Statedef 192]
type = S
ctrl = 0
anim = 0
velset = 0,0

;===PARTNER TOGGLE========
;=========================
[state 190, point player]
type = varset
triggerall = teammode = simul
trigger1 = command = "fwd"
var(28) = 0

[state 190, anchor player]
type = varset
triggerall = teammode = simul
trigger1 = command = "back"
var(28) = 1

[State 0, point flash]
type = PalFX
triggerall = teammode = simul
trigger1 = var(28) = 0 
time = 1
add = 80,80,80
mul = 255,255,255
sinadd = 0,0,0,10
invertall = 0
color = 255

;===LOCKED STYLES=========
;=========================

[State 0, lock hex p1]
type = Explod
triggerall = name = "Oliver" || name = "Petra" || name = "Roy" ||name = "Tsukiko"
trigger1 = teamside=1
trigger1 =numexplod(191000)=0
anim = 290002
ID = 191000
pos = -30,-133
postype = p1
facing = 1
bindtime = -1
removetime = -1
scale = 0.25,0.25
sprpriority = 7
ontop = 1

[State 0, lock hex p2]
type = Explod
triggerall = name = "Oliver" || name = "Petra" || name = "Roy" || name = "Tsukiko"
trigger1 = teamside!=1
trigger1 =numexplod(191000)=0
anim = 290002
ID = 191000
pos = -28,-133
postype = p1
facing = 1
bindtime = -1
removetime = -1
scale = 0.25,0.25
sprpriority = 7
ontop = 1

[State 0, lock decimal p1]
type = Explod
triggerall = name = "Taeko" || name = "Yoko"
trigger1 = teamside=1
trigger1 =numexplod(191001)=0
anim = 290002
ID = 191001
pos = -30,-120
postype = p1
facing = 1
bindtime = -1
removetime = -1
scale = 0.25,0.25
sprpriority = 7
ontop = 1

[State 0, lock decimal p2]
type = Explod
triggerall = name = "Taeko" || name = "Yoko"
trigger1 = teamside!=1
trigger1 =numexplod(191001)=0
anim = 290002
ID = 191001
pos = -28,-120
postype = p1
facing = 1
bindtime = -1
removetime = -1
scale = 0.25,0.25
sprpriority = 7
ontop = 1

[State 0, lock binary p1]
type = Explod
triggerall = name = "Petra" || name = "Taeko" || name = "Yoko"
trigger1 = teamside=1
trigger1 =numexplod(191002)=0
anim = 290002
ID = 191002
pos = -30,-107
postype = p1
facing = 1
bindtime = -1
removetime = -1
scale = 0.25,0.25
sprpriority = 7
ontop = 1

[State 0, lock binary p2]
type = Explod
triggerall = name = "Petra" || name = "Taeko" || name = "Yoko"
trigger1 = teamside!=1
trigger1 =numexplod(191002)=0
anim = 290002
ID = 191002
pos = -28,-107
postype = p1
facing = 1
bindtime = -1
removetime = -1
scale = 0.25,0.25
sprpriority = 7
ontop = 1

;=== DEFAULT ====================
;================================

[state 190, decimal set]
type = varset
triggerall = name != "Yoko"
triggerall = name != "Taeko"
trigger1 = time = 0
var(27) = 2

[state 190, decimal set]
type = varset
triggerall = name != "Yoko"
triggerall = name != "Taeko"
trigger1 = time = 0
var(26) = 2

[state 190, hex set]
type = varset
triggerall = name = "Yoko"
triggerall = name = "Taeko"
trigger1 = time = 0
var(27) = 0

[state 190, hex set]
type = varset
triggerall = name = "Yoko"
triggerall = name = "Taeko"
trigger1 = time = 0
var(26) = 0

;=== POINT CONTROLS==============
;================================
[state 190, decimal-hex]
type = varset
triggerall = name != "Oliver"
triggerall = name != "Petra" 
triggerall = name != "Roy" 
triggerall = name != "Tsukiko"
triggerall = var(28) = 0
trigger1 = command = "up" ;&& command != "holdS"
trigger1 = var(27)=2
var(27) = 0

[state 190, decimal-binary]
type = varset
triggerall = var(28) = 0
triggerall = name != "Petra" 
triggerall = name != "Taeko" 
triggerall = name != "Yoko"
trigger1 = command = "down" ;&& command != "holdS"
trigger1 = var(27)=2
var(27) = 1

[state 190, binary-decimal]
type = varset
triggerall = var(28) = 0
triggerall = name != "Taeko"
triggerall = name != "Yoko"
trigger1 = command = "up" ;&& command != "holdS"
trigger1 = var(27)=1
var(27) = 2

[state 190, hex-decimal]
type = varset
triggerall = var(28) = 0
triggerall = name != "Taeko"
triggerall = name != "Yoko"
trigger1 = command = "down" ;&& command != "holdS"
trigger1 = var(27)=0
var(27) = 2

;=== ANCHOR CONTROLS==============
;================================
[state 190, decimal-hex]
type = varset
triggerall = var(28) = 1
triggerall = partner,name != "Oliver"
triggerall = partner,name != "Petra" 
triggerall = partner,name != "Roy" 
triggerall = partner,name != "Tsukiko"
trigger1 = command = "up"  && var(26)=2
var(26) = 0

[state 190, decimal-binary]
type = varset
triggerall = var(28) = 1
triggerall = partner,name != "Petra" 
triggerall = partner,name != "Taeko" 
triggerall = partner,name != "Yoko"
trigger1 = command = "down" && var(26)=2
var(26) = 1

[state 190, binary-decimal]
type = varset
triggerall = var(28) = 1
triggerall = partner,name != "Taeko"
triggerall = partner,name != "Yoko"
trigger1 = command = "up"   && var(26)=1
var(26) = 2

[state 190, hex-decimal]
type = varset
triggerall = var(28) = 1
triggerall = partner,name != "Taeko"
triggerall = partner,name != "Yoko"
trigger1 = command = "down" && var(26)=0
var(26) = 2

;===AI CONTROLS==============
;=========================
;[state 190, decimal-hex]
;type = varset
;trigger1 = enemy,command = "up" &&  enemy,command = "holdS"
;trigger1 = var(27)=2
;v=27
;value = 0
;
;[state 190, decimal-binary]
;type = varset
;trigger1 = enemy,command = "down" &&  enemy,command = "holdS"
;trigger1 = var(27)=2
;v=27
;value = 1
;
;[state 190, binary-decimal]
;type = varset
;trigger1 = enemy,command = "up" &&  enemy,command = "holdS"
;trigger1 = var(27)=1
;v=27
;value = 2
;
;[state 190, hex-decimal]
;type = varset
;trigger1 = enemy,command = "down" &&  enemy,command = "holdS"
;trigger1 = var(27)=0
;v=27
;value = 2

;=========================
;=========================

[state -2, remove dawn (hex) icon]
type = removeexplod
trigger1 = var(27)!=0
trigger2 = roundstate=3
id = 300001

[state -2, remove midnight (binary) icon]
type = removeexplod
trigger1 = var(27)!=1
trigger2 = roundstate=3
id = 300000

[state -2, remove twilight (decimal) icon]
type = removeexplod
trigger1 = var(27)!=2
trigger2 = roundstate=3
id = 300002

[state 0, scale set]
type=varset
trigger1=time=0
fvar(9)=0.62

;=======================
;Dawn (Hex) Style
;=======================

[state 0, dawn p1]
type = Explod
trigger1 = teamside=1
trigger1 =var(27)=0
trigger1 =numexplod(300001)=0
anim = F300001
ID = 300001
pos = -35,-141;141
postype = p1  ;p2,front,back,left,right
facing = 1
removetime = -1
scale = fvar(9),fvar(9)
sprpriority = 6
ontop = 0

[state 0, dawn p2]
type = Explod
trigger1 = teamside!=1
trigger1 =var(27)=0
trigger1 =numexplod(300001)=0
anim = F300001
ID = 300001
pos = 25,-141;141
postype = p1  ;p2,front,back,left,right
facing = -1
removetime = -1
scale = fvar(9),fvar(9)
sprpriority = 6
ontop = 0

;=======================
;Midnight (Binary) Style
;=======================

[state 0, midnight p1]
type = Explod
trigger1 = teamside=1
trigger1 =var(27)=1
trigger1 =numexplod(300000)=0
anim = F300000
ID = 300000
pos = -35,-141;141
postype = p1  ;p2,front,back,left,right
facing = 1
removetime = -1
scale = fvar(9),fvar(9)
sprpriority = 6
ontop = 0

[state 0, midnight p2]
type = Explod
trigger1 = teamside!=1
trigger1 =var(27)=1
trigger1 =numexplod(300000)=0
anim = F300000
ID = 300000
pos = 25,-141;141
postype = p1  ;p2,front,back,left,right
facing = -1
removetime = -1
scale = fvar(9),fvar(9)
sprpriority = 6
ontop = 0

;=======================
;Twilight (Decimal) Style
;=======================

[state 0, twilight p1]
type = Explod
trigger1 = teamside=1
trigger1 =var(27)=2
trigger1 =numexplod(300002)=0
anim = F300002
ID = 300002
pos = -35,-141;141
postype = p1  ;p2,front,back,left,right
facing = 1
removetime = -1
scale = fvar(9),fvar(9)
sprpriority = 6
ontop = 0

[state 0, twilight p2]
type = Explod
trigger1 = teamside!=1
trigger1 =var(27)=2
trigger1 =numexplod(300002)=0
anim = F300002
ID = 300002
pos = 25,-141;141
postype = p1  ;p2,front,back,left,right
facing = -1
removetime = -1
scale = fvar(9),fvar(9)
sprpriority = 6
ontop = 0

;=====================
[State 191, 2] ;Assert this until you want "round 1, fight" to begin
type = AssertSpecial
trigger1 = 1
flag = nobardisplay
flag2 = Intro

;===ANIM CHANGE========
[State 0, change to decimal anim]
type = ChangeAnim
trigger1 = anim!=2
trigger1 = var(27)=2
value = 2

[State 0, change to hex anim]
type = ChangeAnim
trigger1 = anim!=0
trigger1 = var(27)=0
value = 0

[State 0, change to binary anim]
type = ChangeAnim
trigger1 = anim!=1
trigger1 = var(27)=1
value = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = var(49) = 1
trigger2 = enemy,var(49) = 1
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; TAG START
[Statedef 4500]
type = S
movetype = I
physics = S
anim = 100	; <- You can use the standard running animation or put another one
sprpriority = 2
ctrl = 0

[State 4500, 1]
type = ChangeAnim
trigger1 = Partner, Life <= 0
trigger1 = Anim != 4500
value = 4500

[State 4500, position]
type = PosSet
trigger1 = time = 0
x = -243*facing
y = 0

[State 4500, velocity]
type = VelSet
trigger1 = Anim != 4500
x = 16

[State 4500, velocity2]
type = VelSet
trigger1 = Anim = 4500
trigger1 = AnimElem = 2, >= 0
x = 10

;[State 4500, position]
;type = PosSet
;trigger1 = time = 0
;x = -30*facing
;y = -200
;
;[State 4500, velocity]
;type = VelSet
;trigger1 = time = 0
;x = 1

[State 4500, invincibility] ; the character cannot be hit until he has fully entered on the stage
type = NotHitBy
trigger1 = BackEdgeBodyDist <= 0
value = SCA
time = 2

[State 4500, invincibility] ; if partner was KOed, appear being invincible
type = NotHitBy
trigger1 = Partner, Life <= 0
value = SCA
time = 6

[State 4500, screen bound] ; Prevents the camera from following the char
type = ScreenBound
trigger1 = 1
value = 0

;[State 4500, attack state] ; the character attacks his opponent when :
;type = ChangeState
;triggerall = BackEdgeBodyDist >= 0	; he is on the stage
;triggerall = selfanimexist (4000)					; <--- change this...
;trigger1 = partner, life > 0		; and his partner is alive
;trigger1 = P2BodyDist X = [0, 50]           ; and his enemy is close
;trigger1 = !Win && !Lose
;trigger1 = power >= 2000
;value = 4000								; <--- and this for the alternate super move!
;
;[State 4500, attack state] ; the character attacks his opponent when :
;type = ChangeState
;triggerall = BackEdgeBodyDist >= 0	; he is on the stage
;triggerall = selfanimexist (3000)					; <--- change this...
;trigger1 = partner, life > 0		; and his partner is alive
;trigger1 = P2BodyDist X = [0, 50]           ; and his enemy is close
;trigger1 = !Win && !Lose
;trigger1 = power >= 2000
;value = 3000								; <--- and this for the super move!
;
;[State 4500, attack state] ; the character attacks his opponent when :
;type = ChangeState
;triggerall = BackEdgeBodyDist >= 0	; he is on the stage
;triggerall = selfanimexist (2000)					; <--- change this...
;trigger1 = partner, life > 0		; and his partner is alive
;trigger1 = P2BodyDist X = [0, 50]           ; and his enemy is close
;trigger1 = !Win && !Lose
;trigger1 = power >= 1000
;value = 2000								; <--- and this for the alternate lv.2 move!
;
;[State 4500, attack state] ; the character attacks his opponent when :
;type = ChangeState
;triggerall = BackEdgeBodyDist >= 0	; he is on the stage
;triggerall = selfanimexist (1010)					; <--- change this...
;trigger1 = partner, life > 0		; and his partner is alive
;trigger1 = P2BodyDist X = [0, 50]           ; and his enemy is close
;trigger1 = !Win && !Lose
;trigger1 = power >= 1000
;value = 1010								; <--- and this for the lv.2 move!
;
;[State 4500, attack state] ; the character attacks his opponent when :
;type = ChangeState
;triggerall = BackEdgeBodyDist >= 0	; he is on the stage
;triggerall = selfanimexist (1000)					; <--- change this...
;trigger1 = partner, life > 0		; and his partner is alive
;trigger1 = P2BodyDist X = [0, 50]           ; and his enemy is close
;trigger1 = !Win && !Lose
;trigger1 = power >= 0
;value = 1000								; <--- and this for the alternate lv.1 move!
;
;[State 4500, attack state] ; the character attacks his opponent when :
;type = ChangeState
;triggerall = BackEdgeBodyDist >= 0	; he is on the stage
;triggerall = selfanimexist (500)					; <--- change this...
;trigger1 = partner, life > 0		; and his partner is alive
;trigger1 = P2BodyDist X = [0, 50]           ; and his enemy is close
;trigger1 = !Win && !Lose
;trigger1 = power >= 0
;value = 500								; <--- and this for the lv.1 move!

;[State 4500, 3]
;type = VelSet
;triggerall = BackEdgeBodyDist >= 0
;trigger1 = FrontEdgeBodyDist <= 0	; he has reached the other side of the screen
;trigger2 = partner, life <= 0		; his partner has just died
;trigger2 = (Time >= 50) || (P2BodyDist X = [-100, 100])
;trigger3 = P2Dist X < 0                 ; his enemy is behind him
;trigger4 = P2BodyDist X = [-100, 100]
;trigger4 = Win
;trigger5 = Win
;trigger5 = Time >= 20
;x = 0
;y = 0
;
;[State 4500, end state] ; the character does not attack his opponent if:
;type = ChangeState
;triggerall = BackEdgeBodyDist >= 0
;trigger1 = FrontEdgeBodyDist <= 0	; he has reached the other side of the screen
;trigger2 = Partner, Life <= 0           ; his partner has just died
;trigger2 = (Time >= 50) || (P2BodyDist X = [-100, 100])
;trigger3 = P2Dist X < 0                 ; his enemy is behind him
;trigger4 = P2BodyDist X = [-100, 100]
;trigger4 = Win
;trigger5 = Win
;trigger5 = Time >= 20
;value = 0
;ctrl = 1

[State 4500, end state] ; cancel if:
type = ChangeState
trigger1 = Time >= 18
value = 0
ctrl = 1

;----------------------------------------------------
; = Leaving Taunt
[Statedef 4510] ; Define your own taunt here
type = S
movetype = I
physics = S
anim = 195
sprpriority = -2
velset = 0,0
ctrl = 0

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
var(55) = 0
ignorehitpause = 1

;[state 4510, poweradd]
;type = poweradd
;trigger1 = partner, life
;trigger1 = life
;trigger1 = time = 0
;value = -1000

[State 4510, invincibility] ; the character cannot be hit since he is leaving
type = NotHitBy
trigger1 = 1
value = SCA

[State 4510, ghost] ; Prevents the camera from following the char
type = PlayerPush
trigger1 = 1
value = 0

[State 4510, end state]
type = ChangeState
trigger1 = AnimTime = 0
value = 4511


; = Leave the stage
[Statedef 4511]
type = S
movetype = I
physics = N
anim = 40	; <- Jump Start animation
sprpriority = -2
ctrl = 0

[State 4511, anim]
type = ChangeAnim
trigger1 = Anim = 40 && AnimTime = 0 ; <- plays the jump back animation when the jump start animation is finished
value = 43

[State 4511, state type]
type = StateTypeSet
trigger1 = Anim = 43 && AnimElem = 1
statetype = A

[State 4511, velocity]
type = VelSet
trigger1 = Anim = 43 && AnimElem = 1 ; <- jumping back animation
x = -12
y = -7.5

[State 4511, invincibility]
type = NotHitBy
trigger1 = 1
value = SCA

[State 4511, ghost]
type = PlayerPush
trigger1 = 1
value = 0

[State 4511, screen bound]
type = ScreenBound
trigger1 = 1
value = 0

[State 4511, wait outside state]
type = ChangeState
trigger1 = backedgedist < -30
value = 4512

;===================================================
; = Wait
[Statedef 4512]
type = A
movetype = I
physics = N
anim = 0
velset = 0,0
ctrl = 0

[State 4512, invincibility]
type = NotHitBy
trigger1 = 1
value = SCA

[State 4512, ghost]
type = PlayerPush
trigger1 = 1
value = 0

[State 4512, screen bound] ; Prevents the camera from following the char
type = ScreenBound
trigger1 = 1
value = 0

[State 4512, life add] ; Gains life (optional)
type = LifeAdd
trigger1 = (gametime%10) = 0
value = 2

[State 4512, turn] ; always face the same direction as partner
type = turn
trigger1 = facing != partner,facing

[State 4512, position] ; always stay behind and at the same distance of the char on the stage
type = posset
triggerall = partner, stateno = 192
trigger1 = 1
x = (partner, pos x) - 55*facing
y = 0

[State 4512, position] ; always stay behind and at the same distance of the char on the stage
type = posset
triggerall = partner, stateno != 192
trigger1 = 1
x = (partner, pos x) - 1000*facing
y = -150

[State 0, ChangeState]
type = ChangeState
trigger1 = partner,var(55)=1
value = 4520
ctrl = 0
;anim =
ignorehitpause = 1
persistent = 1


;===STYLE SELECT BLOCK========================

[State 0, anchor flash]
type = PalFX
trigger1 = partner,var(28) = 1
time = 5
add = 80,80,80
mul = 255,255,255
sinadd = 0,0,0,10
invertall = 0
color = 255

;===LOCKED STYLES=========
;=========================

[State 0, lock hex p1]
type = Explod
triggerall = name = "Oliver" || name = "Petra" || name = "Roy" ||name = "Tsukiko"
trigger1 = teamside=1
trigger1 =numexplod(191000)=0
anim = 290002
ID = 191000
pos = -30,-133
postype = p1
facing = 1
bindtime = -1
removetime = -1
scale = 0.25,0.25
sprpriority = 7
ontop = 1

[State 0, lock hex p2]
type = Explod
triggerall = name = "Oliver" || name = "Petra" || name = "Roy" || name = "Tsukiko"
trigger1 = teamside!=1
trigger1 =numexplod(191000)=0
anim = 290002
ID = 191000
pos = -28,-133
postype = p1
facing = 1
bindtime = -1
removetime = -1
scale = 0.25,0.25
sprpriority = 7
ontop = 1

[State 0, lock decimal p1]
type = Explod
triggerall = name = "Taeko" || name = "Yoko"
trigger1 = teamside=1
trigger1 =numexplod(191001)=0
anim = 290002
ID = 191001
pos = -30,-120
postype = p1
facing = 1
bindtime = -1
removetime = -1
scale = 0.25,0.25
sprpriority = 7
ontop = 1

[State 0, lock decimal p2]
type = Explod
triggerall = name = "Taeko" || name = "Yoko"
trigger1 = teamside!=1
trigger1 =numexplod(191001)=0
anim = 290002
ID = 191001
pos = -28,-120
postype = p1
facing = 1
bindtime = -1
removetime = -1
scale = 0.25,0.25
sprpriority = 7
ontop = 1

[State 0, lock binary p1]
type = Explod
triggerall = name = "Petra" || name = "Taeko" || name = "Yoko"
trigger1 = teamside=1
trigger1 =numexplod(191002)=0
anim = 290002
ID = 191002
pos = -30,-107
postype = p1
facing = 1
bindtime = -1
removetime = -1
scale = 0.25,0.25
sprpriority = 7
ontop = 1

[State 0, lock binary p2]
type = Explod
triggerall = name = "Petra" || name = "Taeko" || name = "Yoko"
trigger1 = teamside!=1
trigger1 =numexplod(191002)=0
anim = 290002
ID = 191002
pos = -28,-107
postype = p1
facing = 1
bindtime = -1
removetime = -1
scale = 0.25,0.25
sprpriority = 7
ontop = 1

[state -2, remove lock bar]
type = removeexplod
trigger1 = roundstate=3
id = 191000

[state -2, remove lock bar]
type = removeexplod
trigger1 = roundstate=3
id = 191001

[state -2, remove lock bar]
type = removeexplod
trigger1 = roundstate=3
id = 191002

;===CONTROLS==============
;=========================

[state 190, style capture]
type = varset
trigger1 = 1
var(27) = partner,var(26)

;=========================
;=========================

[state -2, remove dawn (hex) icon]
type = removeexplod
trigger1 = var(27)!=0
trigger2 = roundstate=3
id = 300001

[state -2, remove midnight (binary) icon]
type = removeexplod
trigger1 = var(27)!=1
trigger2 = roundstate=3
id = 300000

[state -2, remove twilight (decimal) icon]
type = removeexplod
trigger1 = var(27)!=2
trigger2 = roundstate=3
id = 300002

[state 0, scale set]
type=varset
trigger1=time=0
fvar(9)=0.62

;=======================
;Dawn (Hex) Style
;=======================

[state 0, dawn p1]
type = Explod
triggerall = partner, stateno = 192
trigger1 = teamside=1
trigger1 =var(27)=0
trigger1 =numexplod(300001)=0
anim = F300001
ID = 300001
pos = -35,-141;141
postype = p1  ;p2,front,back,left,right
facing = 1
removetime = -1
scale = fvar(9),fvar(9)
sprpriority = 6
ontop = 0

[state 0, dawn p2]
type = Explod
triggerall = partner, stateno = 192
trigger1 = teamside!=1
trigger1 =var(27)=0
trigger1 =numexplod(300001)=0
anim = F300001
ID = 300001
pos = 25,-141;141
postype = p1  ;p2,front,back,left,right
facing = -1
removetime = -1
scale = fvar(9),fvar(9)
sprpriority = 6
ontop = 0

;=======================
;Midnight (Binary) Style
;=======================

[state 0, midnight p1]
type = Explod
triggerall = partner, stateno = 192
trigger1 = teamside=1
trigger1 =var(27)=1
trigger1 =numexplod(300000)=0
anim = F300000
ID = 300000
pos = -35,-141;141
postype = p1  ;p2,front,back,left,right
facing = 1
removetime = -1
scale = fvar(9),fvar(9)
sprpriority = 6
ontop = 0

[state 0, midnight p2]
type = Explod
triggerall = partner, stateno = 192
trigger1 = teamside!=1
trigger1 =var(27)=1
trigger1 =numexplod(300000)=0
anim = F300000
ID = 300000
pos = 25,-141;141
postype = p1  ;p2,front,back,left,right
facing = -1
removetime = -1
scale = fvar(9),fvar(9)
sprpriority = 6
ontop = 0

;=======================
;Twilight (Decimal) Style
;=======================

[state 0, twilight p1]
type = Explod
triggerall = partner, stateno = 192
trigger1 = teamside=1
trigger1 =var(27)=2
trigger1 =numexplod(300002)=0
anim = F300002
ID = 300002
pos = -35,-141;141
postype = p1  ;p2,front,back,left,right
facing = 1
removetime = -1
scale = fvar(9),fvar(9)
sprpriority = 6
ontop = 0

[state 0, twilight p2]
type = Explod
triggerall = partner, stateno = 192
trigger1 = teamside!=1
trigger1 =var(27)=2
trigger1 =numexplod(300002)=0
anim = F300002
ID = 300002
pos = 25,-141;141
postype = p1  ;p2,front,back,left,right
facing = -1
removetime = -1
scale = fvar(9),fvar(9)
sprpriority = 6
ontop = 0

;=====================
[State 191, 2] ;Assert this until you want "round 1, fight" to begin
type = AssertSpecial
triggerall = partner, stateno = 192
triggerall = partner,var(28) = 1
trigger1 = 1
flag = nobardisplay
flag2 = Intro

;===ANIM CHANGE========
[State 0, change to decimal anim]
type = ChangeAnim
triggerall = partner, stateno = 192
triggerall = partner,var(28) = 1
trigger1 = anim!=2
trigger1 = var(27)=2
value = 2

[State 0, change to hex anim]
type = ChangeAnim
triggerall = partner, stateno = 192
triggerall = partner,var(28) = 1
trigger1 = anim!=0
trigger1 = var(27)=0
value = 0

[State 0, change to binary anim]
type = ChangeAnim
triggerall = partner, stateno = 192
triggerall = partner,var(28) = 1
trigger1 = anim!=1
trigger1 = var(27)=1
value = 1

; PAL FLASH ===========

;[State 0, binary]
;type = PalFX
;triggerall = partner, stateno = 192
;triggerall = partner,var(28) = 1
;trigger1 = var(27)=1 && animelem = 1
;time = 5
;add = 256,0,0
;mul = 256,0,0
;sinadd = 256,0,0,5
;invertall = 0
;color = 200
;persistent = 1
;
;[State 0, decimal]
;type = PalFX
;triggerall = partner, stateno = 192
;triggerall = partner,var(28) = 1
;trigger1 = var(27)=2 && animelem = 1
;time = 5
;add = 0,256,0
;mul = 0,256,0
;sinadd = 0,256,0,5
;invertall = 0
;color = 200
;persistent = 1
;
;[State 0, hex]
;type = PalFX
;triggerall = partner, stateno = 192
;triggerall = partner,var(28) = 1
;trigger1 = var(27)=0 && animelem = 1
;time = 5
;add = 0,0,256
;mul = 0,0,256
;sinadd = 0,0,256,5
;invertall = 0
;color = 200
;persistent = 1
;=======================


;---------------------------------------------------------------------------
; = Jumping in
[Statedef 4520]
type = S
movetype = I
physics = N
anim = 42
sprpriority = 2
ctrl = 0

[State 4520, 0]
type = PosSet
trigger1 = AnimElem = 2, < 0
x = -243*Facing
y = 0

[State 4520, 1]
type = VelSet
trigger1 = AnimElem = 2, = 0
x = 4 ;.5
y = -8.75

[State 4520, 2]
type = NotHitBy
trigger1 = 1
value = SCA
time = 6

[State 4520, 3]
type = ScreenBound
trigger1 = 1
value = 0

[State 4520, 8]
type = Gravity
trigger1 = AnimElem = 2, >= 0

[State 4520, 9]
type = VelSet
trigger1 = Vel Y >= 0
trigger1 = Pos Y > 0
trigger1 = AnimElem = 2, >= 0
x = 0
y = 0

[State 4520, 10]
type = ChangeState
trigger1 = Vel Y >= 0
trigger1 = Pos Y > 0
trigger1 = AnimElem = 2, >= 0
value = 4521

;---------------------------------------------------------------------------
; = Landing
[Statedef 4521]
type = S
movetype = I
physics = N
anim = 47
sprpriority = 2
ctrl = 0

[State 4520, 0]
type = PosSet
trigger1 = Time = 0
y = 0

[State 4520, 5]
type = NotHitBy
trigger1 = 1
value = SCA
time = 6

[State 4520, 10]
type = ChangeState
trigger1 = AnimTime >= 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Pause
[Statedef 195]
type = U
ctrl = 0
physics = U
sprpriority = 2
;
;[state 0, speed mode off]
;type = parentvarset
;triggerall = numexplod(41004)=0
;trigger1 = parent,command = "start";time = 0
;var(40) = 0

[State 0, Helper]
type = Helper
triggerall = numexplod(41004)=0
triggerall = numhelper(197)=0
trigger1 = parent,command = "start";time = 0
helpertype = normal ;player
name = "Pause Helper"
ID = 197
stateno = 197
pos = 90,-47
pausemovetime = 99999999
supermovetime = 99999999
postype = left
facing = 1
keyctrl = 0
size.xscale = 0.24
size.yscale = 0.24
ignorehitpause = 1

[State 0, Overlay]
type = Explod
triggerall = numexplod(41004)=0
trigger1 = time = 0;parent,command = "start";time = 0
anim = 41004
ID = 41004
pos = 0,0
postype = left
facing = 1
vfacing = 1
bindtime = 1
removetime = 999999
scale = 0.25,0.25
sprpriority = 4
ontop = 0

[State 0, Hex Menu]
type = Explod
;triggerall = numexplod(41004)=0
trigger1 = root,var(27)=0
trigger1 = time = 0;parent,command = "start";time = 0
anim = 41001
ID = 41001
pos = 0,0
postype = left
facing = 1
vfacing = 1
bindtime = 1
removetime = 999999
scale = 0.25,0.25
sprpriority = 6
ontop = 0

[State 0, Decimal Menu]
type = Explod
;triggerall = numexplod(41004)=0
trigger1 = root,var(27)=2
trigger1 = time = 0;parent,command = "start";time = 0
anim = 41002
ID = 41002
pos = 0,0
postype = left
facing = 1
vfacing = 1
bindtime = 1
removetime = 999999
scale = 0.25,0.25;s
sprpriority = 6
ontop = 0

[State 0, Binary Menu]
type = Explod
;triggerall = numexplod(41004)=0
trigger1 = root,var(27)=1
trigger1 = time = 0;parent,command = "start";time = 0
anim = 41003
ID = 41003
pos = 0,0
postype = left
facing = 1
vfacing = 1
bindtime = 1
removetime = 999999
scale = 0.25,0.25;s
sprpriority = 6
ontop = 0

;[State 195, 2]
;type = ChangeState
;trigger1 = time = 1
;trigger1 = command = "start"
;trigger1 = time >= 15
;value = 0;196
;ctrl = 1

;====================================================================
;Pause Helper On
[Statedef 197]
physics = N
ctrl = 0
anim = 0

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nomusic
flag2 = invisible
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nobardisplay
flag2 = nobg
flag3 = nofg
ignorehitpause = 1

[State 0, Overlay]
type = Explod
triggerall = numexplod(41004)=0
trigger1 = time = 0;command = "start";time = 0
anim = 41004
ID = 41004
pos = 0,0
postype = left
facing = 1
vfacing = 1
bindtime = 1
removetime = 999999
scale = 0.25,0.25
sprpriority = 4
ontop = 0

[State 0, Hex Menu]
type = Explod
;triggerall = numexplod(41004)=0
trigger1 = root,var(27)=0
trigger1 = time = 0;command = "start";time = 0
anim = 41001
ID = 41001
pos = 0,0
postype = left
facing = 1
vfacing = 1
bindtime = 1
removetime = 999999
scale = 0.25,0.25
sprpriority = 6
ontop = 0

[State 0, Decimal Menu]
type = Explod
;triggerall = numexplod(41004)=0
trigger1 = root,var(27)=2
trigger1 = time = 0;command = "start";time = 0
anim = 41002
ID = 41002
pos = 0,0
postype = left
facing = 1
vfacing = 1
bindtime = 1
removetime = 999999
scale = 0.25,0.25;s
sprpriority = 6
ontop = 0

[State 0, Binary Menu]
type = Explod
;triggerall = numexplod(41004)=0
trigger1 = root,var(27)=1
trigger1 = time = 0;command = "start";time = 0
anim = 41003
ID = 41003
pos = 0,0
postype = left
facing = 1
vfacing = 1
bindtime = 1
removetime = 999999
scale = 0.25,0.25;s
sprpriority = 6
ontop = 0

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
var(57) = ifelse(random>500,1,0)

[State 0, hold up]
type = PlaySnd
triggerall = var(57)=0
trigger1 = time = 0
value = F28,1
volume = 255
channel = 5
loop = 1

[State 0, stop the beat]
type = PlaySnd
triggerall = var(57)=1
trigger1 = time = 0
value = F29,1
volume = 255
channel = 3
loop = 0

[State 0, stop the beat]
type = PlaySnd
triggerall = var(57)=1
trigger1 = time = 0
value = F29,1
volume = 255
channel = 4
loop = 0

[State 0, chips start]
type = PlaySnd
triggerall = var(57)=1
trigger1 = time = 50
value = F29,3
volume = 255
channel = 5
loop = 1

[State 9501, Pause]
type = Pause
trigger1 = time = 1
time = 99999999999
movetime = 99999999999
anim = -1
sound = -1
pos = 9999,-9999
supermove = 1
ignorehitpause = 1

;[State 0, alright]
;type = PlaySnd
;triggerall = var(57)=1
;trigger1 = time > 5
;trigger1 = command = "start"
;value = F29,2
;volume = 255
;channel = 3
;loop = 0
;
;[State 0, alright]
;type = PlaySnd
;triggerall = var(57)=1
;trigger1 = time > 5
;trigger1 = command = "start"
;value = F29,2
;volume = 255
;channel = 4
;loop = 0

[State 9501]
type = ChangeState
trigger1 = time >= 10 && root,Command = "start"
;trigger2 = root,var(59) != 0
value = 198
ignorehitpause = 1

;---------------------------------------------------------------------------
; Pause Screen End
[StateDef 198]
type = S
ctrl = 0
 
[State 0, alright]
type = PlaySnd
triggerall = var(57)=1
trigger1 = time =0
value = F29,2
volume = 255
channel = 3
loop = 0

[State 0, alright]
type = PlaySnd
triggerall = var(57)=1
trigger1 = time = 0
value = F29,2
volume = 255
channel = 4
loop = 0

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nomusic
flag2 = invisible
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nobardisplay
flag2 = nobg
flag3 = nofg
ignorehitpause = 1
 
[State 9510]
type = Pause
trigger1 = time = 0
time = 1
movetime = 1
anim = -1
sound = -1
pos =9999,-9999
supermove = 1
 
[State 0, StopSnd]
type = StopSnd
trigger1 = time = 0
channel = 5

[State 9510]
type = RemoveExplod
trigger1 = 1
ID = 41000

[State 9510]
type = RemoveExplod
trigger1 = 1
ID = 41001

[State 9510]
type = RemoveExplod
trigger1 = 1
ID = 41002

[State 9510]
type = RemoveExplod
trigger1 = 1
ID = 41003

[State 9510]
type = RemoveExplod
trigger1 = 1
ID = 41004

[State 9510, DestroySelf]
type = DestroySelf
trigger1 = time = 1

;====================================================================
;Grab
[Statedef 800]
type = S
movetype= A
physics = S
juggle = 0
velset = 0,0
ctrl = 0
anim = 800

[State 200, vox]
type = PlaySnd
trigger1 = Time = 0
value = 6,12
volume=200
channel=0

[State 800, 1]
type = HitDef
trigger1 = p2movetype != H
Trigger1 = Time = 0
attr = S, NT
hitflag = M-
priority = 1, Miss
sparkxy = -10,-37
hitsound = 0,0
sparkno = 4
p1facing = ifelse (command = "holdback", -1, 1)
p2facing = 1
p1stateno = 810
p2stateno = 820
; fall = 1
numhits=0

[State 800, 2]
type = ChangeState
Trigger1 = AnimTime = 0
value = 0
ctrl = 1

;----------------------------------------------------------------------
;= Break Chance
[Statedef 820]
type = S
movetype = H
physics = S
velset = 0,0
anim = 5001

[State 600, break window]
type = PalFX
trigger1=time=0
time = 10
add = 100,100,180
mul = 256,256,256
sinadd = -80,-80,-80,10
invertall = 0
color = 0
ignorehitpause = 1
persistent = 1

[state 820, grab break]
type=changestate
trigger1=command="throw"
trigger1=time<15
value=830

[State 0, SelfState]
type = SelfState
trigger1 = p2movetype != A
value = 0
ctrl = 1

;[State 820, 1]
;type = ChangeAnim2
;Trigger1 = Time = 0
;value = 820

;----------------------------------------------------------------------
;=Fall
[Statedef 821]
type = S
movetype = H
physics = S
velset = 0,0
;poweradd = 40

[State 821, 1] ;Gravity
type = VelAdd
Trigger1 = 1
y = .4

[State 821, 2] ; Recover near ground (use ChangeState)
type = ChangeState
triggerall = Vel Y > 0
triggerall = Pos Y >= -20
triggerall = alive
triggerall = CanRecover
trigger1 = Command = "recovery"
value = 5200 ;HITFALL_RECOVER

[State 821, 3] ; Recover in mid air (use SelfState)
type = SelfState
triggerall = Vel Y > 0
triggerall = alive
triggerall = CanRecover
trigger1 = Command = "recovery"
value = 5210 ;HITFALLAIRRECOVER

[State 821, 4] ;Hit ground
type = SelfState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100 ;Hit ground

;---------------------------------------------------------------------------
; Grab Break
[Statedef 830]
type    = S
movetype= A
physics = S
juggle  = 1
;velset = 0,0
ctrl = 0
anim = 830
;poweradd = 20
sprpriority = 2
facep2=1

[State 0, Explod]
type = Explod
trigger1 = time = 0
anim = F73
ID = 73
pos = 0,-30
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
pausemovetime = 999
scale = 1,1
sprpriority = 7
ontop = 1
removeongethit = 1

;======================================
[State 600, just frame]
type = PalFX
trigger1=time=0
time = 3
add = 100,100,180
mul = 256,256,256
sinadd = -80,-80,-80,10
invertall = 0
color = 0
ignorehitpause = 1
persistent = 1

[State 600, EnvColor]
type = EnvColor
trigger1=time=0
value = 255,255,255
time = 1
under = 1
ignorehitpause = 1
persistent = 1

[State 600, EnvShake]
type = EnvShake
trigger1=time=0
time = 10
freq = 60
ampl = -4
phase = 90
ignorehitpause =1
persistent =1

[State 200, sfx]
type = PlaySnd
trigger1 = Time = 0
value = 20,0
volume=200

[State 210, 2]
type = HitDef
trigger1 =time=0
priority = 4, Hit
attr = S, NA
animtype  = hard
damage    = 0
hitflag = MAFD
guardflag = MA
pausetime = 25,25
sparkno = -1
sparkxy = -10,-37
hitsound   = 0,0
guardsound = 6,0
ground.type = High
ground.slidetime = 3
ground.hittime  = 20
ground.velocity = -35,0
air.velocity = -5,-3
air.hittime  = 20

[State 600, 1]
type = PlaySnd
trigger1 = Time = 1
value = 5,22

[State 200, vox]
type = PlaySnd
trigger1 = Time = 0
value = 6,19
volume=200
channel=0

;[state 200, ctrl reset]
;type=ctrlset
;trigger1=time=10
;value=1

[State 200, 7]
type = selfstate
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;------------------
; hit by air strong punch
[Statedef 1025]
type    = S
movetype= I
physics = N

[state 1026, velset]
type=velset
trigger1=1
x=-18
y=0

[State 0, AfterImage]
type = AfterImage
trigger1 = 1
length = 30
palcolor = 256
palinvertall = 0
palbright = 30,30,30
palcontrast = 120,120,220
palpostbright = 0,0,0
paladd = 10,10,25
palmul = .65,.65,.75
timegap = 1
framegap = 4
trans = "add" ;"none","add1","sub'

;[State 1026, Gravity]
;type = VelAdd
;trigger1 = 1
;y = .45

;[State 1026, No scroll]
;type = ScreenBound
;triggerall = Pos y < -15
;trigger1 = BackEdgeBodyDist < 65
;trigger2 = FrontEdgeBodyDist < 65
;value = 1
;movecamera = 0,1

[State 1026, Hit wall]
type = ChangeState
triggerall = Pos y < -5
trigger1 = BackEdgeBodyDist <= 20
trigger2 = FrontEdgeBodyDist <= 20
value = 1027

[State 1000, Land]
type= changestate
trigger1= vel y > 0
trigger1= pos y > -vel y
value= 1029

;------------------
; hit by air strong punch
[Statedef 1026]
type    = S
movetype= I
physics = N

[state 1026, velset]
type=velset
trigger1=time=[1,9999]
x=-18
y=0

[State 0, AfterImage]
type = AfterImage
trigger1 = 1
length = 30
palcolor = 256
palinvertall = 0
palbright = 30,30,30
palcontrast = 120,120,220
palpostbright = 0,0,0
paladd = 10,10,25
palmul = .65,.65,.75
timegap = 1
framegap = 4
trans = "add" ;"none","add1","sub'

;[State 1026, Gravity]
;type = VelAdd
;trigger1 = 1
;y = .45

[State 1026, No scroll]
type = ScreenBound
triggerall = Pos y < -15
trigger1 = BackEdgeBodyDist < 65
trigger2 = FrontEdgeBodyDist < 65
value = 1
movecamera = 0,1

[State 1026, Hit wall]
type = ChangeState
triggerall = Pos y < -5
trigger1 = BackEdgeBodyDist <= 20
trigger2 = FrontEdgeBodyDist <= 20
value = 1027

[State 1000, Land]
type= changestate
trigger1= vel y > 0
trigger1= pos y > -vel y
value= 1029

;------------------
; hit wall
[Statedef 1027]
type    = A
movetype= H
physics = A

;[State 1027, Turn]
;type = Turn
;trigger1 = (Time = 0) && (FrontEdgeBodyDist <= 30)

[State 1027, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[State 1027, Pos]
type = PosAdd
trigger1 = Time = 0
x = 15 - BackEdgeBodyDist

[State 1027, No scroll]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,1

[State 1027, Spark]
type = Explod
trigger1 = Time = 0
anim = F72
pos = 0, floor (screenpos y) - 50
postype = back
sprpriority = 3
scale = 1.5,1.5;ground

;[State 1027, Anim]
;type = ChangeAnim2
;trigger1 = Time = 0
;value = 5030

[State 1027, Sound]
type = PlaySnd
trigger1 = Time = 0
value = F7,0

[State 1027, State]
type = ChangeState
trigger1 = Time = 3
value = 1028

;------------------
;bounce off wal
[Statedef 1028]
type    = A
movetype= H
physics = N

;[State 1028, 1]
;type = NotHitBy
;trigger1 = 1
;value = , NA, NP

[State 1028, Vel Y]
type = VelSet
trigger1 = Time = 0
y = -3

[State 1028, Vel X]
type = VelSet
trigger1 = Time = 0
x = 3

[State 1028, Turn]
type = Turn
trigger1 = (Time = 0) && (BackEdgeDist < 30)

[State 1028, Gravity]
type = VelAdd
trigger1 = 1
y = .35

[State 1028, Anim 5062] ;Coming down - diagup type
type = ChangeAnim
trigger1 = time=0
;trigger1 = SelfAnimExist(5062)
;persistent = 0
value = 5061

[State 1028, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100

;---------------------------------------------------------------------------
; Ground hit
[StateDef 1029]
type = S
movetype= I
physics = N
juggle  = 1
velset = vel x,-6
ctrl = 0
anim = 5100
poweradd = 20
sprpriority = 2

[State 1028, Gravity]
type = VelAdd
trigger1 = 1
y = .35

[State 1028, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100
; 

;---------------------------------------------------------------------------
; Air Slide Start
[Statedef 5600]
Type     = A
MoveType = H
Physics  = N
Ctrl     = 0
VelSet   = 0,0
facep2 = 1

[state 5000, ivan override]
type=null
;type=changestate
triggerall=ishelper
trigger1=time=0
value=stateno+40000

[State -1]
Type = PosSet
Trigger1 = Pos Y > 0
Y = 0
IgnoreHitPause = 1
Persistent = 0
SuperMoveTime = 9999
PauseMoveTime = 9999

[State -1]
Type = HitFallSet
Trigger1 = 1
Value = 0
IgnoreHitPause = 1
Persistent = 0
SuperMoveTime = 9999
PauseMoveTime = 9999

[State -1]
Type = OffSet
Trigger1 = Time >= 0
X = 1
Persistent = 4

[State -1]
Type = OffSet
Trigger1 = Time >= 2
X = -1
Persistent = 4

[State -1]
Type = ChangeAnim
TriggerAll = SelfAnimExist(5030)
Trigger1 = 1
Value = 5030

[State -1]
type=selfstate
;Type = changestate
Trigger1 = GetHitVar(HitShakeTime) = 0
Value = 5601

[State -1]
type=selfstate
;Type = ChangeState
trigger1 = ishelper
Trigger1 = GetHitVar(HitShakeTime) = 0
Value = 45601

;---------------------------------------------------------------------------
;= Air Slide Fly
[Statedef 5601]
Type     = A
MoveType = H
Physics  = N
Ctrl     = 0
VelSet   = 0,0

[State -1]
Type = PlayerPush
Trigger1 = Time >= 0
Value = 0
IgnoreHitPause = 1
Persistent = 1
SuperMoveTime = 9999
PauseMoveTime = 9999

[State -1]
Type = Width
Trigger1 = 1
Edge = 0,-Const(Size.Air.Back)
IgnoreHitPause = 1
SuperMoveTime = 9999
PauseMoveTime = 9999

[State -1]
Type = VelSet
;triggerall = facing != enemynear,facing
Trigger1 = Time = 0
X = -22

; [State -1]
; Type = VelSet
; triggerall = facing = enemynear,facing
; Trigger1 = Time = 0
; X = 22

[State -1]
Type = ChangeAnim
TriggerAll = SelfAnimExist(5030)
Trigger1 = Time = 0
Value = 5030

[State -1]
Type = ChangeAnim
TriggerAll = SelfAnimExist(5035)
Trigger1 =! SelfAnimExist(5030)
Trigger1 = Time = 0
Trigger2 = Anim = 5030
Trigger2 = AnimTime = 0
Value = 5035

[State -1]
Type = ChangeAnim
TriggerAll = SelfAnimExist(5050)
Trigger1 =! SelfAnimExist(5030)
Trigger1 =! SelfAnimExist(5035)
Trigger1 = Time = 0
Trigger2 = Anim = 5030
Trigger2 = AnimTime = 0
Trigger3 = Anim = 5035
Trigger3 = AnimTime = 0
Value = 5050

[State -1]
Type = ScreenBound
Trigger1 = Time <= 25
Value = 1
MoveCamera = 1,1

[State -1]
Type = ScreenBound
Trigger1 = Time > 25
Value = 1
MoveCamera = 0,1
;
;[State 0, Explod]
;type = explod
;trigger1 = backedgedist <=0 && canrecover = 0
;anim = F72
;ID = 72
;pos = 0,-40
;scale = 1.5,1.5;ground
;removetime = -2
;
;[State 0, Explod]
;type = explod
;trigger1 = backedgedist <=0 && canrecover = 1
;anim = F70
;ID = 70
;pos = 0,-40
;scale = 1.5,1.5;ground
;removetime = -2

[State 0, EnvShake]
type = EnvShake
trigger1 = BackEdgeDist <= 0
time = 1
freq = 60
ampl = -4
phase = 90

[State 0, PlaySnd]
type = PlaySnd
trigger1 = BackEdgeDist <= 0
value = F7,1
volume = 255
channel = -1
freqmul = 1.0

[State -1]
Type = ChangeState
TriggerAll = Time = [0,11]
TriggerAll = BackEdgeDist = [-999,10]
Trigger1 = 1
Value = 5602

[State -1]
Type = ChangeState
TriggerAll = Time >= 12
TriggerAll = BackEdgeDist = [-999,10]
Trigger1 = 1
Value = 5603

;---------------------------------------------------------------------------
;= Air Slide Cont
[Statedef 5602]
Type     = A
MoveType = H
Physics  = N
Ctrl     = 0
VelSet   = 0,0

[State -1]
Type = Width
Trigger1 = Time = [0,6]
Edge = -Const(Size.Air.Front),-Const(Size.Air.Back)
IgnoreHitPause = 1
SuperMoveTime = 9999
PauseMoveTime = 9999

[State -1]
Type = Width
Trigger1 = Time >= 7
Trigger1 = Const(Size.Air.Front)-(Time-7) > 0
Edge = -Const(Size.Air.Front)+(Time-7),0
IgnoreHitPause = 1
SuperMoveTime = 9999
PauseMoveTime = 9999

[State -1]
Type = HitFallSet
Trigger1 = Vel Y > 0
Trigger1 = Pos Y >= -30
Trigger2 = Vel Y > 4
Value = 1
IgnoreHitPause = 1
Persistent = 0
SuperMoveTime = 9999
PauseMoveTime = 9999

;[State 5100, tech]
;type = ChangeState
;triggerall = time < 12
;triggerall = var(49) = 1;gethitvar(fall.recover) = 1;canrecover = 1
;trigger1 = command="a" || command="b" || command="c" || command="x" || command="y" || command="z"
trigger2 = command="holdA" || command="holdB" || command="holdC" 
;value = 8065
;
;[State 0, Explod]
;type = explod
;trigger1 = time = 0 && var(49) = 0 ;gethitvar(fall.recover) = 0
;anim = F72
;ID = 72
;pos = 0,-40
;scale = 1.5,1.5;ground
;removetime = -2
;
;[State 0, Explod]
;type = explod
;trigger1 = time = 0 && var(49) = 1;gethitvar(fall.recover) = 1
;anim = F70
;ID = 70
;pos = 0,-40
;scale = 1.5,1.5;ground
;removetime = -2

; [State -1]
; Type = SelfState
; TriggerAll = Vel Y > 0
; TriggerAll = Pos Y >= -30
; TriggerAll = Alive
; TriggerAll = CanRecover
; Trigger1 = Command = "recovery" || Command = "a" || Command = "b" || Command = "c" || Command = "x" || Command = "y" || Command = "z"
; Value = 5200
; 
; [State -1]
; Type = SelfState
; TriggerAll = Vel Y > 4
; TriggerAll = Alive
; TriggerAll = CanRecover
; Trigger1 = Command = "recovery" || Command = "a" || Command = "b" || Command = "c" || Command = "x" || Command = "y" || Command = "z"
; Value = 5210
; 
[State -1]
Type = ChangeAnim
TriggerAll = SelfAnimExist(5030)
Trigger1 = Time = 0
Value = 5030

[State -1]
Type = ChangeAnim
TriggerAll = SelfAnimExist(5035)
Trigger1 =! SelfAnimExist(5030)
Trigger1 = Time = 0
Trigger2 = Anim = 5030
Trigger2 = AnimTime = 0
Value = 5035

[State -1]
Type = ChangeAnim
TriggerAll = SelfAnimExist(5050)
Trigger1 =! SelfAnimExist(5030)
Trigger1 =! SelfAnimExist(5035)
Trigger1 = Time = 0
Trigger2 = Anim = 5030
Trigger2 = AnimTime = 0
Trigger3 = Anim = 5035
Trigger3 = AnimTime = 0
Value = 5050

[State -1]
Type = EnvShake
Trigger1 = Time = 0
Time  = 10
Ampl  = 5
Freq  = 90

[State -1]
Type = VelSet
Trigger1 = Time = 5
X = -1.5
Y = -6.6

[State -1]
Type = VelAdd
Trigger1 = Time >= 6
Y = .48+(enemy,fvar(20))

[State -1]
Type = Turn
Trigger1 = Time = 0

[State -1]
Type = SelfState
Trigger1 = (Vel Y > 0) && (Pos Y >= 0)
Value = 5100

;---------------------------------------------------------------------------
;= Air Slide Fall
[Statedef 5603]
Type     = A
MoveType = H
Physics  = N
Ctrl     = 0
VelSet   = 0,0

[State -1]
Type = Width
Trigger1 = Time = [0,6]
Edge = -Const(Size.Air.Front),-Const(Size.Air.Back)
IgnoreHitPause = 1
SuperMoveTime = 9999
PauseMoveTime = 9999

[State -1]
Type = Width
Trigger1 = Time >= 7
Trigger1 = Const(Size.Air.Front)-(Time-7) > 0
Edge = -Const(Size.Air.Front)+(Time-7),0
IgnoreHitPause = 1
SuperMoveTime = 9999
PauseMoveTime = 9999

[State 5100, tech]
type = ChangeState
triggerall = time < 12
triggerall = var(49) = 1;gethitvar(fall.recover) = 1;canrecover = 1
trigger1 = command="a" || command="b" || command="c" || command="x" || command="y" || command="z"
trigger2 = command="holdA" || command="holdB" || command="holdC" 
value = 8065

[State 0, Explod]
type = explod
trigger1 = time = 0 && var(49) = 0 ;gethitvar(fall.recover) = 0
anim = F72
ID = 72
pos = 0,-40
scale = 1.5,1.5;ground
removetime = -2

[State 0, Explod]
type = explod
trigger1 = time = 0 && var(49) = 1;gethitvar(fall.recover) = 1
anim = F70
ID = 70
pos = 0,-40
scale = 1.5,1.5;ground
removetime = -2

[State -1]
Type = ChangeAnim
triggerall =!ishelper
TriggerAll = SelfAnimExist(5030)
Trigger1 = Time = 0
Value = 5030

[State -1]
Type = ChangeAnim
triggerall =!ishelper
TriggerAll = SelfAnimExist(5035)
Trigger1 =! SelfAnimExist(5030)
Trigger1 = Time = 0
Trigger2 = Anim = 5030
Trigger2 = AnimTime = 0
Value = 5035

[State -1]
Type = ChangeAnim
triggerall =!ishelper
TriggerAll = SelfAnimExist(5050)
Trigger1 =! SelfAnimExist(5030)
Trigger1 =! SelfAnimExist(5035)
Trigger1 = Time = 0
Trigger2 = Anim = 5030
Trigger2 = AnimTime = 0
Trigger3 = Anim = 5035
Trigger3 = AnimTime = 0
Value = 5050

[State -1]
Type = ChangeAnim
triggerall =ishelper
TriggerAll = SelfAnimExist(45030)
Trigger1 = Time = 0
Value = 45030

[State -1]
Type = ChangeAnim
triggerall =ishelper
TriggerAll = SelfAnimExist(45035)
Trigger1 =! SelfAnimExist(45030)
Trigger1 = Time = 0
Trigger2 = Anim = 45030
Trigger2 = AnimTime = 0
Value = 45035

[State -1]
Type = ChangeAnim
triggerall =ishelper
TriggerAll = SelfAnimExist(45050)
Trigger1 =! SelfAnimExist(45030)
Trigger1 =! SelfAnimExist(45035)
Trigger1 = Time = 0
Trigger2 = Anim = 45030
Trigger2 = AnimTime = 0
Trigger3 = Anim = 45035
Trigger3 = AnimTime = 0
Value = 45050

[State -1]
Type = EnvShake
Trigger1 = Time = 0
Time  = 10
Ampl  = 5
Freq  = 90

[State -1]
Type = VelSet
Trigger1 = Time = 5
X = -1.5
Y = -6.6

[State -1]
Type = VelAdd
Trigger1 = Time >= 6
Y = .48+(enemy,fvar(20))

[State -1]
Type = HitFallSet
TriggerAll = Time = 6
Trigger1 = 1
Value = 1
IgnoreHitPause = 1
Persistent = 0
SuperMoveTime = 9999
PauseMoveTime = 9999

[State -1]
Type = Turn
Trigger1 = Time = 0

[State -1]
Type = SelfState
triggerall =!ishelper
Trigger1 = (Vel Y > 0) && (Pos Y >= 0)
Value = 5102

[State -1]
Type = SelfState
triggerall =ishelper
Trigger1 = (Vel Y > 0) && (Pos Y >= 0)
Value = 45100

;---------------------------------------------------------------------------
; Down Air Slide Start
[Statedef 5700]
Type     = A
MoveType = H
Physics  = N
Ctrl     = 0
VelSet   = 0,0
facep2 = 1

[state 5000, ivan override]
type=null
;type=changestate
triggerall=ishelper
trigger1=time=0
value=stateno+40000

[State -1]
Type = PosSet
Trigger1 = Pos Y > 0
Y = 0
IgnoreHitPause = 1
Persistent = 0
SuperMoveTime = 9999
PauseMoveTime = 9999

[State -1]
Type = HitFallSet
Trigger1 = 1
Value = 0
IgnoreHitPause = 1
Persistent = 0
SuperMoveTime = 9999
PauseMoveTime = 9999

[State -1]
Type = OffSet
Trigger1 = Time >= 0
X = 1
Persistent = 4

[State -1]
Type = OffSet
Trigger1 = Time >= 2
X = -1
Persistent = 4

[State -1]
Type = ChangeAnim
TriggerAll = SelfAnimExist(5030)
Trigger1 = 1
Value = 5030

[State -1]
type=selfstate
;Type = changestate
Trigger1 = GetHitVar(HitShakeTime) = 0
Value = 5701

;---------------------------------------------------------------------------
;= Air Slide Fly
[Statedef 5701]
Type     = A
MoveType = H
Physics  = N
Ctrl     = 0
VelSet   = 0,0

[State -1]
Type = PlayerPush
Trigger1 = Time >= 0
Value = 0
IgnoreHitPause = 1
Persistent = 1
SuperMoveTime = 9999
PauseMoveTime = 9999

[State -1]
Type = Width
Trigger1 = 1
Edge = 0,-Const(Size.Air.Back)
IgnoreHitPause = 1
SuperMoveTime = 9999
PauseMoveTime = 9999

[State -1]
Type = VelSet
;triggerall = facing != enemynear,facing
Trigger1 = Time = 0
X = -3
Y = 30

; [State -1]
; Type = VelSet
; triggerall = facing = enemynear,facing
; Trigger1 = Time = 0
; X = 22

[State -1]
Type = ChangeAnim
TriggerAll = SelfAnimExist(5030)
Trigger1 = Time = 0
Value = 5030

[State -1]
Type = ChangeAnim
TriggerAll = SelfAnimExist(5035)
Trigger1 =! SelfAnimExist(5030)
Trigger1 = Time = 0
Trigger2 = Anim = 5030
Trigger2 = AnimTime = 0
Value = 5035

[State -1]
Type = ChangeAnim
TriggerAll = SelfAnimExist(5050)
Trigger1 =! SelfAnimExist(5030)
Trigger1 =! SelfAnimExist(5035)
Trigger1 = Time = 0
Trigger2 = Anim = 5030
Trigger2 = AnimTime = 0
Trigger3 = Anim = 5035
Trigger3 = AnimTime = 0
Value = 5050

[State -1]
Type = ScreenBound
Trigger1 = Time <= 1
Value = 1
MoveCamera = 1,1

[State -1]
Type = ScreenBound
Trigger1 = Time > 1
Value = 1
MoveCamera = 0,1

[State 1000, Land]
type= selfstate
trigger1= vel y > 0
trigger1= pos y > -vel y
value= 5703
ctrl=0

;---------------------------------------------------------------------------
;= Air Slide Fall
[Statedef 5703]
Type     = S
MoveType = H
Physics  = N
Ctrl     = 0
VelSet   = 0,0
anim = 5080

[State 0, CtrlSet]
type = CtrlSet
trigger1 = 1
value = 0
ignorehitpause = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = 1
value = 5080
ignorehitpause =1

[State 0, SelfState]
type = SelfState
trigger1 = animtime = 0
value = 5703
ctrl = 0

;---------------------------------------------------------------------------
; Shakestun Recovery
[StateDef 1995]
type = S
movetype= H
physics = N
juggle  = 1
velset = 0,0
ctrl = 1
anim = 1995
poweradd = 0
sprpriority = 2

[state 5000, ivan override]
type=null
triggerall=ishelper
trigger1=time=0
value=stateno+40000

[State 0, PalFXWiz]
type = PalFX
trigger1 = time=0
time = 5
add = 240,50,0
mul = 250,224,120
sinadd = 110,55,85,10
invertall = 0
color = 0
;ignorehitpause = 0
;persistent = 1

[state 0, fall]
type=selfstate
trigger1=animtime=0
value=0
ctrl=1

;---------------------------------------------------------------------------
; Shakestun Light
[StateDef 1996]
type = S
movetype= H
physics = N
juggle  = 1
velset = 0,0
ctrl = 0
anim = 1999
poweradd = 0
sprpriority = 2

[state 5000, ivan override]
type=null
triggerall=ishelper
trigger1=time=0
value=stateno+40000

[State 5050, 3] ;Gravity
type = VelAdd
triggerall = pos y<0
trigger1 = 1
y = GetHitVar(yaccel)

[State 0, PosSet]
type = PosSet
trigger1 =pos y>0
y = 0

; [state 0, unstun]
; type=selfstate
; triggerall=time>=30
; trigger1=command="360"
; value=1995
; ctrl=1

[state 0, unstun]
type=selfstate
triggerall=time>=30
trigger1=var(15)=1
value=1995
ctrl=1

[state 0, fall]
type=selfstate
trigger1=animtime=0
value=5050
ctrl=0

;---------------------------------------------------------------------------
; Shakestun Mid
[StateDef 1997]
type = S
movetype= H
physics = N
juggle  = 1
velset = 0,0
ctrl = 0
anim = 1999
poweradd = 0
sprpriority = 2

[State 5050, 3] ;Gravity
type = VelAdd
triggerall = pos y<0
trigger1 = 1
y = GetHitVar(yaccel)

[State 0, PosSet]
type = PosSet
trigger1 =pos y>0
y = 0

; [state 0, unstun]
; type=selfstate
; triggerall=time>=60
; trigger1=command="360"
; value=1995
; ctrl=1

[state 0, unstun]
type=selfstate
triggerall=time>=60
trigger1=var(15)=1
value=1995
ctrl=1

[state 0, fall]
type=selfstate
trigger1=animtime=0
value=5050
ctrl=1

;---------------------------------------------------------------------------
; Shakestun Strong
[StateDef 1998]
type = S
movetype= H
physics = N
juggle  = 1
velset = 0,0
ctrl = 0
anim = 1999
poweradd = 0
sprpriority = 2

[State 5050, 3] ;Gravity
type = VelAdd
triggerall = pos y<0
trigger1 = 1
y = GetHitVar(yaccel)

[State 0, PosSet]
type = PosSet
trigger1 =pos y>0
y = 0

; [state 0, unstun]
; type=selfstate
; triggerall=time>=90
; trigger1=command="360"
; value=1995
; ctrl=1

[state 0, unstun]
type=selfstate
triggerall=time>=90
trigger1=var(15)=1
value=1995
ctrl=1

[state 0, fall]
type=selfstate
trigger1=animtime=0
value=5050
ctrl=1

;---------------------------------------------------------------------------
; Shakestun Full
[StateDef 1999]
type = S
movetype= H
physics = N
juggle  = 1
velset = 0,0
ctrl = 0
anim = 1999
poweradd = 0
sprpriority = 2

[State 5050, 3] ;Gravity
type = VelAdd
triggerall = pos y<0
trigger1 = 1
y = GetHitVar(yaccel)

[State 0, PosSet]
type = PosSet
trigger1 =pos y>0
y = 0

[state 0, fall]
type=selfstate
trigger1=animtime=0
value=5050
ctrl=1


;***************************************************************************************************;
;***************************************************************************************************;

;
; **********************
; **  State overides  **
; **********************
;
; Overides for common, -2, and -3 states
; PLEASE READ CAREFULLY: IF THE CHARACTER DOES NOT HAVE THESE STATES, FOLLOW
; THE HINTS (MARKED WITH THE FOLLOWING: -!!!->) TO OVERIDE THE CHARACTERS
; STATES.
;
; PLEASE GIVE CREDIT IF MODIFYING THIS!!!

;***************************************************************************************************;
;***************************************************************************************************;






;---------------------------------------------------------------------------
; Initialize (at the start of the round)
[Statedef 5900]
type = S

[State 5900, 0] ;Clear all int variables
type = VarRangeSet
trigger1 = roundno = 1
value = 0
last = 49

[State 5900, 1] ;Clear all float variables
type = VarRangeSet
trigger1 = roundno = 1
fvalue = 0


;-!!!-> ADD THESE AT THE BOTTOM IF THIS STATEDEF ALREADY EXISTS IN THE CHARACTER (NOT IN COMMON1.CNS);
;	REMEMBER TO DELETE ANY "CHANGESTATES" ALREADY IN THE STATEDEF. <-!!!-;


[State 5900, 7]
type = VarSet
triggerall = NumPartner
trigger1 = RoundState < 2
trigger1 = Var(53) = 0
v = 53
value = 1

[State 5900, 10] ;Intro W/Partner
type = TagIn
triggerall = partner, stateno != [4510,4512]	; Partner not waiting outside the screen (thus on stage)
triggerall = NumPartner
triggerall = ID > Partner,ID
trigger1 = roundno = 1
trigger1 = Time = [0, 1]
trigger1 = RoundState <= 2
trigger1 = Partner, Life > 0
trigger1 = StateNo != [4510, 4512]
stateno = 4510
partnerstateno = 190

[State 5900, 11] ;Intro
type = ChangeState
trigger1 = roundno = 1
trigger1 = !NumPartner ; partner does not exist
value = 190

;---------------------------------------------------------------------------
; HITG_SHAKE
[Statedef 5000]
type    = S
movetype= H
physics = N
velset = 0,0

[State 0, CtrlSet]
type = CtrlSet
trigger1 = 1
value = 0
ignorehitpause = 1
persistent = 1

[state 5000, ivan override]
type=null
triggerall=ishelper
trigger1=time=0
value=stateno+40000

[State 5000, 1] ;Anim for HIT_LIGHT to HIT_HARD
type = ChangeAnim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) != [3,5]
value = ifelse((GetHitVar(groundtype) = 1),5000,5010) + GetHitVar(animtype)

[State 5000, 2] ;Anim for HITBACK
type = ChangeAnim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) = [3,5]
value = 5030

[State 5000, 3] ;Anim for HIT_UP/HIT_DIAGUP (only if it exists)
type = ChangeAnim
trigger1 = Time = 0
trigger1 = (GetHitVar(animtype) = [4,5]) && (SelfAnimExist(5047 + GetHitVar(animtype)))
value = 5047 + GetHitVar(animtype) ;5051 - 4 + type

[State 5000, 4] ;Freeze anim
type = ChangeAnim
trigger1 = Time > 0
value = anim

[State 5000, 5] ;State type gets set to aerial if getting hit up
type = StateTypeSet
trigger1 = Time = 0
trigger1 = GetHitVar(yvel) != 0 || GetHitVar(fall)
trigger2 = Pos Y != 0
statetype = a

[State 5000, 6]
type = ChangeState
trigger1 = HitShakeOver
trigger1 = GetHitVar(yvel) = 0 && !GetHitVar(fall)
value = 5001 ;HITG_SLIDE

[State 5000, 7]
type = ChangeState
trigger1 = HitShakeOver
value = 5030

[State 5000, FFB Light]
type = ForceFeedback
trigger1 = anim = 5000
trigger2 = anim = 5010
persistent = 0
time = 6
waveform = square

[State 5000, FFB Medium]
type = ForceFeedback
trigger1 = anim = 5001
trigger2 = anim = 5011
persistent = 0
time = 8
waveform = sinesquare
ampl = 110,-1,-.3

[State 5000, FFB Hard]
type = ForceFeedback
trigger1 = anim = 5012
trigger2 = anim = 5002
trigger3 = anim = 5030
persistent = 0
time = 15
waveform = sinesquare
ampl = 140

;---------------------------------------------------------------------------
; HITG_SLIDE
[Statedef 5001]
type    = S
movetype= H
physics = S

[state 5000, ivan override]
type=null
triggerall=ishelper
trigger1=time=0
value=stateno+40000

[State 5001, 1]
type = HitVelSet
trigger1 = Time = 0
x = 1

[State 5001, 2]
type = ChangeAnim
trigger1 = AnimTime = 0
value = 5005 + GetHitVar(animtype) + (GetHitVar(groundtype)=2)*10

[State 5001, 3] ;Stop sliding back
type = VelMul
trigger1 = Time >= GetHitVar(slidetime)
x = .6

[State 5001, 4]
type = VelSet
trigger1 = HitOver
x = 0

[State 5001, 5]
type = DefenceMulSet
trigger1 = HitOver
value = 1

[State 5001, 6]
type = ChangeState
trigger1 = HitOver
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; HITC_SHAKE
[Statedef 5010]
type    = C
movetype= H
physics = N
velset = 0,0

[state 5000, ivan override]
type=null
triggerall=ishelper
trigger1=time=0
value=stateno+40000

[State 5010, 1] ;Anim for HIT_LIGHT to HIT_HARD
type = ChangeAnim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) != [3,5]
value = 5020 + GetHitVar(animtype)

[State 5010, 2] ;Anim for HITBACK
type = ChangeAnim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) = [3,5]
value = 5030

[State 5010, 3] ;Anim for HIT_UP/HIT_DIAGUP (only if it exists)
type = ChangeAnim
trigger1 = Time = 0
trigger1 = (GetHitVar(animtype) = [4,5]) && (SelfAnimExist(5047 + GetHitVar(animtype)))
value = 5047 + GetHitVar(animtype) ;5051 - 4 + type

[State 5010, 4] ;Freeze anim
type = ChangeAnim
trigger1 = Time > 0
value = anim

[State 5010, 5] ;State type gets set to aerial if getting hit up
type = StateTypeSet
triggerall = Time = 0
trigger1 = GetHitVar(yvel) != 0 || GetHitVar(fall)
trigger2 = Pos Y != 0
statetype = a

[State 5010, 6]
type = ChangeState
trigger1 = HitShakeOver
trigger1 = GetHitVar(yvel) = 0 && !GetHitVar(fall)
value = 5011 ;HITC_SLIDE

[State 5010, 7]
type = ChangeState
trigger1 = HitShakeOver
value = 5030

[State 5010, FFB Light]
type = ForceFeedback
trigger1 = anim = 5020
persistent = 0
time = 6
waveform = square

[State 5010, FFB Medium]
type = ForceFeedback
trigger1 = anim = 5021
persistent = 0
time = 8
waveform = sinesquare
ampl = 110,-1,-.3

[State 5010, FFB Hard]
type = ForceFeedback
trigger1 = anim = 5022
persistent = 0
time = 15
waveform = sinesquare
ampl = 140

;---------------------------------------------------------------------------
; HITC_SLIDE
[Statedef 5011]
type    = C
movetype= H
physics = C

[state 5000, ivan override]
type=null
triggerall=ishelper
trigger1=time=0
value=stateno+40000

[State 5011, 1]
type = HitVelSet
trigger1 = Time = 0
x = 1

[State 5011, 2]
type = ChangeAnim
trigger1 = AnimTime = 0
value = 5025 + GetHitVar(animtype)

[State 5011, 3] ;Stop sliding back
type = VelMul
trigger1 = Time >= GetHitVar(slidetime)
x = .6

[State 5011, 4]
type = VelSet
trigger1 = HitOver
x = 0

[State 5011, 5]
type = DefenceMulSet
trigger1 = HitOver
value = 1

[State 5011, 6]
type = ChangeState
trigger1 = HitOver
value = 11
ctrl = 1

;---------------------------------------------------------------------------
; HITA_SHAKE
[Statedef 5020]
type    = A
movetype= H
physics = N
velset = 0,0
facep2=1

[State 0, break reset]
type = VarSet
trigger1 = time=0
var(50)=0
ignorehitpause = 1

[State 0, break a]
type = VarSet
triggerall=var(50)=0
trigger1=command="a" 
var(50)=1
ignorehitpause = 1

[State 0, break b]
type = VarSet
triggerall=var(50)=0
trigger1=command="b" 
var(50)=2
ignorehitpause = 1

[State 0, break c]
type = VarSet
triggerall=var(50)=0
trigger1=command="c" 
var(50)=3
ignorehitpause = 1

[State 5020, 1] ;Anim for HIT_LIGHT to HIT_HARD
type = ChangeAnim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) != [3,5]
value = ifelse((GetHitVar(airtype) = 1),5000,5010) + GetHitVar(animtype)

[State 5020, 2] ;Anim for HITBACK
type = ChangeAnim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) = [3,5]
value = 5030

[State 5020, 3] ;Anim for HIT_UP/HIT_DIAGUP (only if it exists)
type = ChangeAnim
trigger1 = Time = 0
trigger1 = (GetHitVar(animtype) = [4,5]) && (SelfAnimExist(5047 + GetHitVar(animtype)))
value = 5047 + GetHitVar(animtype) ;5051 - 4 + type

[State 5020, 4] ;Freeze anim
type = ChangeAnim
trigger1 = Time > 0
value = anim

[State 5020, 5]
type = selfstate
trigger1 = HitShakeOver
value = 5030

[State 5020, FFB Light]
type = ForceFeedback
trigger1 = anim = 5000
trigger2 = anim = 5010
persistent = 0
time = 6
waveform = square

[State 5020, FFB Medium]
type = ForceFeedback
trigger1 = anim = 5001
trigger2 = anim = 5011
persistent = 0
time = 8
waveform = sinesquare
ampl = 110,-1,-.3

[State 5020, FFB Hard]
type = ForceFeedback
trigger1 = anim = 5012
trigger2 = anim = 5002
trigger3 = anim = 5030
trigger4 = anim = [5051,5059]
persistent = 0
time = 15
waveform = sinesquare
ampl = 140

;---------------------------------------------------------------------------
; HITA_UP (initial going up)
[Statedef 5030]
type    = A
movetype= H
physics = N
ctrl = 0

[State 0, HitBy]
type = HitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT

time = 3

[State 5030, 1]
type = VelAdd;Gravity
trigger1 = 1
y = GetHitVar(yaccel)+(enemy,fvar(20))

[State 5030, 2]
type = HitVelSet
trigger1 = Time = 0
x = 1
y = 1

[State 5030, 3]
type = ChangeState
triggerall = !HitFall
trigger1 = HitOver
trigger2 = Vel Y > 0    ;Hit ground
trigger2 = Pos Y >= 10  ;.
value = 5040 ;HITA_RECOV

[State 5030, 4]
type = ChangeState
triggerall = HitFall
trigger1 = HitOver
trigger2 = Vel Y > 0    ;Hit ground
trigger2 = Pos Y >= 10  ;.
value = 5050 ;HITA_FALL

[State 5030, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 5035 ;HITA_UP (transition)

;---------------------------------------------------------------------------
; HITA_UP_T (transition)
[Statedef 5035]
type    = A
movetype= H
physics = N

[State 0, HitBy]
type = HitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT

time = 3

[State 5035, 1]
type = ChangeAnim
trigger1 = Time = 0
trigger1 = SelfAnimExist(5035)
trigger1 = Anim != [5051,5059] ;Not if in hit up anim
trigger1 = Anim != 5090 ;Not if hit off ground anim
value = 5035

[State 5030, 1]
type = VelAdd;Gravity
trigger1 = 1
y = GetHitVar(yaccel)+(enemy,fvar(20))

[State 5035, 3]
type = ChangeState
triggerall = !HitFall
trigger1 = HitOver  ;Hit is over
trigger2 = AnimTime = 0 ;Animation over
trigger3 = Vel Y > 0    ;Hit ground
trigger3 = Pos Y >= 10  ;.
trigger4 = Time = 0     ;No transition anim
trigger4 = Anim != 5035 ;.
value = 5040 ;HITA_RECOV

[State 5035, 4]
type = ChangeState
triggerall = HitFall
trigger1 = HitOver  ;Hit is over
trigger2 = AnimTime = 0 ;Anim is over
trigger3 = Vel Y > 0    ;Hit ground
trigger3 = Pos Y >= 10  ;.
trigger4 = Time = 0     ;No transition anim
trigger4 = Anim != 5035 ;.
value = 5050 ;HITA_FALL

;---------------------------------------------------------------------------
; HITA_RECOV (recovering in air, not falling)
[Statedef 5040]
type    = A
movetype= H
physics = N

[State 0, HitBy]
type = HitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT

time = 3

[State 5040, 1]
type = ChangeState
trigger1 = !Alive
value = 5050

[State 5040, 2]
type = ChangeAnim
trigger1 = AnimTime = 0
trigger1 = Anim != 5040
trigger2 = Time = 0
trigger2 = Anim != 5035
value = 5040

[State 5040, 3]
type = CtrlSet
trigger1 = HitOver
value = 1

[State 5040, 4]
type = StateTypeSet
trigger1 = HitOver
movetype = I

[State 5030, 1]
type = VelAdd;Gravity
trigger1 = 1
y = GetHitVar(yaccel)+(enemy,fvar(20))

[State 5040, 6]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 52 ;JUMPLAND

;---------------------------------------------------------------------------
; HITA_FALL (knocked up, falling)
[Statedef 5050]
type    = A
movetype= H
physics = N

[State 0, HitBy]
type = HitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT

time = 3

[State 5050, 1] ;Change anim when done with transition
type = ChangeAnim
trigger1 = AnimTime = 0
trigger1 = Anim = 5035
trigger2 = Time = 0     ;If no transition anim
trigger2 = Anim != 5035
trigger2 = (Anim != [5051, 5059]) && (Anim != [5061, 5069])
trigger2 = Anim != 5090 ;Not if hit off ground anim
value = 5050

[State 5050, 2] ;Coming down anim
type = ChangeAnim
trigger1 = anim = [5050,5059]
trigger1 = Vel Y >= ifelse(anim = 5050, 1, -2)
trigger1 = SelfAnimExist(anim+10)
value = anim+10
persistent = 0

[State 5030, 1]
type = VelAdd;Gravity
trigger1 = 1
y = GetHitVar(yaccel)+(enemy,fvar(20))

[State 5050, 6]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= ifelse((anim = [5051,5059]) || (anim = [5061,5069]), 0, 25)
value = 5100 ;HITBOUNCE

;---------------------------------------------------------------------------
; HIT_TRIP (shaking)
[Statedef 5070]
type    = A
movetype= H
physics = N
velset = 0,0

[State 0, HitBy]
type = HitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT

time = 3

[State 5070, 1]
type = ChangeAnim 
trigger1 = 1
value = 5070

[State 5070, 2]
type = ChangeState
trigger1 = HitShakeOver
value = 5071

[State 5070, 3]
type = ForceFeedback
trigger1 = time = 0
time = 12
waveform = sinesquare
ampl = 140

;---------------------------------------------------------------------------
; HIT_TRIP2 (fall through air)
[Statedef 5071]
type    = A
movetype= H
physics = N

[State 0, HitBy]
type = HitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT

time = 3

[State 5071, 1]
type = HitVelSet
trigger1 = Time = 0
x = 1
y = 1

[State 5030, 1]
type = VelAdd;Gravity
trigger1 = 1
y = GetHitVar(yaccel)+(enemy,fvar(20))

[State 5071, 3] ;Hit ground
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 15
type = ChangeState
value = 5109

;---------------------------------------------------------------------------
; HITL_SHAKE
[Statedef 5080]
type    = L
movetype= H
physics = N
velset = 0,0

; [state 5000, ivan override]
; type=changestate
; triggerall=ishelper
; trigger1=time=0
; value=stateno+40000

[State 5080, 1] ;Set default anim
type = VarSet
trigger1 = time = 0
sysvar(2) = ifelse (GetHitVar(yvel) = 0, 5080, 5090)

[State 5080, 2]
type = VarAdd
trigger1 = time = 0
trigger1 = (anim = [5081,5089]) || (anim = [5111,5119])
trigger1 = SelfAnimExist(sysvar(2) + (anim % 10))
sysvar(2) = anim % 10

[State 5080, 3] ;If 5090 doesn't exist, default to 5030
type = VarSet
trigger1 = time = 0
trigger1 = sysvar(2) = 5090
trigger1 = !SelfAnimExist(5090)
sysvar(2) = 5030

[State 5080, 3] ;Freeze
type = ChangeAnim
trigger1 = 1
value = sysvar(2)

[State 5080, 4]
type = selfstate
trigger1 = HitShakeOver
trigger1 = GetHitVar(yvel) = 0
value = 5081 ;HITL_SLIDE

;[State 0, NotHitBy]
;type = NotHitBy
;triggerall = p2name = "Tsukiko"
;trigger1 = p2stateno = [3120,3125]
;trigger2 = p2stateno = [1181,1191]
;trigger3 = p2stateno = [3131,3191]
;value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
;time = 5

[State 5080, 5]
type = selfState
trigger1 = HitShakeOver
trigger1 = GetHitVar(yvel) != 0
;trigger2 = p2name = "Tsukiko" && p2stateno = [3120,3125] 
;trigger3 = p2name = "Tsukiko" && p2stateno = [1181,1191]
;trigger4 = p2name = "Tsukiko" && p2stateno = [3131,3191]
value = 5030 ;HITA_UP

;---------------------------------------------------------------------------
; HITL_SLIDE
[Statedef 5081]
type    = L
movetype= H
physics = C

; [state 5000, ivan override]
; type=changestate
; triggerall=ishelper
; trigger1=time=0
; value=stateno+40000

[State 5081, 1]
type = HitVelSet
trigger1 = Time = 0
x = 1

[State 5081, 2]
type = VelSet
trigger1 = HitOver
x = 0

[State 5081, 3] ;Don't show hit ground frame
type = VarSet
trigger1 = Time = 0
sysvar(0) = 1

[State 5081, 4]
type = ChangeState
trigger1 = HitOver
value = 5109 ;HIT_LIEDOWN

;---------------------------------------------------------------------------
; HITBOUNCE (hit ground)
[Statedef 5100]
type    = L
movetype= H
physics = N

; [state 5000, ivan override]
; type=changestate
; triggerall=ishelper
; trigger1=time=0
; value=stateno+40000

[State 0, HitBy]
type = HitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 3

[State 5100, 1]
type = VelSet
trigger1 = Time = 0
trigger1 = GetHitVar(fall.yvel) = 0
trigger1 = vel x > 1
x = 1

[State 5100, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 5100, Var] ;Save fall velocity
type = VarSet
trigger1 = Time = 0
sysvar(1) = floor(vel y)

[State 5100, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
trigger1 = (anim != [5051,5059]) && (anim != [5061,5069])
trigger2 = !SelfAnimExist(5100 + (anim % 10))
value = 5100

[State 5100, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
trigger1 = time = 0
trigger1 = (anim = [5051,5059]) || (anim = [5061,5069])
trigger1 = SelfAnimExist(5100 + (anim % 10))
value = 5100 + (anim % 10)

[State 5100, 4]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5100, 5]
type = VelSet
trigger1 = Time = 0
y = 0

[State 5100, 6] ;Reduce speed
type = VelMul
trigger1 = Time = 0
x = 0.75

[State 5100, 7]
type = ChangeState
trigger1 = Time = 0
trigger1 = GetHitVar(fall.yvel) = 0
value = 5109 ;HIT_LIEDOWN

;[State 5100, 8]
;type = GameMakeAnim
;trigger1 = Time = 1
;value = 60 + (sysvar(1) > 5) + (sysvar(1) > 14)
;pos = 0, 0
;under = sysvar(1) <= 14

[State 0, Explod]
type = explod
trigger1 = time = 1 && canrecover = 0
anim = F60
ID = 60
pos = 0,0
scale = 1.5,1.5;ground

[State 0, Explod]
type = explod
trigger1 = time = 1 && canrecover = 1
anim = F61
ID = 61
pos = 0,0
scale = 1.5,1.5;ground

[State 5100, 9]
type = HitFallDamage
trigger1 = Time = 3

[State 5100, 10]
type = PlaySnd
trigger1 = Time = 1
value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)

[State 5100, 11]
type = PosFreeze
trigger1 = 1

[State 5100, 12]
type = ChangeState
trigger1 = AnimTime = 0
value = 5101

[State 5100, tech]
type = ChangeState
triggerall = time<9;tech
triggerall = canrecover
trigger1 = command="a" || command="b" || command="c" || command="x" || command="y" || command="z"
trigger2 = command="holdA" || command="holdB" || command="holdC" 
value = 8065

[State 5100, 13]
type = ForceFeedback
trigger1 = Time = 0
waveform = sinesquare
ampl = 128,-3,-.2,.005
time = 20

;---------------------------------------------------------------------------
; HITBOUNCE (bounce into air)
[Statedef 5101]
type    = L
movetype= H
physics = N

[State 0, HitBy]
type = HitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 3

; [state 5000, ivan override]
; type=changestate
; triggerall=ishelper
; trigger1=time=0
; value=stateno+40000

[State 5101, 1] ;Coming hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim != [5101,5109]
trigger2 = !SelfAnimExist(5160 + (anim % 10))
value = 5160

[State 5101, 2] ;Coming hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim = [5101,5109]
trigger1 = SelfAnimExist(5160 + (anim % 10))
value = 5160 + (anim % 10)

[State 5101, 3]
type = HitFallVel
trigger1 = Time = 0

[State 5101, 4]
type = PosSet
trigger1 = Time = 0
y = 20

[State 5101, 5] ;Acceleration
type = VelAdd
trigger1 = 1
y = .4 + enemy,fvar(20)

[State 5100, tech]
type = ChangeState
triggerall = time<10;tech
triggerall = canrecover
trigger1 = command="a" || command="b" || command="c" || command="x" || command="y" || command="z"
trigger2 = command="holdA" || command="holdB" || command="holdC" 
value = 8065

[State 5101, 6] ;Hit ground
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 3; 12
type = ChangeState
value = 5109

;---------------------------------------------------------------------------
; HITBOUNCE (hit ground)
[Statedef 5102]
type    = L
movetype= H
physics = N

; [state 5000, ivan override]
; type=changestate
; triggerall=ishelper
; trigger1=time=0
; value=stateno+40000

[State 0, HitBy]
type = HitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT

time = 3

[State 5100, 1]
type = VelSet
trigger1 = Time = 0
trigger1 = GetHitVar(fall.yvel) = 0
trigger1 = vel x > 1
x = 1

[State 5100, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 5100, Var] ;Save fall velocity
type = VarSet
trigger1 = Time = 0
sysvar(1) = floor(vel y)

[State 5100, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
trigger1 = (anim != [5051,5059]) && (anim != [5061,5069])
trigger2 = !SelfAnimExist(5100 + (anim % 10))
value = 5100

[State 5100, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
trigger1 = time = 0
trigger1 = (anim = [5051,5059]) || (anim = [5061,5069])
trigger1 = SelfAnimExist(5100 + (anim % 10))
value = 5100 + (anim % 10)

[State 5100, 4]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5100, 5]
type = VelSet
trigger1 = Time = 0
y = 0

[State 5100, 6] ;Reduce speed
type = VelMul
trigger1 = Time = 0
x = 0.75

[State 5100, 7]
type = ChangeState
trigger1 = Time = 0
trigger1 = GetHitVar(fall.yvel) = 0
value = 5109 ;HIT_LIEDOWN

[State 0, Explod]
type = explod
trigger1 = time = 1 && canrecover = 0
anim = F60
ID = 60
pos = 0,0
scale = 1.5,1.5;ground

[State 0, Explod]
type = explod
trigger1 = time = 1 && canrecover = 1
anim = F61
ID = 61
pos = 0,0
scale = 1.5,1.5;ground

[State 5100, 9]
type = HitFallDamage
trigger1 = Time = 3

[State 5100, 10]
type = PlaySnd
trigger1 = Time = 1
value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)

[State 5100, 11]
type = PosFreeze
trigger1 = 1

[State 5100, 12]
type = ChangeState
trigger1 = AnimTime = 0
value = 5101

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 2
persistent = 1

[State 5100, tech]
type = ChangeState
triggerall = time<10;tech
triggerall = canrecover
trigger1 = command="a" || command="b" || command="c" || command="x" || command="y" || command="z"
trigger2 = command="holdA" || command="holdB" || command="holdC" 
value = 8065

[State 5100, 13]
type = ForceFeedback
trigger1 = Time = 0
waveform = sinesquare
ampl = 128,-3,-.2,.005
time = 20

;---------------------------------------------------------------------------
; HIT_LIEDOWN NEW
[Statedef 5109]
type    = L
movetype= H
physics = N
facep2 = 1
; 
[State 5109, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 5110, 1] ;For hit up/up-diag type (from state 5081)
type = ChangeAnim
persistent = 0
trigger1 = SelfAnimExist(5110 + (anim % 10))
trigger1 = anim = [5081,5089]
value = 5110 + (anim % 10)

[State 5110, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim != [5161,5169]
trigger2 = !SelfAnimExist(5170 + (anim % 10))
value = 5170

[State 5110, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim = [5161,5169]
trigger1 = SelfAnimExist(5170 + (anim % 10))
value = 5170 + (anim % 10)

[State 5110, 4]
type = HitFallDamage
trigger1 = Time = 0

[State 5110, 5]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5110, Var] ;Get fall velocity
type = VarSet
trigger1 = Time = 0
trigger1 = GetHitVar(fall.yvel) != 0
sysvar(1) = floor(vel y)

[State 5110, 6]
type = PlaySnd
trigger1 = Time = 0
trigger1 = !SysVar(0)
value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)

[State 0, Explod]
type = explod
trigger1 = time = 1 && canrecover = 0
anim = F60
ID = 60
pos = 0,0
scale = 1.5,1.5;ground

[State 0, Explod]
type = explod
trigger1 = time = 1 && canrecover = 1
anim = F61
ID = 61
pos = 0,0
scale = 1.5,1.5;ground

[State 5110, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 5110, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 5110, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 5110, 11] ;If just died
type = ChangeState
triggerall = !alive
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

[State 5110, 12]
type = VarSet
trigger1 = SysVar(0)
trigger1 = Time = 0
sysvar(0) = 0

[State 5110, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 5110, 14]
type = ForceFeedback
trigger1 = alive
trigger1 = Time = 0
time = 8
ampl = 240
waveform = sine

[State 5110, 15]
type = ForceFeedback
trigger1 = !alive
trigger1 = Time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine

[State 0, otg limiter add]
type = varadd
trigger1 = time = 0
var(43) = 1
ignorehitpause = 1
persistent = 0

[State 0, tsukiko otg limiter fix]
type = varadd
trigger1 = p2name = "Tsukiko" && p2stateno = 3120
var(43) = -100
ignorehitpause = 1
persistent = 0

[State 0, otg limiter]
type = NotHitBy
trigger1 = time >= (22 - (2*var(43)))
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 1

;[State 0, post super restrictor]
;type = NotHitBy
;trigger1 = enemy,prevstateno = [3000,3999]
;trigger2 = enemy,prevstateno = [12000,12999]  
;value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
;time = 1

[State 5100, tech]
type = selfstate
triggerall = time < 12;tech
triggerall = canrecover
trigger1 = command="a" || command="b" || command="c" || command="x" || command="y" || command="z"
trigger2 = command="holdA" || command="holdB" || command="holdC" 
value = 8065

[State 0, ChangeState]
type = selfstate
trigger1 = time = 60
trigger2 = command="a" || command="b" || command="c" || command="x" || command="y" || command="z"
trigger2 = time >= 30 && canrecover
value = 5120
ctrl = 1
;anim =
;ignorehitpause = 
;persistent = 

;---------------------------------------------------------------------------
; HIT_LIEDOWN NEW (TSUKI SPC)
[Statedef 5108]
type    = L
movetype= H
physics = N

; [state 5000, ivan override]
; type=changestate
; triggerall=ishelper
; trigger1=time=0
; value=stateno+40000
; 
[State 5109, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 5110, 1] ;For hit up/up-diag type (from state 5081)
type = ChangeAnim
persistent = 0
trigger1 = SelfAnimExist(5110 + (anim % 10))
trigger1 = anim = [5081,5089]
value = 5110 + (anim % 10)

[State 5110, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim != [5161,5169]
trigger2 = !SelfAnimExist(5170 + (anim % 10))
value = 5170

[State 5110, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim = [5161,5169]
trigger1 = SelfAnimExist(5170 + (anim % 10))
value = 5170 + (anim % 10)

[State 5110, 4]
type = HitFallDamage
trigger1 = Time = 0

[State 5110, 5]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5110, Var] ;Get fall velocity
type = VarSet
trigger1 = Time = 0
trigger1 = GetHitVar(fall.yvel) != 0
sysvar(1) = floor(vel y)

[State 5110, 6]
type = PlaySnd
trigger1 = Time = 0
trigger1 = !SysVar(0)
value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)

[State 0, Explod]
type = explod
trigger1 = time = 1 && canrecover = 0
anim = F60
ID = 60
pos = 0,0
scale = 1.5,1.5;ground

[State 0, Explod]
type = explod
trigger1 = time = 1 && canrecover = 1
anim = F61
ID = 61
pos = 0,0
scale = 1.5,1.5;ground

[State 5110, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 5110, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 5110, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 5110, 11] ;If just died
type = ChangeState
triggerall = !alive
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

[State 5110, 12]
type = VarSet
trigger1 = SysVar(0)
trigger1 = Time = 0
sysvar(0) = 0

[State 5110, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 5110, 14]
type = ForceFeedback
trigger1 = alive
trigger1 = Time = 0
time = 8
ampl = 240
waveform = sine

[State 5110, 15]
type = ForceFeedback
trigger1 = !alive
trigger1 = Time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine

[State 0, ChangeState]
type = ChangeState
trigger1 = time = 80
value = 5120
ctrl = 0

;---------------------------------------------------------------------------
; HIT_LIEDOWN
[Statedef 5110]
type    = L
movetype= H
physics = N

; [state 5000, ivan override]
; type=changestate
; triggerall=ishelper
; trigger1=time=0
; value=stateno+40000
; 
[State 5110, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 5110, 1] ;For hit up/up-diag type (from state 5081)
type = ChangeAnim
persistent = 0
trigger1 = SelfAnimExist(5110 + (anim % 10))
trigger1 = anim = [5081,5089]
value = 5110 + (anim % 10)

[State 5110, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim != [5161,5169]
trigger2 = !SelfAnimExist(5170 + (anim % 10))
value = 5170

[State 5110, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim = [5161,5169]
trigger1 = SelfAnimExist(5170 + (anim % 10))
value = 5170 + (anim % 10)

[State 5110, 4]
type = HitFallDamage
trigger1 = Time = 0

[State 5110, 5]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5110, Var] ;Get fall velocity
type = VarSet
trigger1 = Time = 0
trigger1 = GetHitVar(fall.yvel) != 0
sysvar(1) = floor(vel y)

[State 5110, 6]
type = PlaySnd
trigger1 = Time = 0
trigger1 = !SysVar(0)
value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)

[State 0, Explod]
type = explod
trigger1 = time = 1 && canrecover = 0
anim = F60
ID = 60
pos = 0,0
scale = 1.5,1.5;ground

[State 0, Explod]
type = explod
trigger1 = time = 1 && canrecover = 1
anim = F61
ID = 61
pos = 0,0
scale = 1.5,1.5;ground

[State 5110, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 5110, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 5110, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 5110, 11] ;If just died
type = ChangeState
triggerall = !alive
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

[State 5110, 12]
type = VarSet
trigger1 = SysVar(0)
trigger1 = Time = 0
sysvar(0) = 0

[State 5110, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 5110, 14]
type = ForceFeedback
trigger1 = alive
trigger1 = Time = 0
time = 8
ampl = 240
waveform = sine

[State 5110, 15]
type = ForceFeedback
trigger1 = !alive
trigger1 = Time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine

[State 5100, tech]
type = ChangeState
triggerall = time<10;tech
triggerall = canrecover
trigger1 = command="a" || command="b" || command="c" || command="x" || command="y" || command="z"
trigger2 = command="holdA" || command="holdB" || command="holdC" 
value = 8065

;---------------------------------------------------------------------------
; HIT_GETUP
;[Statedef 5120]
;type    = L
;movetype= H
;physics = N
;facep2 = 1
;
;[State 5120, 1a] ;Get up anim (normal)
;type = ChangeAnim
;triggerall = time = 0
;trigger1 = anim != [5111,5119]
;trigger2 = !SelfAnimExist(5120 + (anim % 10))
;value = 5120
;
;[State 5120, 1b] ;Get up anim (for hit up/diag-up)
;type = ChangeAnim
;triggerall = time = 0
;trigger1 = anim = [5111,5119]
;trigger1 = SelfAnimExist(5120 + (anim % 10))
;value = 5120 + (anim % 10)
;
;[State 5120, 2]
;type = VelSet
;trigger1 = 1
;x = 0
;
;[State 0, PosSet]
;type = PosSet
;trigger1 = 1
;y = 0
;
;[State 0, StateTypeSet]
;type = StateTypeSet
;trigger1 = 1
;statetype = S       ;S,A,C,L
;movetype = H       ;I,A,H
;physics = S         ;A,C,S,N
;ignorehitpause = 
;persistent = 
;
;[State 0, wakeup]
;type = CtrlSet
;triggerall = p2name != "Tsukiko" && p2stateno != [1131,1191]
;triggerall = p2name != "Tsukiko" && p2stateno != [3131,3191]
;trigger1  = command = "236A" 
;trigger2  = command = "236B" 
;trigger3  = command = "236C" 
;trigger4  = command = "214A" 
;trigger5  = command = "214B" 
;trigger6  = command = "214C" 
;trigger7  = command = "623A" 
;trigger8  = command = "623B" 
;trigger9  = command = "623C"
;trigger10 = command = "421A"
;trigger11 = command = "421B"
;trigger12 = command = "421C"
;trigger13 = command = "22A" 
;trigger14 = command = "22B" 
;trigger15 = command = "22C" 
;trigger16 = command = "236EX"
;trigger17 = command = "214EX"
;trigger18 = command = "623EX"
;trigger19 = command = "421EX"
;trigger20 = command = "22EX"
;trigger21 = command = "BB"
;value = 1
;ignorehitpause = 1
;persistent = 
;
;[State 0, wakeup invincibility]
;type = NotHitBy
;triggerall = p2name != "Tsukiko" && p2stateno != [1131,1191]
;triggerall = p2name != "Tsukiko" && p2stateno != [3131,3191]
;trigger1  = command = "236A" 
;trigger2  = command = "236B" 
;trigger3  = command = "236C" 
;trigger4  = command = "214A" 
;trigger5  = command = "214B" 
;trigger6  = command = "214C" 
;trigger7  = command = "623A" 
;trigger8  = command = "623B" 
;trigger9  = command = "623C"
;trigger10 = command = "421A"
;trigger11 = command = "421B"
;trigger12 = command = "421C"
;trigger13 = command = "22A" 
;trigger14 = command = "22B" 
;trigger15 = command = "22C" 
;trigger16 = command = "236EX"
;trigger17 = command = "214EX"
;trigger18 = command = "623EX"
;trigger19 = command = "421EX"
;trigger20 = command = "22EX"
;trigger21 = command = "BB"
;trigger22 = time = 20
;value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
;time = 20
;;
;[State 5120, 5] ;Can't be thrown right after getting up
;type = NotHitBy
;trigger1 = 1;AnimTime = 0
;value = , NT,ST,HT
;time = 1
;
;[State 5120, 6] ;Can't be hit right after getting up (short time)
;type = NotHitBy
;trigger1 = 1;AnimTime = 0
;value2 = SCA
;time = 2
;
;[State 0, HitBy]
;type = notHitBy
;trigger1 =  1
;value = SCA,NA,SA,HA,NP,SP,HP;,NT,ST,HT
;time = 1
;ignorehitpause =  1
;persistent = 1
;
;
;[State 5120, 7]
;type = ChangeState
;trigger1 = time =1
;value = 5121
;ctrl = 0
;
;---------------------------------------------------------------------------
; HIT_GETUP
;[Statedef 5121]
;type    = S
;movetype= H
;physics = S
;facep2 = 1
;
;[State 5120, 1a] ;Get up anim (normal)
;type = ChangeAnim
;triggerall = time = 0
;trigger1 = anim != [5111,5119]
;trigger2 = !SelfAnimExist(5120 + (anim % 10))
;value = 5120
;
;[State 5120, 1b] ;Get up anim (for hit up/diag-up)
;type = ChangeAnim
;triggerall = time = 0
;trigger1 = anim = [5111,5119]
;trigger1 = SelfAnimExist(5120 + (anim % 10))
;value = 5120 + (anim % 10)
;
;[State 5120, 2]
;type = VelSet
;trigger1 = 1
;x = 0
;
;[State 0, PosSet]
;type = PosSet
;trigger1 = 1
;y = 0
;
;[State 0, StateTypeSet]
;type = StateTypeSet
;trigger1 = 1
;statetype = S       ;S,A,C,L
;movetype = H       ;I,A,H
;physics = S         ;A,C,S,N
;ignorehitpause = 
;persistent = 
;
;[State 0, wakeup]
;type = CtrlSet
;triggerall = p2name != "Tsukiko" && p2stateno != [1131,1191]
;triggerall = p2name != "Tsukiko" && p2stateno != [3131,3191]
;trigger1  = command = "236A" 
;trigger2  = command = "236B" 
;trigger3  = command = "236C" 
;trigger4  = command = "214A" 
;trigger5  = command = "214B" 
;trigger6  = command = "214C" 
;trigger7  = command = "623A" 
;trigger8  = command = "623B" 
;trigger9  = command = "623C"
;trigger10 = command = "421A"
;trigger11 = command = "421B"
;trigger12 = command = "421C"
;trigger13 = command = "22A" 
;trigger14 = command = "22B" 
;trigger15 = command = "22C" 
;trigger16 = command = "236EX"
;trigger17 = command = "214EX"
;trigger18 = command = "623EX"
;trigger19 = command = "421EX"
;trigger20 = command = "22EX"
;trigger21 = command = "BB"
;value = 1
;ignorehitpause = 1
;persistent = 
;
;[State 0, wakeup invincibility]
;type = NotHitBy
;triggerall = p2name != "Tsukiko" && p2stateno != [1131,1191]
;triggerall = p2name != "Tsukiko" && p2stateno != [3131,3191]
;trigger1  = command = "236A" 
;trigger2  = command = "236B" 
;trigger3  = command = "236C" 
;trigger4  = command = "214A" 
;trigger5  = command = "214B" 
;trigger6  = command = "214C" 
;trigger7  = command = "623A" 
;trigger8  = command = "623B" 
;trigger9  = command = "623C"
;trigger10 = command = "421A"
;trigger11 = command = "421B"
;trigger12 = command = "421C"
;trigger13 = command = "22A" 
;trigger14 = command = "22B" 
;trigger15 = command = "22C" 
;trigger16 = command = "236EX"
;trigger17 = command = "214EX"
;trigger18 = command = "623EX"
;trigger19 = command = "421EX"
;trigger20 = command = "22EX"
;trigger21 = command = "BB"
;trigger22 = time = 20
;value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
;time = 20
;;
;[State 5120, 5] ;Can't be thrown right after getting up
;type = NotHitBy
;trigger1 = 1;AnimTime = 0
;value = , NT,ST,HT
;time = 1
;
;[State 5120, 6] ;Can't be hit right after getting up (short time)
;type = NotHitBy
;trigger1 = 1;AnimTime = 0
;value2 = SCA
;time = 2
;
;[State 0, HitBy]
;type = notHitBy
;trigger1 =  1
;value = SCA,NA,SA,HA,NP,SP,HP;,NT,ST,HT
;time = 1
;ignorehitpause =  1
;persistent = 1
;
;
;[State 5120, 7]
;type = ChangeState
;trigger1 = AnimTime = 0
;value = 0
;ctrl = 1

;---------------------------------------------------------------------------
; Downed get-hit (getting up)
[Statedef 5120]
type    = L
movetype= I
physics = N

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
var(43) = 0


[State 5120, 1a] ;Get up anim (normal)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim != [5111,5119]
trigger2 = !SelfAnimExist(5120 + (anim % 10))
value = 5120

[State 5120, 1b] ;Get up anim (for hit up/diag-up)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim = [5111,5119]
trigger1 = SelfAnimExist(5120 + (anim % 10))
value = 5120 + (anim % 10)

[State 5120, 2]
type = VelSet
trigger1 = Time = 0
x = 0

;[State 5120, 3]
;type = NotHitBy
;trigger1 = 1
;value = SCA
;time = 1

[State 5120, 4]
type = HitFallSet
trigger1 = AnimTime = 0
value = 1

;[State 5120, 5] ;Can't be thrown right after getting up
;type = NotHitBy
;trigger1 = AnimTime = 0
;value = , NT,ST,HT
;time = 12
;
;[State 5120, 6] ;Can't be hit right after getting up (short time)
;type = NotHitBy
;trigger1 = AnimTime = 0
;value2 = SCA
;time = 3

[state 5120, 0]
type = changestate
trigger1 = inguarddist
trigger1 = command = "holdback"
value = 120

[State 5120, 7]
type = ChangeState
trigger1 = time =1
value = 5121
ctrl = 0

;---------------------------------------------------------------------------
; Downed get-hit (getting up)
[Statedef 5121]
type    = S
movetype= I
physics = S

[State 5120, 1a] ;Get up anim (normal)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim != [5111,5119]
trigger2 = !SelfAnimExist(5120 + (anim % 10))
value = 5120

[State 5120, 1b] ;Get up anim (for hit up/diag-up)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim = [5111,5119]
trigger1 = SelfAnimExist(5120 + (anim % 10))
value = 5120 + (anim % 10)

[State 5120, 2]
type = VelSet
trigger1 = Time = 0
x = 0

[State 5120, 4]
type = HitFallSet
trigger1 = AnimTime = 0
value = 1

[State 0, wakeup]
type = CtrlSet
triggerall = p2name != "Tsukiko" && p2stateno != [1131,1191]
triggerall = p2name != "Tsukiko" && p2stateno != [3131,3191]
trigger1  = command = "236A" 
trigger2  = command = "236B" 
trigger3  = command = "236C" 
trigger4  = command = "214A" 
trigger5  = command = "214B" 
trigger6  = command = "214C" 
trigger7  = command = "623A" 
trigger8  = command = "623B" 
trigger9  = command = "623C"
trigger10 = command = "421A"
trigger11 = command = "421B"
trigger12 = command = "421C"
trigger13 = command = "22A" 
trigger14 = command = "22B" 
trigger15 = command = "22C" 
trigger16 = command = "236EX"
trigger17 = command = "214EX"
trigger18 = command = "623EX"
trigger19 = command = "421EX"
trigger20 = command = "22EX"
trigger21 = command = "BB"
value = 1
ignorehitpause = 1
persistent = 

[State 0, wakeup invincibility]
type = NotHitBy
triggerall = p2name != "Tsukiko" && p2stateno != [1131,1191]
triggerall = p2name != "Tsukiko" && p2stateno != [3131,3191]
trigger1  = command = "236A" 
trigger2  = command = "236B" 
trigger3  = command = "236C" 
trigger4  = command = "214A" 
trigger5  = command = "214B" 
trigger6  = command = "214C" 
trigger7  = command = "623A" 
trigger8  = command = "623B" 
trigger9  = command = "623C"
trigger10 = command = "421A"
trigger11 = command = "421B"
trigger12 = command = "421C"
trigger13 = command = "22A" 
trigger14 = command = "22B" 
trigger15 = command = "22C" 
trigger16 = command = "236EX"
trigger17 = command = "214EX"
trigger18 = command = "623EX"
trigger19 = command = "421EX"
trigger20 = command = "22EX"
trigger21 = command = "BB"
trigger22 = time = 20
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 20
;
[State 5120, 5] ;Can't be thrown right after getting up
type = NotHitBy
trigger1 = 1;AnimTime = 0
value = , NT,ST,HT
time = 1
;
;[State 5120, 6] ;Can't be hit right after getting up (short time)
;type = NotHitBy
;trigger1 = 1;AnimTime = 0
;value2 = SCA
;time = 2
;
;[State 0, HitBy]
;type = notHitBy
;trigger1 =  1
;value = SCA,NA,SA,HA,NP,SP,HP;,NT,ST,HT
;time = 1
;ignorehitpause =  1
;persistent = 1

[state 5120, 0]
type = changestate
trigger1 = inguarddist
trigger1 = command = "holdback"
value = 120

[State 5120, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1


;---------------------------------------------------------------------------
; HIT_LIEDEAD
[Statedef 5150]
type    = L
movetype= H
physics = N
sprpriority = -3

; [state 5000, ivan override]
; type=changestate
; triggerall=ishelper
; trigger1=time=0
; value=stateno+40000

[State 5150, 1] ;Normal anim
type = ChangeAnim
triggerall = Time = 0
triggerall = SelfAnimExist(5140)
trigger1 = (anim != [5111,5119]) && (anim != [5171,5179])
trigger2 = !SelfAnimExist(5140 + (anim % 10))
value = 5140

[State 5150, 3] ;Hit up type anim
type = ChangeAnim
trigger1 = Time = 0
trigger1 = (anim = [5111,5119]) || (anim = [5171,5179])
trigger1 = SelfAnimExist(5140 + (anim % 10))
value = 5140 + (anim % 10)

[State 5150, 4] ;Match over anim
type = ChangeAnim
persistent = 0
;trigger1 = Time = 0
trigger1 = MatchOver = 1
trigger1 = Anim = [5140,5149]
trigger1 = SelfAnimExist(anim+10)
value = anim+10

[State 5150, 5] ;Switch to 5110 if liedead anim does not exist
type = ChangeAnim
trigger1 = Time = 0
trigger1 = Anim != [5140,5159]
trigger1 = Anim != [5110,5119]
value = 5110

[State 5150, 6] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 5150, 7] ;Friction
type = VelSet
trigger1 = Vel x < .05
persistent = 0
x = 0

; [State 5150, 8]
; type = NotHitBy
; trigger1 = 1
; value = SCA
; time = 1

;---------------------------------------------------------------------------
; HIT_FALLRECOVER (still falling)
[Statedef 5200]
type    = A
movetype= H
physics = N

[state -2, combo bonus damage application (normal)]
type = null;bonus
;trigger1 = enemy,var(27)!=1
trigger1 = time=0
value = ifelse(var(25)>0,-1*(var(25)),(var(25)))
kill = 0
absolute = 1
ignorehitpause = 1
persistent = 0

; [state -2, combo bonus damage application (vs midnight)]
; type = LifeAdd
; trigger1 = enemy,var(27)=1
; trigger1 = time=0
; value = ifelse(var(25)>0,-1*(var(25)*fvar(6)),(var(25)*fvar(6)))
; kill = 0
; absolute = 1
; ignorehitpause = 1
; persistent = 0

[state -2, combo bonus damage reset]
type = VarSet
trigger1 = time=1
v = 25
value = 0
ignorehitpause = 1

; [state 5000, ivan override]
; type=changestate
; triggerall=ishelper
; trigger1=time=0
; value=stateno+40000

[State Recover Sound]
type = PlaySnd
trigger1 = !Time
value = F30, 3
abspan = 0
volume = 999
ignorehitpause = 1

[State Recover Notify]
trigger1 = !Time
type = Explod
ownpal = 1
anim = F814 + ifelse(TeamSide = 2, 20, 0)
scale = .5,.5
ontop = 1
postype = left
pos = ifelse(TeamSide = 2, 310, 10), 83
bindtime = -1
ignorehitpause = 1

[State 5200, 1] ;Change anim if done with transition
type = ChangeAnim
trigger1 = Anim = 5035
trigger1 = AnimTime = 0
value = 5050

[State 5200, 2]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 5200, 3]
type = SelfState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 10
value = 5201

;---------------------------------------------------------------------------
; HIT_FALLRECOVER (on the ground)
[Statedef 5201]
type    = A
movetype= H
physics = A
anim = 5200

[state -2, combo bonus damage application (normal)]
type = null;bonus
;trigger1 = enemy,var(27)!=1
trigger1 = time=0
value = ifelse(var(25)>0,-1*(var(25)),(var(25)))
kill = 0
absolute = 1
ignorehitpause = 1
persistent = 0

; [state -2, combo bonus damage application (vs midnight)]
; type = LifeAdd
; trigger1 = enemy,var(27)=1
; trigger1 = time=0
; value = ifelse(var(25)>0,-1*(var(25)*fvar(6)),(var(25)*fvar(6)))
; kill = 0
; absolute = 1
; ignorehitpause = 1
; persistent = 0

[state -2, combo bonus damage reset]
type = VarSet
trigger1 = time=1
v = 25
value = 0
ignorehitpause = 1

; [state 5000, ivan override]
; type=changestate
; triggerall=ishelper
; trigger1=time=0
; value=stateno+40000

[State 5201, 1] ;Turn if not facing opponent
type = Turn
trigger1 = Time = 0
trigger1 = p2dist X < -5

[State 5201, 2]
type = VelSet
trigger1 = Time = 0
x = -.15
y = -3.5

[State 5201, 3]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5201, 4]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 5201, 5] ;Blink white
type = PalFX
trigger1 = Time = 0
time = 3
add = 128,128,128 ;256,256,256

[State 5201, 6]
type = GameMakeAnim
trigger1 = Time = 1
value = 60
pos = 0, 0
under = 1

;---------------------------------------------------------------------------
; HITAIRFALLRECOVER
[Statedef 5210]
type    = A
movetype= I
physics = N
anim = 5210
ctrl = 0

[state -2, combo bonus damage application (normal)]
type = null;bonus
;trigger1 = enemy,var(27)!=1
trigger1 = time=0
value = ifelse(var(25)>0,-1*(var(25)),(var(25)))
kill = 0
absolute = 1
ignorehitpause = 1
persistent = 0

; [state -2, combo bonus damage application (vs midnight)]
; type = LifeAdd
; trigger1 = enemy,var(27)=1
; trigger1 = time=0
; value = ifelse(var(25)>0,-1*(var(25)*fvar(6)),(var(25)*fvar(6)))
; kill = 0
; absolute = 1
; ignorehitpause = 1
; persistent = 0

[state -2, combo bonus damage reset]
type = VarSet
trigger1 = time=1
v = 25
value = 0
ignorehitpause = 1

; [state 5000, ivan override]
; type=changestate
; triggerall=ishelper
; trigger1=time=0
; value=stateno+40000

[State Recover Sound]
type = PlaySnd
trigger1 = !Time
value = F30, 3
abspan = 0
volume = 999
ignorehitpause = 1

[State Recover Notify]
trigger1 = !Time
type = Explod
ownpal = 1
anim = F814 + ifelse(TeamSide = 2, 20, 0)
scale = .5,.5
ontop = 1
postype = left
pos = ifelse(TeamSide = 2, 310, 10), 83
bindtime = -1
ignorehitpause = 1

[State 5210, 1] ;Blink white
type = PalFX
trigger1 = Time = 0
time = 3
add = 128,128,128 ;256,256,256

[State 5210, 1]
type = PosFreeze
trigger1 = Time = 0
value = 4

[State 5210, 2] ;Turn if not facing opponent
type = Turn
trigger1 = Time = 0
trigger1 = p2dist X < -20

[State 5210, 1] 
type = VelMul
trigger1 = Time = 4
x = .8
y = .8

[State 5210, 1]
type = VelAdd
trigger1 = Time = 4
y = -4.5

[State 5210, 1] 
type = VelMul
trigger1 = Time = 4
trigger1 = Vel Y > 0
y = .5

[State 5210, 1]
type = VelAdd
trigger1 = Time = 4
trigger1 = Vel Y > -3
y = -2

[State 5210, 1]
type = VelAdd
trigger1 = Time = 4
trigger1 = Vel Y > -2
y = -1

[State 5210, 2] ;Go up
type = VelAdd
trigger1 = Time = 4
trigger1 = Command = "holdup"
y = -2

[State 5210, 2] ;Go down
type = VelAdd
trigger1 = Time = 4
trigger1 = Command = "holddown"
y = 1.5

[State 5210, 2] ;Go fwd
type = VelMul
trigger1 = Time = 4
trigger1 = Command = "holdfwd"
x = 1

[State 5210, 2] ;Go back
type = VelAdd
trigger1 = Time = 4
trigger1 = Command = "holdback"
x = -1

[State 5210, 3]
type = NotHitBy
trigger1 = Time = 0
value = SCA
time = 15

[State 5210, 4]
type = CtrlSet
trigger1 = Time = 20
value = 1

[State 5210, 5]
type = VelAdd;Gravity
trigger1 = Time >= 4
y = .35

[State 5210, 5] ;Land on ground
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 52 ;JUMP_LAND
ctrl = 1

;---------------------------------------------------------------------------
; Continue?
[Statedef 5500]
type = S
ctrl = 0
anim = 5300
velset = 0,0

[State 5500, 1] ;Use continue animation if available
type = ChangeAnim
trigger1 = time = 0
trigger1 = SelfAnimExist(5500)
value = 5500

;---------------------------------------------------------------------------
; Initialize (at the start of the round)
[Statedef 5900]
type = S

; This sends your character to his teammate intro state if he's the partner (means not the leader of the team).
[State 5900, ChangeState]
type = ChangeState
triggerall = numenemy
triggerall = roundstate < 2
triggerall = time = 0
trigger1 = numpartner
trigger1 = ID>partner,ID
value = 358000
ctrl = 0


; This will send oyur character to his intro state as usual (also works as a turns mode intro).
[State 5900, Changestate]
type = ChangeState
triggerall = roundstate < 2
trigger1 = roundsexisted = 0
trigger1 = time = 0
value = 190

; Be sure that nothing else on statedef -2 or statedef -3 controls what's going to be your intro, otherwise the
; teammate intro won't work. For example, characters by Warusaki3 doesn't overwrite the statedef 5900 yet they have
; a turns mode intro, that's because they have a changestate in their statedef -3 so if you wan't to add them the
; tagteam coding then you will have to move their changestates to statedef 5900 and add a 1 tick delay on their time
; trigger (so it will be "time = 1" instead) and do the same with the normal-turns mode intro.
; There are other ways of course but just make sure the teammate intro is the first piece of code to be read,
; otherwise it won't work.

[State 5900, 1] ;Clear all int variables
type = VarRangeSet
trigger1 = roundsexisted = 0
value = 0

[State 5900, 2] ;Clear all float variables
type = VarRangeSet
trigger1 = roundsexisted = 0
fvalue = 0

[State 5900, 3] ;Intro for round 1
type = ChangeState
trigger1 = !RoundsExisted;roundno = 1
value = 190

; ;---------------------------------------------------------------------------
; ; Shield Ground
; [Statedef 6000]
; type = S
; physics = S
; movetype = I
; ctrl = 0
; anim = 6000
; poweradd=-50
; 
; [state 200, physics]
; type=veladd
; trigger1=name="Lil' Slugger"
; trigger1=pos y=0
; trigger1=vel x > 0
; trigger1=time>0
; x=-0.5
; 
; [state 200, physics]
; type=veladd
; trigger1=name="Lil' Slugger"
; trigger1=pos y=0
; trigger1=vel x < 0
; trigger1=time>0
; x=0.5
; 
; [State 0, PlaySnd]
; type = PlaySnd
; trigger1 = time=2
; value = 30,3
; 
; [state 6000, (shield spark]
; type=explod
; trigger1=time=0
; sprpriority=7
; anim=11005
; ID=11005
; scale=0.5,0.5
; postype=p1
; pos=30,-45
; supermove=1
; supermovetime=9999
; pausemovetime=9999
; 
; [State 6000, PalFXWiz]
; type = PalFX
; trigger1=time=0
; time = 8
; add = 100,100,180
; mul = 256,256,256
; sinadd = 50,50,50,30
; invertall = 0
; color = 256
; 
; [State 6000, ReversalDef Normal SC]
; type = ReversalDef
; trigger1 = Time > 2
; trigger1 = p2statetype!=A
; attr = S, SA
; reversal.attr = SC, NA, SA, HA
; sparkno=-1
; pausetime = 5,5
; p1stateno = 6005
; p2stateno = 6010
; 
; [State 6000, ReversalDef Perfect SC]
; type = ReversalDef
; trigger1 = time=2
; trigger1 = p2statetype!=A
; attr = S, SA
; reversal.attr = SC, NA, SA, HA
; sparkno=-1
; pausetime = 5,5
; p1stateno = 6015
; p2stateno = 6020
; 
; [State 6000, ReversalDef Normal A]
; type = ReversalDef
; trigger1 = Time > 2
; trigger1 = p2statetype=A
; attr = S, SA
; reversal.attr = A, NA, SA, HA
; sparkno=-1
; pausetime = 5,5
; p1stateno = 6006
; p2stateno = 6010
; 
; [State 6000, ReversalDef Perfect A]
; type = ReversalDef
; trigger1 = time=2
; trigger1 = p2statetype=A
; attr = S, SA
; reversal.attr = A, NA, SA, HA
; sparkno=-1
; pausetime = 5,5
; p1stateno = 6016
; p2stateno = 6020
; 
; [State Reversal]
; type=reversaldef
; trigger1=time>2
; trigger1=!movehit
; reversal.attr=SCA, AP
; p2stateno=6095
; 
; ;[State 9000: HitOverride (old projectile reflection reference)]
; ;type = HitOverride
; ;trigger1 = 1
; ;slot = 1
; ;attr = SCA, AP
; ;stateno = 6080
; ;time = 1
;  
; ;[State 9000: ChangeState]
; ;type = ChangeState
; ;trigger1 = (Command != "holdb") || (Command != "holdc")
; ;value = 0
; ;ctrl = 1
; 
; [State 330, 1]
; type = ChangeState
; trigger1=animtime=0
; value = 0
; ctrl = 1
; 
; ;---------------------------------------------------------------------------
; ; Shielding Continue SC
; 
; [Statedef 6005]
; type = S
; physics=S
; movetype = A
; anim = 6005
; poweradd = 0
; ctrl=1
; velset=2,0
; 
; [State 200, vox]
; type = PlaySnd
; trigger1 = Time = 0
; value = 300,1
; volume=200
; 
; [State 0, PlaySnd]
; type = PlaySnd
; trigger1 = time=0
; value = 30,1
; volume = 100
; channel = -1
; freqmul = 1.0
; loop = 0
; pan = 0
; 
; [State 210, 2]
; type = HitDef
; trigger1 = time=0
; priority=3,hit
; attr = S, NA
; animtype  = High
; damage    = 0
; guardflag = MA
; pausetime = 0,0
; sparkno = -1
; sparkxy = -30,0
; hitsound   = -1,-1
; guardsound = -1,-1
; ground.type = High
; ground.slidetime = 12
; ground.hittime  = 30
; ground.velocity = -1,0
; air.velocity = -1,0
; air.hittime=35
; hitonce=1
; numhits=0
; 
; [State 331, 1]
; type = ChangeState
; trigger1 = AnimTime = 0
; value = 0
; ctrl = 1
; 
; ;---------------------------------------------------------------------------
; ; Shielding Continue A
; 
; [Statedef 6006]
; type = S
; movetype = A
; anim = 6005
; poweradd = 0
; ctrl=1
; velset=2,0
; 
; [State 200, vox]
; type = PlaySnd
; trigger1 = Time = 0
; value = 300,1
; volume=200
; 
; [State 0, PlaySnd]
; type = PlaySnd
; trigger1 = time=0
; value = 30,1
; volume = 100
; channel = -1
; freqmul = 1.0
; loop = 0
; pan = 0
; 
; [State 210, 2]
; type = HitDef
; trigger1 = time=0
; priority=3,hit
; attr = S, NA
; animtype  = High
; damage    = 0
; guardflag = MA
; pausetime = 0,13
; sparkno = -1
; sparkxy = -30,0
; hitsound   = -1,-1
; guardsound = -1,-1
; ground.type = High
; ground.slidetime = 12
; ground.hittime  = 30
; ground.velocity = -1,-3
; air.velocity = -1,-3
; air.hittime=35
; air.type=trip
; hitonce=1
; fall=1
; fall.recover=0
; numhits=0
; 
; [State 331, 1]
; type = ChangeState
; trigger1 = AnimTime = 0
; value = 0
; ctrl = 1
; 
; ;---------------------------------------------------------------------------
; ; Shield Reflect
; [Statedef 6010]
; type = S
; ctrl = 0
; anim = 5050
; velset = 0,0
; movetype = I
; physics = S
; sprpriority = 2
; 
; [State 0, EnvShake]
; type = EnvShake
; trigger1 = time=0
; time = 10
; freq = 60
; ampl = -4
; phase = 90
; 
; [State 0, EnvColor]
; type = EnvColor
; trigger1 = time=0
; value = 255,255,255
; time = 2
; under = 1
; 
; [State 6010, PalFXWiz]
; type = PalFX
; trigger1 = time=0
; time = 30
; add = 8,8,8
; mul = 255,255,255
; sinadd = 128,128,128,3
; invertall = 0
; color = 128
; 
; [State 195, 2]
; type = ChangeState
; trigger1 = time=0
; value = 0
; ctrl = 1
; 
; ;---------------------------------------------------------------------------
; ; Shielding Continue Perfect
; 
; [Statedef 6015]
; type = S
; movetype = A
; anim = 6005
; poweradd = 1000
; ctrl=1
; velset=2,0
; 
; [State 200, vox]
; type = PlaySnd
; trigger1 = Time = 0
; value = 300,2
; volume=200
; 
; [State 0, PlaySnd]
; type = PlaySnd
; trigger1 = time=0
; value = 30,2
; volume = 100
; channel = -1
; freqmul = 1.0
; loop = 0
; pan = 0
; 
; [State 210, 2]
; type = HitDef
; trigger1 = time=0
; priority=3,hit
; attr = S, NA
; animtype  = High
; damage    = 0
; guardflag = MA
; pausetime = 0,10
; sparkno = -1
; sparkxy = 0,0
; hitsound   = -1,-1
; guardsound = -1,-1
; ground.type = high
; ground.slidetime = 12
; ground.hittime  = 40
; ground.velocity = -1,0
; air.velocity = -1,0
; air.hittime=35
; hitonce=1
; numhits=0
; 
; [State 331, 1]
; type = ChangeState
; trigger1 = AnimTime = 0
; value = 0
; ctrl = 1
; 
; ;---------------------------------------------------------------------------
; ; Shielding Continue Perfect
; 
; [Statedef 6016]
; type = S
; movetype = A
; anim = 6005
; poweradd = 1000
; ctrl=1
; velset=2,0
; 
; [State 200, vox]
; type = PlaySnd
; trigger1 = Time = 0
; value = 300,2
; volume=200
; 
; [State 0, PlaySnd]
; type = PlaySnd
; trigger1 = time=0
; value = 30,2
; volume = 100
; channel = -1
; freqmul = 1.0
; loop = 0
; pan = 0
; 
; [State 210, 2]
; type = HitDef
; trigger1 = time=0
; priority=3,hit
; attr = S, NA
; animtype  = High
; damage    = 0
; guardflag = MA
; pausetime = 0,10
; sparkno = -1
; sparkxy = 0,0
; hitsound   = -1,-1
; guardsound = -1,-1
; ground.type = high
; ground.slidetime = 12
; ground.hittime  = 40
; ground.velocity = -1,0
; air.velocity = -1,0
; air.hittime=35
; air.type=trip
; hitonce=1
; fall=1
; fall.recover=0
; numhits=0
; 
; [State 331, 1]
; type = ChangeState
; trigger1 = AnimTime = 0
; value = 0
; ctrl = 1
; 
; ;---------------------------------------------------------------------------
; ; Shield Reflect Perfect
; [Statedef 6020]
; type = S
; ctrl = 0
; anim = 5050
; velset = 0,0
; movetype = I
; physics = S
; sprpriority = 2
; 
; [State 0, EnvColor]
; type = EnvColor
; trigger1 = time=0
; trigger2 = time=2
; trigger3 = time=4
; value = 240,50,0
; time = 2
; under = 1
; 
; [State 0, EnvShake]
; type = EnvShake
; trigger1 = time=0
; time = 10
; freq = 60
; ampl = -4
; phase = 90
; 
; [State 6020, PalFXWiz]
; type = PalFX
; trigger1 = time=0
; time = 40
; add = 240,50,0
; mul = 250,224,120
; sinadd = 110,55,85,3
; invertall = 0
; color = 0
; 
; [State 195, 2]
; type = ChangeState
; trigger1 = time=0
; value = 0
; ctrl = 1
; 
;  ;---------------------------------------------------------------------------
; ; Shield Fall
; [Statedef 6025]
; type = A
; movetype = A
; physics = A
; ctrl = 1
; anim = 5200
; sprpriority = 2
; 
; [State 0, CtrlSet]
; type = CtrlSet
; trigger1 = time=20
; value = 1
; 
; ;---------------------------------------------------------------------------
; ; Shield Air
; [Statedef 6050]
; type = A
; physics = A
; movetype = I
; ctrl = 0
; anim = 6000
; poweradd=-50
; 
; [state 200, physics]
; type=veladd
; trigger1=name="Lil' Slugger"
; trigger1=pos y=0
; trigger1=vel x > 0
; trigger1=time>0
; x=-0.5
; 
; [state 200, physics]
; type=veladd
; trigger1=name="Lil' Slugger"
; trigger1=pos y=0
; trigger1=vel x < 0
; trigger1=time>0
; x=0.5
; 
; [State 0, PlaySnd]
; type = PlaySnd
; trigger1 = time=2
; value = 30,3
; 
; [state 6000, (shield spark]
; type=explod
; trigger1=time=0
; sprpriority=7
; anim=11005
; ID=11005
; scale=0.5,0.5
; postype=p1
; pos=30,-45
; supermove=1
; supermovetime=9999
; pausemovetime=9999
; 
; [State 6000, PalFXWiz]
; type = PalFX
; trigger1=time=0
; time = 8
; add = 100,100,180
; mul = 256,256,256
; sinadd = 50,50,50,30
; invertall = 0
; color = 256
; 
; [State 6000, ReversalDef Normal SC]
; type = ReversalDef
; trigger1 = Time > 2
; trigger1 = p2statetype!=A
; attr = S, SA
; reversal.attr = SC, NA, SA, HA
; sparkno=-1
; pausetime = 5,5
; p1stateno = 6055
; p2stateno = 6010
; 
; [State 6000, ReversalDef Perfect SC]
; type = ReversalDef
; trigger1 = time=2
; trigger1 = p2statetype!=A
; attr = S, SA
; reversal.attr = SC, NA, SA, HA
; sparkno=-1
; pausetime = 5,5
; p1stateno = 6065
; p2stateno = 6020
; 
; [State 6000, ReversalDef Normal A]
; type = ReversalDef
; trigger1 = Time > 2
; trigger1 = p2statetype=A
; attr = S, SA
; reversal.attr = A, NA, SA, HA
; sparkno=-1
; pausetime = 5,5
; p1stateno = 6056
; p2stateno = 6010
; 
; [State 6000, ReversalDef Perfect A]
; type = ReversalDef
; trigger1 = time=2
; trigger1 = p2statetype=A
; attr = S, SA
; reversal.attr = A, NA, SA, HA
; sparkno=-1
; pausetime = 5,5
; p1stateno = 6066
; p2stateno = 6020
; 
; [State 330, 1]
; type = ChangeState
; trigger1 = animtime=0
; value = 6025
; ctrl = 1
; 
; ;---------------------------------------------------------------------------
; ; Shielding Continue SC
; 
; [Statedef 6055]
; type = A
; physics=A
; movetype = A
; anim = 6005
; poweradd = 0
; ctrl=1
; velset=2,0
; 
; [State 200, vox]
; type = PlaySnd
; trigger1 = Time = 0
; value = 300,1
; volume=200
; 
; [State 0, PlaySnd]
; type = PlaySnd
; trigger1 = time=0
; value = 30,1
; volume = 100
; channel = -1
; freqmul = 1.0
; loop = 0
; pan = 0
; 
; [State 210, 2]
; type = HitDef
; trigger1 = time=0
; priority=3,hit
; attr = S, NA
; animtype  = High
; damage    = 0
; guardflag = MA
; pausetime = 0,0
; sparkno = -1
; sparkxy = -30,0
; hitsound   = -1,-1
; guardsound = -1,-1
; ground.type = High
; ground.slidetime = 12
; ground.hittime  = 30
; ground.velocity = -1,0
; air.velocity = -1,0
; air.hittime=35
; hitonce=1
; numhits=0
; 
; [State 331, 1]
; type = ChangeState
; triggerall=statetype!=A
; trigger1 = AnimTime = 0
; value = 6025
; ctrl = 1
; 
; ;---------------------------------------------------------------------------
; ; Shielding Continue A
; 
; [Statedef 6056]
; type = A
; movetype = A
; anim = 6005
; poweradd = 0
; ctrl=1
; velset=2,0
; 
; [State 200, vox]
; type = PlaySnd
; trigger1 = Time = 0
; value = 300,1
; volume=200
; 
; [State 0, PlaySnd]
; type = PlaySnd
; trigger1 = time=0
; value = 30,1
; volume = 100
; channel = -1
; freqmul = 1.0
; loop = 0
; pan = 0
; 
; [State 210, 2]
; type = HitDef
; trigger1 = time=0
; priority=3,hit
; attr = S, NA
; animtype  = High
; damage    = 0
; guardflag = MA
; pausetime = 0,13
; sparkno = -1
; sparkxy = -30,0
; hitsound   = -1,-1
; guardsound = -1,-1
; ground.type = High
; ground.slidetime = 12
; ground.hittime  = 30
; ground.velocity = -1,-3
; air.velocity = -1,-3
; air.hittime=35
; air.type=trip
; hitonce=1
; fall=1
; fall.recover=0
; numhits=0
; 
; [State 331, 1]
; type = ChangeState
; trigger1 = AnimTime = 0
; value = 6025
; ctrl = 1
; 
; ;---------------------------------------------------------------------------
; ; Shield Reflect
; [Statedef 6060]
; type = A
; ctrl = 0
; anim = 5050
; velset = 0,0
; movetype = I
; physics = S
; sprpriority = 2
; 
; [State 0, EnvShake]
; type = EnvShake
; trigger1 = time=0
; time = 10
; freq = 60
; ampl = -4
; phase = 90
; 
; [State 0, EnvColor]
; type = EnvColor
; trigger1 = time=0
; value = 255,255,255
; time = 2
; under = 1
; 
; [State 6010, PalFXWiz]
; type = PalFX
; trigger1 = time=0
; time = 30
; add = 8,8,8
; mul = 255,255,255
; sinadd = 128,128,128,3
; invertall = 0
; color = 128
; 
; [State 195, 2]
; type = ChangeState
; trigger1 = time=0
; value = 6025
; ctrl = 1
; 
; ;---------------------------------------------------------------------------
; ; Shielding Continue Perfect
; 
; [Statedef 6065]
; type = A
; movetype = A
; anim = 6005
; poweradd = 1000
; ctrl=1
; velset=2,0
; 
; [State 200, vox]
; type = PlaySnd
; trigger1 = Time = 0
; value = 300,2
; volume=200
; 
; [State 0, PlaySnd]
; type = PlaySnd
; trigger1 = time=0
; value = 30,2
; volume = 100
; channel = -1
; freqmul = 1.0
; loop = 0
; pan = 0
; 
; [State 210, 2]
; type = HitDef
; trigger1 = time=0
; priority=3,hit
; attr = S, NA
; animtype  = High
; damage    = 0
; guardflag = MA
; pausetime = 0,10
; sparkno = -1
; sparkxy = 0,0
; hitsound   = -1,-1
; guardsound = -1,-1
; ground.type = high
; ground.slidetime = 12
; ground.hittime  = 40
; ground.velocity = -1,0
; air.velocity = -1,0
; air.hittime=35
; hitonce=1
; numhits=0
; 
; [State 331, 1]
; type = ChangeState
; trigger1 = AnimTime = 0
; value = 6025
; ctrl = 1
; 
; ;---------------------------------------------------------------------------
; ; Shielding Continue Perfect
; 
; [Statedef 6066]
; type = A
; movetype = A
; anim = 6005
; poweradd = 1000
; ctrl=1
; velset=2,0
; 
; [State 200, vox]
; type = PlaySnd
; trigger1 = Time = 0
; value = 300,2
; volume=200
; 
; [State 0, PlaySnd]
; type = PlaySnd
; trigger1 = time=0
; value = 30,2
; volume = 100
; channel = -1
; freqmul = 1.0
; loop = 0
; pan = 0
; 
; [State 210, 2]
; type = HitDef
; trigger1 = time=0
; priority=3,hit
; attr = S, NA
; animtype  = High
; damage    = 0
; guardflag = MA
; pausetime = 0,10
; sparkno = -1
; sparkxy = 0,0
; hitsound   = -1,-1
; guardsound = -1,-1
; ground.type = high
; ground.slidetime = 12
; ground.hittime  = 40
; ground.velocity = -1,0
; air.velocity = -1,0
; air.hittime=35
; air.type=trip
; hitonce=1
; fall=1
; fall.recover=0
; numhits=0
; 
; [State 331, 1]
; type = ChangeState
; trigger1 = AnimTime = 0
; value = 6025
; ctrl = 1
; 
; ;---------------------------------------------------------------------------
; ; Shield Reflect Perfect
; [Statedef 6070]
; type = A
; ctrl = 0
; anim = 5050
; velset = 0,0
; movetype = I
; physics = S
; sprpriority = 2
; 
; [State 0, EnvColor]
; type = EnvColor
; trigger1 = time=0
; trigger2 = time=2
; trigger3 = time=4
; value = 240,50,0
; time = 2
; under = 1
; 
; [State 0, EnvShake]
; type = EnvShake
; trigger1 = time=0
; time = 10
; freq = 60
; ampl = -4
; phase = 90
; 
; [State 6020, PalFXWiz]
; type = PalFX
; trigger1 = time=0
; time = 40
; add = 240,50,0
; mul = 250,224,120
; sinadd = 110,55,85,3
; invertall = 0
; color = 0
; 
; [State 195, 2]
; type = ChangeState
; trigger1 = time=0
; value = 6025
; ctrl = 1
; 
; ;------------------------------------
; ; Shield Start SC
; [Statedef 7300]
; type    = S
; movetype= I
; physics = S
; poweradd= 100
; ctrl = 0
; ;velset = 0,0
; anim = 6000
; 
; ;[State 300, Width]
; ;type = Width
; ;trigger1 = 1
; ;value = 10,0
; 
; [State 0, HitOverride]
; type = HitOverride
; trigger1 = 1
; attr = SCA,AP
; slot = 0
; stateno = 7400
; time = 8
; forceair = 0
; ;ignorehitpause = 
; ;persistent = 
; 
; [State 300, 3]
; type = Helper
; trigger1 = time=0
; helpertype = normal
; name = "Shield"
; id = 7310
; postype = p1
; pos = 45, -65
; stateno = 7310
; keyctrl = 0
; facing = -1
; 
; [State 300, 6]
; type = ChangeState
; trigger1 = AnimTime = 0
; value = 0
; ctrl = 1
; 
; ;------------------------------------
; ; Shield Start Air
; [Statedef 7305]
; type    = A
; movetype= I
; physics = A
; poweradd= 100
; ctrl = 0
; ;velset = 0,0
; anim = 6000
; 
; ;[State 300, Width]
; ;type = Width
; ;trigger1 = 1
; ;value = 10,0
; 
; [State 300, 3]
; type = Helper
; trigger1 = time=0
; helpertype = normal
; name = "Shield"
; id = 7310
; postype = p1
; pos = 45, -65
; stateno = 7310
; keyctrl = 0
; facing = -1
; 
; [State 300, 6]
; type = ChangeState
; trigger1 = AnimTime = 0
; value = 6025
; ctrl = 1
; 
; ;---------------------------------------------------------------------------
; ;Shield
; [Statedef 7310]
; type    = A
; movetype= A
; physics = N
; ctrl = 0
; velset = 0,0
; anim=F11008
; sprpriority = 5
; 
; [State 0, PlaySnd]
; type = PlaySnd
; trigger1 = time=0
; value = 30,3
; 
; [State 310, 0]
; type = BindToRoot
; trigger1 = 1
; pos = 35, -40
; 
; ;[State 310, 1]
; ;type = ChangeAnim
; ;trigger1 = Time > 40
; ;trigger1 = Anim = 310
; ;trigger1 = AnimTime = 0
; ;value = 311
; 
; ;[State 6000, ReversalDef Projectile]
; ;type = ReversalDef
; ;trigger1 = 1
; ;attr = S, NT
; ;reversal.attr = SCA, AP
; ;sparkno=-1
; ;pausetime = 5,0
; ;p1stateno = 7310
; ;p2stateno = 7350
; ;priority=7
; ;persistent=1
; 
; [State 6000, ReversalDef Normal SC]
; type = ReversalDef
; trigger1 = Time > 2
; trigger1 = p2statetype!=A
; attr = S, NT
; reversal.attr = SC, NA, SA, HA
; sparkno=-1
; pausetime = 5,5
; ;p1stateno = 6005
; p2stateno = 6010
; 
; [State 6000, ReversalDef Perfect SC]
; type = ReversalDef
; trigger1 = time=2
; trigger1 = p2statetype!=A
; trigger1 = prevstateno!=[5000,5210]
; attr = S, NT
; reversal.attr = SC, NA, SA, HA
; sparkno=-1
; pausetime = 5,5
; ;p1stateno = 6015
; p2stateno = 6020
; 
; [State 6000, ReversalDef Normal A]
; type = ReversalDef
; trigger1 = Time > 2
; trigger1 = p2statetype=A
; attr = S, NT
; reversal.attr = A, NA, SA, HA
; sparkno=-1
; pausetime = 5,5
; ;p1stateno = 6006
; p2stateno = 6010
; 
; [State 6000, ReversalDef Perfect A]
; type = ReversalDef
; trigger1 = time=2
; trigger1 = p2statetype=A
; trigger1 = prevstateno!=[5000,5210]
; attr = S, NT
; reversal.attr = A, NA, SA, HA
; sparkno=-1
; pausetime = 5,5
; ;p1stateno = 6016
; p2stateno = 6020
; 
; [State 310, 5]
; type = DestroySelf
; ;trigger1 = Anim = 7311
; trigger1 = AnimTime = 0
; ;trigger2 = Root, StateNo != 7300
; 
; ;---------------------------------------------------------------------------
; ; Projectile Reflected 
; [Statedef 7350]
; type    = A
; movetype= A
; physics = N
; velset = -Vel X, Vel Y
; ctrl = 0
; hitdefpersist=1
; 
; [State 300, NotHitBy]
; type = NotHitBy
; trigger1 = 1
; value = SCA,AP
; time = 1
; 
; [State 300, 0]
; type = PosAdd
; trigger1 = Time = 0
; x = -20
; 
; [State 300, 1]
; type = Turn
; trigger1 = Time = 0
; 
; [State 300, 2]
; type = AfterImageTime
; trigger1 = 1
; time = 10
; 
; [State 300, 3]
; type = HitDef
; trigger1 = Time = 0
; attr = SCA, AP
; damage    = 100,10
; animtype  = Heavy
; guardflag = MA
; hitflag = MAF
; pausetime = 5,5
; sparkno = 2
; sparkxy = 0, 0
; hitsound   = 5,3
; guardsound = 6,0
; ground.type = High
; ground.slidetime = 20
; ground.hittime  = 20
; ground.velocity = -5
; airguard.velocity = -5,-2
; air.type = Low
; air.velocity = -5,-4
; air.juggle = 1
; air.fall = 1
; affectteam = B
; 
; [State projectile destruct]
; type = Explod
; trigger1 = time=0
; anim =20000 
; ID = 20000
; pos = -50,0
; postype = p1  ;p2,front,back,left,right
; scale = 0.5,0.5
; 
; [State projectile destruct]
; type = DestroySelf
; trigger1=time=0
; 
; ;[State projectile reflect]
; ;type = DestroySelf
; ;;trigger1 = MoveContact
; ;trigger1 = BackEdgeBodyDist <= -50
; ;trigger2 = FrontEdgeBodyDist <= -50
; ;trigger3 = Pos Y <= -220
; ;trigger4 = Vel Y > 0
; ;trigger4 = Pos Y >= 0
; 
; ;---------------------------------------------------------------------------
; ; Projectile Reflected 2
; [Statedef 7400]
; type    = S
; movetype= I
; physics = S
; ctrl = 0
; anim=6005
; 
; [State 300, NotHitBy]
; type = NotHitBy
; trigger1 = 1
; value = SCA,AP
; time = 1
; 
; [State 0, PlaySnd]
; type = PlaySnd
; trigger1 = time=0
; value = 30,2
; volume = 100
; channel = -1
; freqmul = 1.0
; loop = 0
; pan = 0
; 
; [State 0, EnvColor]
; type = EnvColor
; trigger1 = time=0 
; value = 255,255,255
; time = 3
; under = 1
; ;ignorehitpause = 
; ;persistent = 
; 
; [State 0, PalFXWiz]
; type = PalFX
; trigger1 = time=0
; time = 10
; add = 100,100,180
; mul = 256,256,256
; sinadd = -80,-80,-80,10
; invertall = 0
; color = 0
; 
; [State 7400, projectile destruct]
; type = Explod
; trigger1 = time=0
; anim =20000 
; ID = 20000
; pos = 30,-40
; postype = p1  ;p2,front,back,left,right
; scale = 0.5,0.5
; ownpal=0
; 
; [state 7400, changestate]
; type=changestate
; trigger1=animtime=0
; value=0
; ctrl=1
;---------------------------------------------------------------------------------------------
;Super Jump
[Statedef 7000]
type = A
physics = A
ctrl = 0
anim = 411
;velset = 0,0

[State 0, CtrlSet]
type = CtrlSet
trigger1 = time = 0
value = 1
;ignorehitpause =
;persistent =

[State 0, SJ Fwd]
type = VelSet
trigger1 = time = 0 && command = "holdfwd"
x = 1.5
y = -12

[State 0, SJ Back]
type = VelSet
trigger1 = time = 0 && command = "holdback"
x = -1.5
y = -12

[State 0, SJ Up]
type = VelSet
trigger1 = time = 0 && command != "holdfwd" && command != "holdback"
x = 0
y = -12



;[State 0, VelAdd]
;type = VelAdd
;triggerall = vel x = [-1.5,1.5]
;trigger1 = command = "holdfwd" 
;x = 0.1
;
;[State 0, VelAdd]
;type = VelAdd
;triggerall = vel x = [-1.5,1.5]
;trigger1 = command = "holdback" 
;x = -0.1

[state -3, air spark]
type=explod
trigger1=time=0
anim=11000
ID=11000
scale=0.5,0.5
postype=p1
pos=0,0
supermove=1
supermovetime=9999
pausemovetime=9999



;---------------------------------------------------------------------------------------------
;Super Jump
[Statedef 7050]
type = A
physics = A
ctrl = 1
anim = 412
velset = 0,0

[state -3, air spark]
type=explod
trigger1=time=0
trigger2=time=1
trigger3=time=2
trigger4=time=3
trigger5=time=4
anim=11000
ID=11000
scale=0.5,0.5
postype=p1
pos=0,0
supermove=1
supermovetime=9999
pausemovetime=9999

[state 7000, jump cont]
type=velset
trigger1=animelem=1
x=8
y=-13


;------------------------------------------------------------
;Recovery Neutral
[Statedef 8050]
type=A
physics=A
ctrl=0
anim=5500
velset=0,-10
poweradd=100

; [state 0, ctrl set]
; type=ctrlset
; trigger1=time=2
; value=1

[state 8050, palfx]
type=palfx
trigger1=animelem=1
trigger2=animelem=3
trigger3=animelem=5
color=256
add=100,100,100
time=3

;------------------------------------------------------------
;Recovery Back
[Statedef 8040]
type=A
physics=A
ctrl=0
anim=5500
velset=-3.5,-10
poweradd=100

; [state 0, ctrl set]
; type=ctrlset
; trigger1=time=2
; value=1

[state 8050, palfx]
type=palfx
trigger1=animelem=1
trigger2=animelem=3
trigger3=animelem=5
color=256
add=100,100,100
time=3

;------------------------------------------------------------
;Recovery Forward
[Statedef 8060]
type=A
physics=A
ctrl=0
anim=5500
velset=3.5,-10
poweradd=100

; [state 0, ctrl set]
; type=ctrlset
; trigger1=time=2
; value=1

[state 8050, palfx]
type=palfx
trigger1=animelem=1
trigger2=animelem=3
trigger3=animelem=5
color=256
add=100,100,100
time=3

;------------------------------------------------------------
;Tech
[Statedef 8065]
type=A
physics=A
ctrl=0
anim=5500
velset=0,-6
poweradd=200
p2facing=1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time=0
value = 30,3
volume = 255
channel = -1

[State 0, Explod]
type = Explod
trigger1 = time = 0
anim = F74
ID = 74
pos = 0,-10
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
pausemovetime = 999
scale = 1,1
sprpriority = 7
ontop = 1
removeongethit = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time=0
value = 6,6
volume = 255
channel = 0

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
;value2 = S,NA
time = 6

[State 0, VelSet]
type = VelSet
trigger1 = time<2
trigger1 = command="holdfwd"
x = 5
persistent=0

[State 0, VelSet]
type = VelSet
trigger1 = time<2
trigger1 = command="holdback"
x = -5
persistent=0

; [state 0, ctrl set]
; type=ctrlset
; trigger1=time=2
; value=1

[state 8050, palfx]
type=palfx
trigger1=animelem=1
trigger2=animelem=3
trigger3=animelem=5
color=256
add=100,100,100
time=3

[State 1000, Land]
type= changestate
trigger1= vel y > 0
trigger1= pos y > -vel y
value= 53

;==========================================
;Guard Break
;==========================================
[Statedef 9000]
type = S
movetype = A
physics = S
anim = 9000
ctrl = 0

[state 9000, flash]
type = PalFX
trigger1 = time=0
time = 180
add = 0,-200,-200
mul = 256,256,256
sinadd = 40,80,40,20
invertall = 0
color = 0
ignorehitpause = 1
persistent = 1

[state 9000, guard crush spark]
type=explod
trigger1=time=0
anim=F5
ID=20000
scale = 1.5,1.5;ground
postype=p1
pos=0,-30
supermove=1
supermovetime=9999
pausemovetime=9999

[State 9000, Pause]
type = Pause
trigger1 = time=0
time = 30
movetime = 1

[State 9000, EnvShake]
type = EnvShake
trigger1 = time=0
time = 30
freq = 60
ampl = -4
phase = 90
ignorehitpause = 1
persistent = 1

[State 9000, PlaySnd]
type = PlaySnd
trigger1 = time=0
value = F30,1
volume = 100

[State 9000, VarSet]
type = VarSet
trigger1 = (!Time)
fv = 0
value = 100

[State 9000, NotHitBy]
type = NotHitBy
trigger1 = (Time < 10)
value = SCA

[State 0, HitBy]
type = HitBy
trigger1 = time >= 10
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
;value2 = S,NA
time = 1
ignorehitpause = 1
persistent = 1

[State 9000, VelSet]
type = VelSet
trigger1 = (!Time)
x = -5

[State 9000, ChangeState]
type = ChangeState
trigger1 = time=178
value = 0
ctrl=1

;SUPER ARMOR TEST
[Statedef 9393]
type = U
movetype = I
physics = N
ctrl = 0

[State 9393, ]
type = BindToRoot
trigger1 = 1
ignorehitpause = 1

[State 9393, ChangeAnim]
type = ChangeAnim
trigger1 = selfanimexist(root,anim)
elem = root,animelemno(0)
value = root,anim

[State 9393, ]
type = HitBy
trigger1 = 1
value = SCA,AA,AP

[State 9393, ]
type = AssertSpecial
trigger1 = 1
flag = invisible
flag2 = noshadow

[State 9393, ]
type = HitOverride
trigger1 = 1
attr = SCA,AA,AP
stateno = 9394
time = -1
slot = 0

[State 9393, ]
type = DestroySelf
trigger1 = root,fvar(7)!=1

;-------
; = SUPER ARMOR TEST END
[Statedef 9394]
type = U
movetype = H
physics = N
ctrl = 0

[State 0, PalFX]
type = PalFX
trigger1 = enemynear,movecontact
time = 8
add = 256,256,256
mul = 256,256,256
;sinadd = 0,0,0,10
invertall = 0
color = 256
ignorehitpause = 1
;persistent =

[State 9394, ]
type = BindToRoot
trigger1 = 1
ignorehitpause = 1

[State 9394, ChangeAnim]
type = ChangeAnim
trigger1 = selfanimexist(root,anim)
elem = root,animelemno(0)
value = root,anim

[State 9394, ]
type = NotHitBy
trigger1 = 1
value = SCA,AA,AP

[State 9394, ]
type = AssertSpecial
trigger1 = 1
flag = invisible
flag2 = noshadow

[State 9394, ]
type = ChangeState
trigger1 = 1
value = 9393

[State 9394, ]
type = DestroySelf
trigger1 = !(enemynear,movehit)
trigger2 = (root,fvar(7)!=1)

;--------------------------------------------------
; ALIGNMENT START
[Statedef 518048]
type=S
physics=S
movetype=I
anim=7
ctrl=0
velset=0,0

[State 0, Null]
type = Null
trigger1 = 1
;ignorehitpause =
;persistent =


;--------------------------------------------------
;Power Charge
[Statedef 8070]
type=S
physics=S
movetype=I
anim=7
ctrl=0
velset=0,0

[State 0, vox charge]
type = PlaySnd
trigger1 = animelem = 1
value = 6,19
channel = 0
volume=255

[State 0, start]
type = PlaySnd
trigger1 = animelem = 1
value = 13,4
channel = 7
persistent=0

[State 0, start (whirr)]
type = PlaySnd
trigger1 = animelem = 1
value = 13,6
volume = 125
channel = 10
persistent=0
loop=-1

[State 0, StopSnd]
type = StopSnd
trigger1 = power>2989
trigger2 = command != "holdX"
channel = 10

[State 0, level 1,2]
type = PlaySnd
trigger1 = power > 1000 && power < 1015
trigger2 = power > 2000 && power < 2015
value = 13,2
channel = 7
volume = 255

[State 0, level 3]
type = PlaySnd
trigger1 = power > 2975 && power < 3000
value = 13,1
channel = 7
volume = 255

[State 0, level 1,2]
type = PlaySnd
trigger1 = power > 1000 && power < 1015
trigger2 = power > 2000 && power < 2015
value = 13,3
channel = 8
volume = 255

[State 0, level 3]
type = PlaySnd
trigger1 = power > 2975 && power < 3000
value = 13,3
channel = 8
volume = 255

[State 0, level 3 (sweep)]
type = PlaySnd
trigger1 = power > 2975 && power < 3000
trigger2 = command != "holdX"
value = 13,5
channel = 9
volume = 255
persistent=0

[State 0, release]
type = PlaySnd
trigger1 = power < 3000
trigger1 = command != "holdX"
value = 13,3
channel = 7
persistent=0

[State 0, Charge Dust Top]
type = Explod
triggerall = power < 2989
trigger1 = command="holdX"
trigger1 = numexplod(11016)=0
anim=F11016
ID = 11016
pos = 0,0
postype = p1
removetime = -1
bindtime=-1
scale = 1.5,1.5;ground
sprpriority = 5

[State 0, Charge Dust Top Output]
type = Explod
triggerall = numexplod(11016)=1
triggerall = numexplod(11018)=0
trigger1 = command!="holdX"
trigger2 = power > 2989
anim=F11018
ID = 11018
pos = 0,0
postype = p1
removetime = -2
bindtime=-1
scale = 1.5,1.5;ground
sprpriority = 5
persistent=0

[State 0, Remove Charge Dust Top]
type = RemoveExplod
trigger1 = command!="holdX"
trigger2 = power > 2989
id =11016

[State 0, Charge Dust Bac]
type = Explod
triggerall = power < 2989
trigger1 = command="holdX"
trigger1 = numexplod(11017)=0
anim=F11017
ID = 11017
pos = 0,0
postype = p1
removetime = -1
bindtime=-1
scale = 1.5,1.5;ground
sprpriority = -3

[State 0, Charge Dust Bac Output]
type = Explod
triggerall = numexplod(11018)=1
triggerall = numexplod(11019)=0
trigger1 = command!="holdX"
trigger2 = power > 2989
anim=F11019
ID = 11019
pos = 0,0
postype = p1
removetime = -2
bindtime=-1
scale = 1.5,1.5;ground
sprpriority = -3

[State 0, Remove Charge Dust Bac]
type = RemoveExplod
trigger1 = command!="holdX"
trigger2 = power > 2989
id =11017

[State 0, Dust Ring Top]
type = Explod
triggerall = numexplod(11016)=1 || numexplod(11018) = 1
triggerall = numexplod(11020)=0
trigger1 = power > 1000 && power < 1200
trigger2 = power > 2000 && power < 2200
trigger3 = power = 3000
anim=F11020
ID = 11020
pos = 0,0
postype = p1
removetime = -2
bindtime=-1
scale = 1.5,1.5;ground
sprpriority = 7

[State 0, Dust Ring Back]
type = Explod
triggerall = numexplod(11016)=1 || numexplod(11018) = 1
triggerall = numexplod(11020)=0
trigger1 = power > 1000 && power < 1200
trigger2 = power > 2000 && power < 2200
trigger3 = power = 3000
anim=F11021
ID = 11021
pos = 0,0
postype = p1
removetime = -2
bindtime=-1
scale = 1.5,1.5;ground
sprpriority = -3

[State 999, sound]
type=playSnd
trigger1=animelem=1
value = 87,10

[State 999, sound]
type=playSnd
trigger1=animtime=0
value = 87, 10

[State 999, sound]
type=playSnd
;trigger1=command="c"||command="z"
trigger1=command="holdX"
value = 1,2

[State 400, power]
type=poweradd
triggerall=p2stateno != [5020,5071]
triggerall=anim=7&&power<3000
trigger1=var(15)<=0&&(command="holdX")
trigger2=var(15)>=1
value=ifelse(time>=2,7,ceil(time/5))
;value=2

[State 400, shake]
type=envshake
triggerall=power<3000
trigger1=anim=7&&!(time%4)
trigger1=time>9
time=4
freq=80
ampl=4

[State 0, EnvColor]
type = EnvColor
trigger1 = power>2987
value = 255,255,255
time = 5
under = 1
ignorehitpause = 1
persistent = 0

[State 400, end]
type=changestate
triggerall = var(15)=0
trigger1 = time > 26
trigger1 = command != "holdX"
trigger2 = power=3000
;trigger2 = command = "holdB"
value=0
ctrl=1

[State 400, ai end]
type=changestate
triggerall = var(15)=1
triggerall = abs(p2bodydist x) < 40
triggerall = abs(p2bodydist y) < 40
trigger1 = time > 5
trigger2 = power=3000
;trigger2 = command = "holdB"
value=0
ctrl=1

;--------------------------------------
;Super armor
[Statedef 8100]
type=U
MoveType = H

[State 8100, PosFreeze]
type = PosFreeze
trigger1 = 1
value = 1

[State 8100, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA, AA, AP
time = 1

[State 400, power]
type=varadd
trigger1=command="holdB"
trigger1=(gametime%1)=0
fv=3
value=1

[State 8100, LifeAdd]
type = LifeAdd
trigger1 = Time = 0
value = -(gethitvar(damage))

[state 0, hitcounter]
type=varadd
trigger1=enemynear,movetype=A
trigger1=enemynear,movecontact
fv=5
value=1
persistent=0

[State 8100, ChangeAnim]
type = ChangeAnim
trigger1 = Time < floor(gethitvar(hittime) * 0.8)
value = Anim
elem? = AnimElemNo(0)

[State 8100, End]
type = ChangeState
trigger1 = Time >= floor(gethitvar(hittime) * 0.8)
value = var(35)

;-----------------------------
; Dark Focus Charge
[Statedef 10800]
type    = S
movetype= A
physics = S
juggle  = 4
poweradd= 0
velset = (prevstateno = 10800)* 0,(prevstateno = 10800)* 0
anim = 7
ctrl = 0
sprpriority = 2
facep2 = !(prevstateno = 10800)



;[State 400, power]
;type=varadd
;trigger1=command="special_h"
;trigger1=(gametime%1)=0
;fv=3
;value=1

[State 200, vox]
type = PlaySnd
trigger1 = Time = 0
value = 6,7
volume=200
channel=0

[State 610, 2]
type = PlaySnd
trigger1 = animelem=3
trigger2 = animelem=7
value = 5,18
volume=50

;[State 1000, 7]
;type = ChangeState
;trigger1 = command != "special_h"
;trigger2 = AnimTime = 0
;value = 0
;ctrl = 1

;-----------------------------
; Dark Focus Swing
[Statedef 10805]
type    = S
movetype= A
physics = S
juggle  = 4
poweradd= 0
velset = (prevstateno = 10805)* 0,(prevstateno = 10805)* 0
;anim = 3800
ctrl = 0
sprpriority = 2
facep2 = !(prevstateno = 10805)

[state 0, damage counter set]
type = varadd
trigger1 = (movehit)
var(3) = ((enemynear, gethitvar(damage))/1)
persistent = 1
ignorehitpause = 1

; [State 0, NotHitBy]
; type = NotHitBy
; trigger1 = 1
; value = SCA

[state 0, damage counter set]
type = varadd
trigger1 = (movehit)
var(3) = ((enemynear, gethitvar(damage))/1)
persistent = 1
ignorehitpause = 1

[State 0, remove dust]
type = RemoveExplod
trigger1 = time=0
id =11040

[State 0, dust out]
type = Explod
trigger1 = numexplod(11041)=0
trigger1 = time=0
anim=F11041
ID = 11041
pos = 0,0
postype = p1
removetime = -2
scale = 0.5,0.5
sprpriority = 7
ignorehitpause=1
supermove=1

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = time=0
id =3810

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = fvar(3)>40
flag = unguardable

[State 3050, Super A]
type = SuperPause
trigger1 = fvar(3)>40
trigger1 = time=0
time=10
pos = -5, -55
anim = 100
sound = 20, 0

[State 0, charge start]
type = Explod
trigger1 = time=0
anim = 3815
ID = 3815
pos = 0,0
postype = p1
removetime = -2
scale = 0.5,0.5
sprpriority = 5
ignorehitpause=1

[State 8100, LifeAdd]
type = LifeAdd
trigger1 = Time = 0
value = -(gethitvar(damage))

[state 0, hitcounter]
type=varadd
trigger1=enemynear,movetype=A
trigger1=enemynear,movecontact
fv=5
value=1
persistent=0

[State 10800, ChangeAnim]
type = ChangeAnim
;trigger1 = fvar(5)<3
trigger1 = Time = 0 && Anim != 3805
value = 3805

[State 200, vox]
type = PlaySnd
trigger1 = Time = 0
value = 6,7
volume=200
channel=0

[State 610, 2]
type = PlaySnd
trigger1 = animelem=3
trigger2 = animelem=7
value = 5,18
volume=50

[State 240, 2]
type = HitDef
trigger1 = Time = 0
trigger1 = fvar(3)<40
priority=4,hit
attr = S, NA
animtype  = High
damage    = 2.0*(fvar(3))
guardflag = MA
pausetime = 12,25
sparkno = 1
sparkxy = -10,-60
hitsound   = 5,3
guardsound = 6,0
ground.type = low
ground.slidetime = 12
ground.hittime  = 30
ground.velocity = -9,0
air.type = low
air.velocity = -9,0
air.hittime=35

[State 240, 2]
type = HitDef
trigger1 = Time = 0
trigger1 = fvar(3)>=40
priority=4,hit
attr = S, NA
animtype  = back
damage    = 2.0*(fvar(3))
guardflag = MA
pausetime = 12,25
sparkno = 1
sparkxy = -10,-60
hitsound   = 5,3
guardsound = 6,0
ground.type = high
ground.slidetime = 12
ground.hittime  = 30
ground.velocity = -15,0
air.type = high
air.velocity = -15,-2
air.hittime=35
p2stateno=5600
fall=1
air.fall=1

[State 1000, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;-----------------------------
; Light Shell On
[Statedef 10900]
type    = S
movetype= A
physics = S
juggle  = 4
poweradd= 0
;velset = (prevstateno = 10800)* 0,(prevstateno = 10800)* 0
anim = 7
ctrl = 0
sprpriority = 2
facep2 = !(prevstateno = 10800)

[State 0, CtrlSet]
type = CtrlSet
trigger1 = time=10
value = 1

[State 0, PalFXWiz]
type = PalFX
trigger1 =time=0
time =10
add = 100,100,180
mul = 256,256,256
sinadd = -80,-80,-80,10
invertall = 0
color = 0

[state 0, varset]
type=varset
trigger1=time=0
fv=7
value=1

[State 0, Charge Dust Top Output]
type = Explod
trigger1 = numexplod(11718)=0
trigger1 = time=0
anim=F11718
ID = 11718
pos = 0,0
postype = p1
removetime = -2
scale = 0.5,0.5
sprpriority = 5
persistent=0

[State 200, vox]
type = PlaySnd
trigger1 = Time = 0
value = 6,9
volume=200
channel=0

[State 610, 2]
type = PlaySnd
trigger1 = time=0
value = 13,2
volume=255

[State 1000, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;-----------------------------
; Light Shell Off
[Statedef 10910]
type    = S
movetype= A
physics = S
juggle  = 4
poweradd= 0
;velset = (prevstateno = 10800)* 0,(prevstateno = 10800)* 0
anim = 7
ctrl = 0
sprpriority = 2
facep2 = !(prevstateno = 10800)

[State 0, PalFXWiz]
type = PalFX
trigger1 =time=0
time =10
add = 100,100,180
mul = 256,256,256
sinadd = -80,-80,-80,10
invertall = 0
color = 0

[state 0, varset]
type=varset
trigger1=time=0
fv=7
value=0

[State 0, Charge Dust Top Output]
type = Explod
trigger1 = numexplod(11618)=0
trigger1 = time=0
anim=F11618
ID = 11618
pos = 0,0
postype = p1
removetime = -2
scale = 0.5,0.5
sprpriority = 5
persistent=0

[State 200, vox]
type = PlaySnd
trigger1 = Time = 0
value = 6,9
volume=200
channel=0

[State 610, 2]
type = PlaySnd
trigger1 = time=0
value = 13,2
volume=255

[state 0, light shell palfx]
type = PalFX
trigger1 = time=1
;time = 60
time = (power/3)
add = 0,0,0
mul = 256,256,256
sinadd =0,0,0,1
invertall = 0
color = 255
ignorehitpause = 1
persistent = 0

[State 1000, 7]
type = ChangeState
trigger1 = time=10
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Push Block SC
[Statedef 11000]
type = S
physics = S
movetype = H
ctrl = 0
anim = 6000
poweradd=0
;velset=-30,0

[State 0, PowerAdd]
type = PowerAdd
trigger1 = time = 0
value = -500

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time=2
value = 30,3

[State 6000, PalFXWiz]
type = PalFX
trigger1=time=0
time = 15
add = 100,100,180
mul = 256,256,256
sinadd = 50,50,50,30
invertall = 0
color = 256

;[State 0, light]
;type = VarSet
;trigger1 = time=0
;var(51) = enemy,hitpausetime ;ceil(power/1000)
;ignorehitpause = 1
;persistent = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = time = 0
movetype = A      

;[State 0, light]
;type = VarSet
;trigger1 = p2stateno = [200,209]
;trigger2 = p2stateno = [400,409]
;trigger3 = p2stateno = [600,609]
;var(51) = -10
;ignorehitpause = 1
;persistent = 1
;
;[State 0, mid]
;type = VarSet
;trigger1 = p2stateno = [210,219]
;trigger2 = p2stateno = [410,419]
;trigger3 = p2stateno = [610,619]
;trigger4 = p2stateno = [1000,2999]
;var(51) = -20
;ignorehitpause = 1
;persistent = 1
;
;[State 0, strong]
;type = VarSet
;trigger1 = p2stateno = [220,299]
;trigger2 = p2stateno = [420,499]
;trigger3 = p2stateno = [620,699]
;trigger4 = p2stateno = [3000,99999999]
;var(51) = -30
;ignorehitpause = 1
;persistent = 1

[state 0, normal shield]
type = HitOverride
trigger1 = 1;time=0
attr = SCA,AA,AP,AT
slot = 3
stateno = 11050
time = 6
forceair = 0

[State 210, stun hit]
type = HitDef
trigger1=p2statetype!=A
trigger1=time=0
priority=7,hit
attr = S, NA
animtype  = High
damage    = 0
guardflag = MA
pausetime = 0,0
sparkno = 72
sparkxy = -10,-30
hitsound   = 20,1
guardsound = 6,0
ground.type = High
ground.slidetime = 12
ground.hittime  = 1
ground.velocity = -4,0
air.velocity = -4,-1
air.hittime=35
palfx.add = 240,50,0
palfx.mul = 250,224,120
palfx.sinadd = 110,55,85,30
palfx.invertall = 0
palfx.color = 0
palfx.time = 30
air.fall=1
p2stateno = 13552

[State 210, stun hit]
type = HitDef
trigger1=p2statetype=A
trigger1=time=0
priority=7,hit
attr = S, NA
animtype  = High
damage    = 0
guardflag = MA
pausetime = 0,0
sparkno = 72
sparkxy = -10,-30
hitsound   = 20,1
guardsound = 6,0
ground.type = High
ground.slidetime = 12
ground.hittime  = 1
ground.velocity = -4,0
air.velocity = -4,-1
air.hittime=35
palfx.add = 240,50,0
palfx.mul = 250,224,120
palfx.sinadd = 110,55,85,30
palfx.invertall = 0
palfx.color = 0
palfx.time = 30
air.fall=1
p2stateno = 13553

[State 330, 1]
type = ChangeState
trigger1 = time = 20
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Push Block SCP Final
[Statedef 11050]
type = S
physics = S
movetype = H
ctrl = 0
velset = 0,0
;anim = 6000
poweradd=0

[State 0, VelAdd]
type = varadd
trigger1 = time=0
var(17)=1

[state 8100, damage negator]
type = lifeadd
trigger1 = time<=6
value = 0

[state 0, hitcounter]
type=varadd
trigger1=enemynear,movetype=A
trigger1=enemynear,movecontact
fv=5
value=1
persistent=0

[State 10800, ChangeAnim]
type = ChangeAnim
trigger1 = Time<=6 && Anim != 6005
value = 6005

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time=2
value = 30,3

[State 6000, PalFXWiz]
type = PalFX
trigger1=time=0
time = 8
add = 100,100,180
mul = 256,256,256
sinadd = 50,50,50,30
invertall = 0
color = 256

[State 210, stun hit]
type = HitDef
trigger1=p2statetype != A
trigger1=time=0
priority=7,hit
attr = S, NA
animtype  = High
damage    = 0
guardflag = MA
pausetime = 0,0
sparkno = 1
sparkxy = -10,-30
hitsound   = 20,1
guardsound = 6,0
ground.type = High
ground.slidetime = 12
ground.hittime  = 1
ground.velocity = -4,0
air.velocity = -4,-1
air.hittime=35
palfx.add = 240,50,0
palfx.mul = 250,224,120
palfx.sinadd = 110,55,85,30
palfx.invertall = 0
palfx.color = 0
palfx.time = 30
air.fall=1
p2stateno = 13552

[State 210, stun hit]
type = HitDef
trigger1=p2statetype = A
trigger1=time=0
priority=7,hit
attr = S, NA
animtype  = High
damage    = 0
guardflag = MA
pausetime = 0,0
sparkno = 1
sparkxy = -10,-30
hitsound   = 20,1
guardsound = 6,0
ground.type = High
ground.slidetime = 12
ground.hittime  = 1
ground.velocity = -4,0
air.velocity = -4,-1
air.hittime=35
palfx.add = 240,50,0
palfx.mul = 250,224,120
palfx.sinadd = 110,55,85,30
palfx.invertall = 0
palfx.color = 0
palfx.time = 30
air.fall=1
p2stateno = 13553

[state 0, ctrl reset]
type=ctrlset
trigger1=movecontact
value=1

[State 330, 1]
type = ChangeState
trigger1=animtime=0
trigger2=movecontact
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Push Blocked SC
 [Statedef 13552]
 type = S
 physics = S
 movetype = H
 ctrl = 0
;velset = enemy,var(51),0
 ;anim = 6005
;poweradd=-5
 
[State 0, VelSet]
type = VelSet
trigger1 = time = 0
x = enemy,var(51) * -3 ;animtime * enemy,var(51)
y = 0

[State 0, PalFXWiz]
type = PalFX
trigger1 = time = 0
time = 10
add = 200,0,180
mul = 200,0,200
sinadd = 100,0,100,5
invertall = 0
color = 255

 [State 0, PlaySnd]
 type = PlaySnd
 trigger1 = time=2
 value = 30,3
 
 [State 330, 1]
 type = selfstate
 trigger1=animtime=0
 value = 0
 ctrl = 1

;---------------------------------------------------------------------------
; Push Blocked A
 [Statedef 13553]
 type = A
 physics = A
 movetype = H
 ctrl = 0
;velset = enemy,var(51),-3
 ;anim = 6005
;poweradd=-5

[State 0, VelSet]
type = VelSet
trigger1 = time = 0
x = enemy,var(51)
 
[State 0, PalFXWiz]
type = PalFX
trigger1 = time = 0
time = 10
add = 200,0,180
mul = 200,0,200
sinadd = 100,0,100,5
invertall = 0
color = 255

 [State 0, PlaySnd]
 type = PlaySnd
 trigger1 = time=2
 value = 30,3
 
 [State 330, 1]
 type = selfstate
trigger1= vel y > 0
trigger1= pos y > -vel y
 value = 0
 ctrl = 1

;---------------------------------------------------------------------------
; Repel Shield A
[Statedef 11010]
type = A
physics = A
movetype = A
ctrl = 0
anim = 6001
poweradd=-100

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time=2
value = 30,3

; [state 6000, (shield spark]
; type=explod
; trigger1=time=0
; sprpriority=7
; anim=11005
; ID=11005
; scale=0.5,0.5
; postype=p1
; pos=30,-45
; supermove=1
; supermovetime=9999
; pausemovetime=9999

[State 6000, PalFXWiz]
type = PalFX
trigger1=time=0
time = 8
add = 100,100,180
mul = 256,256,256
sinadd = 50,50,50,30
invertall = 0
color = 256

[state 0, perfect shield]
type = HitOverride
trigger1 = animelem=1
attr = SCA,NA,HA,SA        ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
slot = 2
stateno = 11060
time = 2
forceair = 0

[state 0, normal shield]
type = HitOverride
trigger1 = animelem=2
attr = SCA,NA,HA,SA        ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
slot = 3
stateno = 11061
time = 5
forceair = 0

[state 0, projectile shield]
type = HitOverride
trigger1 = animelem=1
trigger2 = animelem=2
attr = SCA,NP       ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
slot = 4
stateno = 11062
time = 5
forceair = 0

;---------------------------------------------------------------------------
; Shield SCN Final
[Statedef 11051]
type = S
physics = S
movetype = A
ctrl = 0
;anim = 6000
poweradd=0

[State 3050, Super A]
type = SuperPause
trigger1 = time = 0
pos = -5, -55
anim = 100
sound = 20, 0
poweradd = -100
time=5

[state 8100, damage negator]
type = lifeadd
trigger1 = time<=6
value = 0

[state 0, hitcounter]
type=varadd
trigger1=enemynear,movetype=A
trigger1=enemynear,movecontact
fv=5
value=1
persistent=0

[State 10800, ChangeAnim]
type = ChangeAnim
trigger1 = Time<=6 && Anim != 6005
value = 6005

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time=2
value = 30,3

[State 6000, PalFXWiz]
type = PalFX
trigger1=time=0
time = 8
add = 100,100,180
mul = 256,256,256
sinadd = 50,50,50,30
invertall = 0
color = 256

[State 210, knockdown ]
type = HitDef
trigger1=time=0
priority=7,hit
attr = S, NA
animtype  = High
damage    = 0
guardflag = MA
pausetime = 0,0
sparkno = 1
sparkxy = -10,-30
hitsound   = 20,1
guardsound = 6,0
ground.type = High
ground.slidetime = 12
ground.hittime  = 40
ground.velocity = -4,0
air.velocity = -4,-1
air.hittime=35
palfx.add = 100,100,180
palfx.mul = 256,256,250
palfx.sinadd = -80,-80,-80,20
palfx.invertall = 0
palfx.color = 256
palfx.time = 30
; fall=1
air.fall=1

[state 0, ctrl reset]
type=ctrlset
trigger1=movecontact
value=1

[State 330, 1]
type = ChangeState
trigger1=animtime=0
trigger2=movecontact
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Shield SC/NP Final
[Statedef 11052]
type = S
physics = S
movetype = A
ctrl = 0
;anim = 6000
poweradd=-100

[state 8100, damage negator]
type = lifeadd
trigger1 = time<=6
value = 0

[state 0, hitcounter]
type=varadd
trigger1=enemynear,movetype=A
trigger1=enemynear,movecontact
fv=5
value=1
persistent=0

[State 10800, ChangeAnim]
type = ChangeAnim
trigger1 = Time<=6 && Anim != 6020
value = 6020

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time=2
value = 30,3

[State 6000, PalFXWiz]
type = PalFX
trigger1=time=0
time = 8
add = 100,100,180
mul = 256,256,256
sinadd = 50,50,50,30
invertall = 0
color = 256

[State 210, stun hit]
type = HitDef
trigger1=time=0
priority=7,hit
attr = S, NA
animtype  = High
damage    = 0
guardflag = MA
pausetime = 0,0
sparkno = 1
sparkxy = -10,-30
hitsound   = 20,1
guardsound = 6,0
ground.type = High
ground.slidetime = 12
ground.hittime  = 36
ground.velocity = -4,0
air.velocity = -4,-1
air.hittime=35
palfx.add = 240,50,0
palfx.mul = 250,224,120
palfx.sinadd = 110,55,85,30
palfx.invertall = 0
palfx.color = 0
palfx.time = 30

[state 0, ctrl reset]
type=ctrlset
trigger1=movecontact
value=1

[State 330, 1]
type = ChangeState
trigger1=animtime=0
trigger2=movecontact
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Shield AP Final
[Statedef 11060]
type = A
physics = A
movetype = A
ctrl = 0
;anim = 6000
poweradd=-100

[state 8100, damage negator]
type = lifeadd
trigger1 = time<=6
value = 0

[state 0, hitcounter]
type=varadd
trigger1=enemynear,movetype=A
trigger1=enemynear,movecontact
fv=5
value=1
persistent=0

[State 10800, ChangeAnim]
type = ChangeAnim
trigger1 = Time<=6 && Anim != 6006
value = 6006

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time=2
value = 30,3

[State 6000, PalFXWiz]
type = PalFX
trigger1=time=0
time = 8
add = 100,100,180
mul = 256,256,256
sinadd = 50,50,50,30
invertall = 0
color = 256

[State 210, stun hit]
type = HitDef
trigger1=time=0
priority=7,hit
attr = S, NA
animtype  = High
damage    = 0
guardflag = MA
pausetime = 24,50
sparkno = 1
sparkxy = -10,-30
hitsound   = 20,1
guardsound = 6,0
ground.type = High
ground.slidetime = 12
ground.hittime  = 26
ground.velocity = -4,0
air.velocity = -4,-1
air.hittime=35
palfx.add = 240,50,0
palfx.mul = 250,224,120
palfx.sinadd = 110,55,85,30
palfx.invertall = 0
palfx.color = 0
palfx.time = 30

[state 0, ctrl reset]
type=ctrlset
trigger1=movecontact
value=1

; [State 330, 1]
; type = ChangeState
; trigger1=animtime=0
; value = 0
; ctrl = 1

;---------------------------------------------------------------------------
; Shield AN Final
[Statedef 11061]
type = A
physics = A

movetype = A
ctrl = 0
;anim = 6000
poweradd=-100

[state 8100, damage negator]
type = lifeadd
trigger1 = time<=6
value = 0

[state 0, hitcounter]
type=varadd
trigger1=enemynear,movetype=A
trigger1=enemynear,movecontact
fv=5
value=1
persistent=0

[State 10800, ChangeAnim]
type = ChangeAnim
trigger1 = Time<=6 && Anim != 6006
value = 6006

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time=2
value = 30,3

[State 6000, PalFXWiz]
type = PalFX
trigger1=time=0
time = 8
add = 100,100,180
mul = 256,256,256
sinadd = 50,50,50,30
invertall = 0
color = 256

[State 210, knockdown ]
type = HitDef
trigger1=time=0
priority=7,hit
attr = S, NA
animtype  = High
damage    = 0
guardflag = MA
pausetime = 24,40
sparkno = 1
sparkxy = -10,-30
hitsound   = 20,1
guardsound = 6,0
ground.type = High
ground.slidetime = 12
ground.hittime  = 26
ground.velocity = -4,-1
air.velocity = -4,-1
air.hittime=35
palfx.add = 100,100,180
palfx.mul = 256,256,250
palfx.sinadd = -80,-80,-80,20
palfx.invertall = 0
palfx.color = 256
palfx.time = 30
fall=1
air.fall=1

[state 0, ctrl reset]
type=ctrlset
trigger1=movecontact
value=1

; [State 330, 1]
; type = ChangeState
; trigger1=animtime=0
; value = 0
; ctrl = 1

;---------------------------------------------------------------------------
; Shield A/NP Final
[Statedef 11062]
type = A
physics = A

movetype = A
ctrl = 0
;anim = 6000
poweradd=-100

[state 8100, damage negator]
type = lifeadd
trigger1 = time<=6
value = 0

[state 0, hitcounter]
type=varadd
trigger1=enemynear,movetype=A
trigger1=enemynear,movecontact
fv=5
value=1
persistent=0

[State 10800, ChangeAnim]
type = ChangeAnim
trigger1 = Time<=6 && Anim != 6020
value = 6020

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time=2
value = 30,3

[State 6000, PalFXWiz]
type = PalFX
trigger1=time=0
time = 8
add = 100,100,180
mul = 256,256,256
sinadd = 50,50,50,30
invertall = 0
color = 256

[State 210, knockdown ]
type = HitDef
trigger1=time=0
priority=7,hit
attr = S, NA
animtype  = High
damage    = 0
guardflag = MA
pausetime = 24,40
sparkno = 1
sparkxy = -10,-30
hitsound   = 20,1
guardsound = 6,0
ground.type = High
ground.slidetime = 12
ground.hittime  = 26
ground.velocity = -4,-1
air.velocity = -4,-1
air.hittime=35
palfx.add = 100,100,180
palfx.mul = 256,256,250
palfx.sinadd = -80,-80,-80,20
palfx.invertall = 0
palfx.color = 256
palfx.time = 30
fall=1
air.fall=1

[state 0, ctrl reset]
type=ctrlset
trigger1=movecontact
value=1

; [State 330, 1]
; type = ChangeState
; trigger1=animtime=0
; value = 0
; ctrl = 1

;---------------------------------------------------------------------------
; Parry SC
[Statedef 11070]
type = U
movetype = I
physics = U
anim = IfElse(StateType = S,6005,6005) ;<--- The first value should be the standing parry anim, 2nd being the crouching parry anim.
velset = 0,0
ctrl = 0
poweradd = 0
juggle = 0
facep2 = 1
hitdefpersist = 0
movehitpersist = 0
hitcountpersist = 0
sprpriority = 7

[State 0, overdrive add]
type = varadd
trigger1 = time = 0
fvar(8) = 5

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
var(24) = 10

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
var(22) = 60

[State ***1: AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = NoWalk

[State 0, SprPriority]
type = SprPriority
trigger1 = 1 
value = 7

[State ***1: NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA

[State ***1: Pause]
type = Pause
trigger1 = (!time)
time = 10
movetime = 20

[State 0, VelSet]
type = VelSet
trigger1 = time = 0
x = 0
y = 0
ignorehitpause = 1

[State 0, VelSet]
type = VelSet
trigger1 = time = 1
x = -1
y = 0
ignorehitpause = 1

[State 0, EnvShake]
type = EnvShake
trigger1 = time = 0
time = 5
freq = 60
ampl = -4
phase = 90
ignorehitpause = 1

[State 0, EX Palfx]
type = PalFX
trigger1 = time = 0
time = 6
add = 30,200,-255
mul = 256,256,256
sinadd = 30,200,-255,3
invertall = 0
color = 0

[State 0, EX sound]
type = PlaySnd
trigger1 = time = 0
value = F29,5
volume = 255
channel = -1

[State ***1: ChangeState]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Parry A
[Statedef 11071]
type = A
movetype = I
physics = N
anim = 6005
ctrl = 0
poweradd = 0
juggle = 0
facep2 = 0
hitdefpersist = 0
movehitpersist = 0
hitcountpersist = 0
sprpriority = 2

[State ***2: CtrlSet]
type = CtrlSet
trigger1 = (Time > 4)
value = 1

[State ***2: NotHitBy]
type = NotHitBy
trigger1 = (Time < 14)
value = SCA

[State ***2: Pause]
type = Pause
trigger1 = (!Time)
time = 14
movetime = 14

[State ***2: VarSet]
type = VarSet
trigger1 = (!Time)
var(43) = 1

[State ***2: Null]
type = Null
trigger1 = (!Time)
trigger1 = (FVar(10) := Vel X) && (FVar(11) := Vel Y)

[State ***2: VelSet]
type = VelSet
trigger1 = (Time)
x = 0
y = 0
persistent = 0

[State ***2: VelSet]
type = VelSet
trigger1 = (Time > 14)
x = FVar(10)
y = FVar(11)
persistent = 0

[State ***2: VelAdd]
type = VelAdd
trigger1 = (Time > 14)
y = 0.45

[State 0, VarSet]
type = VarSet
trigger1 = time=0
trigger1 = var(42)=0
v = 42
value = 10
ignorehitpause = 1
persistent =

[State 6000, PalFXWiz]
type = PalFX
trigger1=time=0
time = 10
add = 100,100,180
mul = 256,256,256
sinadd = 50,50,50,30
invertall = 0
color = 256

[State 0, EnvShake]
type = EnvShake
trigger1 = time = 0
time = 5
freq = 60
ampl = -4
phase = 90
ignorehitpause = 1

[State 0, BGPalFX]
type = BGPalFX
trigger1 = time = 0
time = 5
add = 255,255,255
mul = 256,256,256
ignorehitpause = 1

[State 0, Explod]
type = Explod
trigger1 = time = 0
anim = F73
ID = 73
pos = 0,-30
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
pausemovetime = 999
scale = 1,1
sprpriority = 7
ontop = 1
removeongethit = 1

[State 0, VarSet]
type = Varadd
trigger1 = time=0
trigger1 = var(42)>=25
v = 42
value = 5
ignorehitpause = 1
persistent = 0

[State ***2: ChangeState]
type = ChangeState
trigger1 = (Pos Y >= 0) && (Vel Y > 0)
value = 52

[Statedef 11073]
type = A
movetype = I
physics = N
anim = 11000
poweradd = 0
juggle = 0
facep2 = 0
hitdefpersist = 0
movehitpersist = 0
hitcountpersist = 0
sprpriority = 2

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = invisible

[State ***3: ParentVarSet]
type = ParentVarSet
trigger1 = (!Time)
var(42) = 8
ignorehitpause = 1

[State ***3: DestroySelf]
type = DestroySelf
trigger1 = (Parent, Command != "holdfwd")

;---------------------------------------------------------------------------
; Barrier Shield S
[Statedef 12000]
type = S
physics = S
movetype = I
ctrl = 0
anim = 12000
poweradd=-5

[state 0, perfect shield]
type = HitOverride
trigger1 = 1
attr = SCA,NA,SA,HA,NP,SP,HP;,NT,ST,HT
slot = 1
stateno = 12000
time = 2
forceair = 0

[State 400, power]
type=poweradd
trigger1=gametime%1=0
value=-8

[State 0, Explod]
type = Explod
trigger1 = time=0
trigger1 = numexplod(9009)=0
anim =12000
ID =9009
pos = 0,5
postype = p1
removetime = -1
bindtime= -1
scale = 1.1*const(size.xscale),1.1*const(size.yscale)
sprpriority = 0
ontop = 0
shadow = 0,0,0
ownpal = 0
removeongethit = 0
trans=add

[State 6000, shine palfx on]
type = PalFX
trigger1 = command = "holdA" 
trigger2 = command = "holdB" 
trigger3 = command = "holdC" 
trigger4 = command = "holdZ"
time = 8
add = 100,100,180
mul = 256,256,256
sinadd = 50,50,50,30
invertall = 0
color = 256
persistent=0

[State 6000, shine palfx off]
type = PalFX
trigger1 = command != "holdA" 
trigger2 = command != "holdB" 
trigger3 = command != "holdC" 
trigger4 = command != "holdZ"
time = 0
add = 100,100,180
mul = 256,256,256
sinadd = 0,0,0,1
invertall = 0
color = 256
persistent=0

[state 8100, damage negator]
type = lifeadd
trigger1 = 1
value = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time=2
value = 30,3

[State 330, 1]
type = ChangeState
triggerall = animtime=0
trigger1 = power=0
trigger2 = command != "holdA" 
trigger2 = command != "holdB" 
trigger2 = command != "holdC" 
trigger2 = command != "holdZ"
value = 0
ctrl = 1

;;---------------------------------------------------------------------------
;; Barrier Shield C
;[Statedef 12001]
;type = C
;physics = S
;movetype = I
;ctrl = 0
;anim = 12001
;poweradd=-5
;
;[state 0, perfect shield]
;type = HitOverride
;trigger1 = 1
;attr = SCA,NA,HA,SA,NT,ST,HT        ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
;slot = 1
;stateno = 12001
;time = 2
;forceair = 0
;
;[State 400, power]
;type=poweradd
;trigger1=gametime%1=0
;value=-6
;
;[State 0, Explod]
;type = Explod
;trigger1 = time=0
;trigger1 = numexplod(9009)=0
;anim =12001
;ID =9009
;pos = 0,5
;postype = p1
;removetime = -1
;bindtime= -1
;scale = 1.1*const(size.xscale),1.1*const(size.yscale)
;sprpriority = 0
;ontop = 0
;shadow = 0,0,0
;ownpal = 0
;removeongethit = 0
;trans=add
;
;[State 6000, shine palfx on]
;type = PalFX
;trigger1=command="holdB"
;time = 8
;add = 100,100,180
;mul = 256,256,256
;sinadd = 50,50,50,30
;invertall = 0
;color = 256
;persistent=0
;
;[State 6000, shine palfx off]
;type = PalFX
;trigger1=command!="holdB"
;time = 0
;add = 100,100,180
;mul = 256,256,256
;sinadd = 0,0,0,1
;invertall = 0
;color = 256
;persistent=0
;
;[state 8100, damage negator]
;type = lifeadd
;trigger1 = time>0
;value = 0
;
;[State 0, PlaySnd]
;type = PlaySnd
;trigger1 = time=2
;value = 30,3
;
;[State 330, 1]
;type = ChangeState
;trigger1=command!="holdB"
;trigger2=power=0
;value = 0
;ctrl = 1
;
;;---------------------------------------------------------------------------
;; Barrier Shield A
;[Statedef 12002]
;type = A
;physics = A
;movetype = I
;ctrl = 0
;anim = 12000
;poweradd=-5
;
;[state 0, perfect shield]
;type = HitOverride
;trigger1 = 1
;attr = SCA,NA,HA,SA,NT,ST,HT        ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
;slot = 1
;stateno = 12000
;time = 2
;forceair = 0
;
;[State 400, power]
;type=poweradd
;trigger1=gametime%1=0
;value=-6
;
;[State 0, Explod]
;type = Explod
;trigger1 = time=0
;trigger1 = numexplod(9009)=0
;anim =12000
;ID =9009
;pos = 0,5
;postype = p1
;removetime = -1
;bindtime= -1
;scale = 1.1*const(size.xscale),1.1*const(size.yscale)
;sprpriority = 0
;ontop = 0
;shadow = 0,0,0
;ownpal = 0
;removeongethit = 0
;trans=add
;
;[State 6000, shine palfx on]
;type = PalFX
;trigger1=command="holdB"
;time = 8
;add = 100,100,180
;mul = 256,256,256
;sinadd = 50,50,50,30
;invertall = 0
;color = 256
;persistent=0
;
;[State 6000, shine palfx off]
;type = PalFX
;trigger1=command!="holdB"
;time = 0
;add = 100,100,180
;mul = 256,256,256
;sinadd = 0,0,0,1
;invertall = 0
;color = 256
;persistent=0
;
;[state 8100, damage negator]
;type = lifeadd
;trigger1 = time>0
;value = 0
;
;[State 0, PlaySnd]
;type = PlaySnd
;trigger1 = time=2
;value = 30,3
;
;[State 330, 1]
;type = ChangeState
;trigger1=command!="holdB"
;trigger2=power=0
;value = 103
;ctrl = 1

; ;---------------------------------------------------------------------------
; ; Dodge Neutral
; [Statedef 13200]
; type = S
; physics = S
; movetype = I
; ctrl = 0
; ;anim = 13200
; poweradd=-5
; 
; [State 10800, ChangeAnim]
; type = ChangeAnim
; trigger1 = Time=0 && Anim != 13200
; value = 13200
; 
; [state 8100, damage negator]
; type = lifeadd
; trigger1 = time>0
; value = 0
; 
; [state 0, hitcounter]
; type=varadd
; trigger1=enemynear,movetype=A
; trigger1=enemynear,movecontact
; fv=5
; value=1
; persistent=0
; 
; [State 6000, PalFXWiz]
; type = PalFX
; trigger1=animelem=2
; time = 8
; add = 100,100,180
; mul = 256,256,256
; sinadd = 50,50,50,30
; invertall = 0
; color = 256
; 
; [state 0, afterimage]
; type=afterimage
; trigger1=animelem=2
; time = 16
; palcolor = 256
; palbright = 30,30,30
; palcontrast = 120,120,120
; paladd = 10,10,10
; palmul = .65,.65,.65
; trans=add
; length=10
; timegap=2
; framegap=6
; 
; [State 0, PlaySnd]
; type = PlaySnd
; trigger1 = time=2
; value = 30,3
; 
; [State 330, 1]
; type = ChangeState
; trigger1=animtime=0
; value = 0
; ctrl = 1
; 
;---------------------------------------------------------------------------
 ;Dodge Forward
 [Statedef 13201]
 type = S
 physics = S
 movetype = I
 ctrl = 0
 anim = 13201
 
[State 0, PowerAdd]
type = PowerAdd
trigger1 = time = 0
value = -250

 [state 0, velset]
 type=velset
 trigger1 = time = [0,9]
 x=7
 
 [State 6000, PalFXWiz]
 type = PalFX
 trigger1 = time = 0
 time = 15
 add = 100,100,180
 mul = 256,256,256
 sinadd = 50,50,50,30
 invertall = 0
 color = 256
 
 [state 0, afterimage]
 type=afterimage
 trigger1 = time = 0
 time = 15
 palcolor = 256
 palbright = 30,30,30
 palcontrast = 120,120,120
 paladd = 10,10,10
 palmul = .65,.65,.65
 trans=add
 length=10
 timegap=1
 framegap=4
 
 [State 0, PlaySnd]
 type = PlaySnd
 trigger1 = time=2
 value = 30,3

[state 0, recover]
type = changestate
trigger1 = power = [1750,9999]
trigger1 = time = 20
trigger2 = power = [1500,1749]
trigger2 = time = 22
trigger3 = power = [1250,1499]
trigger3 = time = 24
trigger4 = power = [1000,1249]
trigger4 = time = 26
trigger5 = power = [750, 999]
trigger5 = time = 28
trigger6 = power = [500, 699]
trigger6 = time = 30
trigger7 = power = [250, 499]
trigger7 = time = 32
trigger8 = power = [0, 249]
trigger8 = time = 34
value = 0
ctrl = 1
; 
;[State 330, 1]
;type = ChangeState
;;trigger1=animtime=0
;trigger1 = time = 20 
;value = 0
;ctrl = 1
 
 ;---------------------------------------------------------------------------
 ; Dodge Back
 [Statedef 13202]
 type = S
 physics = S
 movetype = I
 ctrl = 0
 anim = 13202
 
[State 0, PowerAdd]
type = PowerAdd
trigger1 = time = 0
value = -250

 [state 0, velset]
 type=velset
 trigger1 = time = [0,9]
 x=-7
 
 [State 6000, PalFXWiz]
 type = PalFX
 trigger1 = time = 0
 time = 20
 add = 100,100,180
 mul = 256,256,256
 sinadd = 50,50,50,30
 invertall = 0
 color = 256
 
 [state 0, afterimage]
 type=afterimage
 trigger1 = time = 0
 time = 20
 palcolor = 256
 palbright = 30,30,30
 palcontrast = 120,120,120
 paladd = 10,10,10
 palmul = .65,.65,.65
 trans=add
 length=10
 timegap=1
 framegap=4
 
 [State 0, PlaySnd]
 type = PlaySnd
 trigger1 = time=2
 value = 30,3
 
[state 0, recover]
type = changestate
trigger1 = power = [1750,9999]
trigger1 = time = 20
trigger2 = power = [1500,1749]
trigger2 = time = 22
trigger3 = power = [1250,1499]
trigger3 = time = 24
trigger4 = power = [1000,1249]
trigger4 = time = 26
trigger5 = power = [750, 999]
trigger5 = time = 28
trigger6 = power = [500, 699]
trigger6 = time = 30
trigger7 = power = [250, 499]
trigger7 = time = 32
trigger8 = power = [0, 249]
trigger8 = time = 34
value = 0
ctrl = 1

;[State 330, 1]
;type = ChangeState
;trigger1 = power = [1750,9999]
;trigger1 = time = 20 
;value = 0
;ctrl = 1
; 
; ;---------------------------------------------------------------------------
; ; Counter Strike Start
; [Statedef 13500]
; type = S
; physics = S
; movetype = I
; ctrl = 0
; anim = 6020
; poweradd=0
; 
; [state 8100, damage negator]
; type = lifeadd
; trigger1 = time<=10
; value = 0
; 
; [state 0, hitcounter]
; type=varadd
; ;trigger1 = time <=10
; trigger1=enemynear,movetype=A
; trigger1=enemynear,movecontact
; fv=5
; value=1
; persistent=0
; 
; [State 10800, ChangeAnim]
; type = ChangeAnim
; trigger1 = time <= 10
; trigger1 = Time=0 && Anim != 6020
; value = 6020
; 
; [State 0, PlaySnd]
; type = PlaySnd
; trigger1 = time=2
; value = 30,3
; 
; ; [state 6000, (shield spark]
; ; type=explod
; ; trigger1=time=0
; ; sprpriority=7
; ; anim=11005
; ; ID=11005
; ; scale=0.5,0.5
; ; postype=p1
; ; pos=30,-45
; ; supermove=1
; ; supermovetime=9999
; ; pausemovetime=9999
; 
; [State 6000, PalFXWiz]
; type = PalFX
; trigger1=time=0
; time = 10
; add = 100,100,180
; mul = 256,256,256
; sinadd = 50,50,50,30
; invertall = 0
; color = 256
; 
; ; [State 0, PowerAdd]
; ; type = PowerAdd
; ; trigger1 =time>0
; ; value = 50*(gethitvar(damage))
; 
; ; [state 0, defense up]
; ; type=defencemulset
; ; trigger1=time>0
; ; value=0
; 
; [State 0, HitOverride]
; type = HitOverride
; trigger1 = time=[0,10]
; attr = SCA,NA,HA,SA        ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
; slot = 1
; stateno = 13505
; time = 1
; forceair = 0
; 
; ; [State 0, HitOverride]
; ; type = HitOverride
; ; trigger1 = time=0
; ; attr = SCA,AP        ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
; ; slot = 1
; ; stateno = 13500
; ; time = 20
; ; forceair = 0
; 
; ; [State 330, 1]
; ; type = ChangeState
; ; trigger1=p2movetype=A && time=0
; ; trigger1
; ; value = 13505
; ; ctrl = 1
; 
; [State 330, 1]
; type = ChangeState
; trigger1=animtime=0
; value = 0
; ctrl = 1
; 

;---------------------------------------------------------------------------
;Speed Mode ON
[Statedef 13505]
type    = S
movetype= A
physics = S
juggle  = 10
poweradd= -500
ctrl = 1
;velset = 0,0
anim = 2
sprpriority = -1
facep2=1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time=0
value = F40,1
volume = 255
channel = 1

[State 0, EnvShake]
type = EnvShake
trigger1 = time=0
time = 5
freq = 60
ampl = -4
phase = 90
ignorehitpause =1

[State 0, Charge Dust Top Output]
type = Explod
trigger1 = numexplod(11918)=0
trigger1 = time=0
anim=F11918
ID = 11918
pos = 0,0
postype = p1
removetime = -2
scale = 0.5,0.5
sprpriority = 5
persistent=0

[state 13505, speed on]
type = VarSet
trigger1 = time = 0
var(40)=1

[state 13505, speed block on]
type = VarSet
trigger1 = time = 0
var(41)=1

[State 1000, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Speed Mode OFF
[Statedef 13506]
type    = S
movetype= A
physics = S
juggle  = 10
poweradd= 0
ctrl = 1
;velset = 0,0
;anim = 13505
sprpriority = -1
facep2=1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time=0
value = F40,2
volume = 255
channel = 1

[State 0, Charge Dust Top Output]
type = Explod
trigger1 = numexplod(11818)=0
trigger1 = time=0
anim=F11818
ID = 11818
pos = 0,0
postype = p1
removetime = -2
scale = 0.5,0.5
sprpriority = 5
persistent=0

[state 13505, speed off]
type = VarSet
trigger1 = time = 0
var(40)=0

[State 1000, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

; ;---------------------------------------------------------------------------
; ; Counter
; 
; [Statedef 13505]
; type    = S
; movetype= A
; physics = S
; juggle  = 10
; poweradd= 0
; ctrl = 0
; ;velset = 0,0
; anim = 13505
; sprpriority = -1
; facep2=1
; 
; [state 0, damage counter set]
; type = varadd
; trigger1 = (movehit)
; var(3) = ((enemynear, gethitvar(damage))/1)
; persistent = 1
; ignorehitpause = 1
; 
; [State 3000, Super A]
; type = SuperPause
; trigger1=time=0
; time=15
; pos = 25, -57
; anim = 100
; sound = 20, 0
; poweradd = 0
; 
; [state 0, velset]
; type=velset
; trigger1=animelem=3
; trigger2=animelem=4
; x=15
; 
; [state 8100, damage negator]
; type = lifeadd
; trigger1 = time=0
; value = 0
; 
; ; [state 0, super armor anim change]
; ; type = ChangeAnim
; ; trigger1 = Time = 0 && Anim != 13505
; ; value = 13505
; ; 
; ; [state 0, super armor hitcounter]
; ; type=varadd
; ; trigger1=enemynear,movetype=A
; ; trigger1=enemynear,movecontact
; ; fv=5
; ; value=1
; ; persistent=0
; 
; [State 610, 2]
; type = PlaySnd
; trigger1 = animelem=5
; value = 5,20
; volume=50
; 
; [State 200, vox]
; type = PlaySnd
; trigger1 = Time = 0
; trigger1 = random>500
; value = 6,2
; volume=200
; channel=0
; 
; [State 210, 2]
; type = HitDef
; trigger1 =time=0
; priority=3,hit
; attr = S, NA
; animtype  = High
; damage    = ifelse(3*(gethitvar(damage)) <= 50, 3*(gethitvar(damage)), 50)
; guardflag = MA
; pausetime = 4,7
; sparkno = 1
; sparkxy = -10,-30
; hitsound   = 20,1
; guardsound = 6,0
; ground.type = High
; ground.slidetime = 12
; ground.hittime  = 26
; ground.velocity = 1,-6
; air.velocity = 1,-6
; air.hittime=35
; fall=1
; air.fall=1
; 
; [state 210, jump cancel]
; type=changestate
; trigger1=command="holdup"
; trigger1=movecontact
; value=40
; ctrl=1
; 
; ;Speed Mode
; [State -3, speed definition]
; type = ChangeAnim
; triggerall = time<14
; trigger1 = AnimElemTime(AnimElemNo(0) + 1) < 0
; trigger1 = AnimElemTime(AnimElemNo(0)) > floor ((AnimElemTime(AnimElemNo(0)) - AnimElemTime(AnimElemNo(0) + 1))/2)
; ignorehitpause = 1
; value = anim
; elem = AnimElemNo(0) + 1
; 
; [state 0, defense up]
; type=defencemulset
; trigger1=animtime=0
; value=1
; 
; [State 210, 5]
; type = ChangeState
; trigger1 = AnimTime = 0
; value = 0
; ctrl = 1

;---------------------------------------------------------------------------
; Push Block Start
 [Statedef 13550]
 type = S
 physics = S
 movetype = A
 ctrl = 0
 anim = 6005
 poweradd=-5
 
[State 0, NotHitBy]
type = NotHitBy
trigger1 = time = 0
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
;value2 = S,NA
time = 4
ignorehitpause = 1

[state 0, normal shield]
type = HitOverride
trigger1 = 1
attr = SCA,AA,AP,AT
slot = 3
stateno = 13551
time = 2
forceair = 0

[State 0, PalFXWiz]
type = PalFX
trigger1 = time = 0
time = 10
add = 200,0,180
mul = 200,0,200
sinadd = 100,0,100,5
invertall = 0
color = 255

 [State 0, PlaySnd]
 type = PlaySnd
 trigger1 = time=2
 value = 30,3
 
 [State 330, 1]
 type = ChangeState
 trigger1=animtime=0
 value = 0
 ctrl = 1

;---------------------------------------------------------------------------
; Push Block Start
 [Statedef 13551]
 type = S
 physics = S
 movetype = A
 ctrl = 0
 anim = 6005
 poweradd=-5
 
[State 0, HitDef]
type = HitDef
trigger1 = time = 0
attr = S,NA        ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
hitflag = MAFD        ;HLAFD+-
guardflag = MA         ;HLA
damage = 0,0
sparkno = S3000
guard.sparkno = S3100
sparkxy = 0,0
hitsound = S1,0
guardsound = S2,0
ground.type = High      ;Low,Trip,None
air.hittime = 20
ground.velocity = gethitvar(hitshaketime);30,0
air.velocity = 30,0
sprpriority = 1
fall.yvelocity = -4.5
fall.recover = 1
fall.recovertime = 4
;p2stateno = 13551

[State 0, PalFXWiz]
type = PalFX
trigger1 = time = 0
time = 10
add = 200,0,180
mul = 200,0,200
sinadd = 100,0,100,5
invertall = 0
color = 255

 [State 0, PlaySnd]
 type = PlaySnd
 trigger1 = time=2
 value = 30,3
 
 [State 330, 1]
 type = ChangeState
 trigger1=animtime=0
 value = 0
 ctrl = 1

;------------------------------
;Burst Dash
[statedef 13600]
type    = S
movetype=I
physics = S
anim = 13600
ctrl = 0
facep2=1
poweradd=-1000

[State 0, VarSet]  ;super armor on
type = VarSet
trigger1 = time=0
fv = 7
value = 1

[State 0, VarSet]  ;super armor after set
type = VarSet
trigger1 = Helper(9393),gethitvar(hitcount)=1
trigger1 = p2stateno!=[3000,3999]
v = 38
value = 30

[State 0, VarSet]  ;super armor off
type = VarSet
trigger1 = animtime=0
fv = 7
value = 0

[State 0, Pause]
type = Pause
trigger1 = Helper(9393),gethitvar(hitcount)=1
time = 15
movetime = 0
persistent = 0

[State 0, break]
type = ChangeState
trigger1 = Helper(9393),gethitvar(hitcount)=1
trigger1 = p2stateno = [3000,3999]
value = 13605
ctrl = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = Helper(9393),gethitvar(hitcount)=1
value = 13600
elem = 1
persistent =0

[State 0, PalFXWiz]
type = PalFX
trigger1 = time=0
time = 10
add = 50,50,50
mul = 255,255,255
sinadd = 100,100,100,10
invertall = 0
color = 256

[State 0, AfterImage]
type = AfterImage
trigger1 = time=0
time = 30
palcolor = 256
palbright = 30,30,30
palcontrast = 120,120,120
palpostbright = 0,0,0
paladd = 50,50,50
timegap=1
framegap=2
trans=add
length = 20

[state 100, (air)dash spark]
type=explod
trigger1=time=0
sprpriority=7
anim=11005
ID=11005
vel=0,0
scale = 1.5,1.5;ground
postype=p1
pos=0,0
supermove=1
supermovetime=9999
pausemovetime=9999

[state 100, envshake]
type=envshake
trigger1=time=0
ampl=9
freq=180
time=4

[state 101, velocity]
type=velset
trigger1=animelem=1
trigger2=animelem=2
trigger3=animelem=3
trigger4=animelem=4
trigger5=animelem=5
trigger6=animelem=6
x=10

[state 101, velocity]
type=velset
trigger1=animelem=7
x=0

[State 0, CtrlSet]
type = CtrlSet
trigger1 =  time >= 15
value = 1

[state 101, changestate]
type=changestate
trigger1=animtime=0
value=0
ctrl=1

;------------------------------
;Burst Dash Break
[statedef 13605]
type    = S
movetype= H
physics = A
anim = 5061
ctrl = 0
facep2=1
poweradd=0

[State 0, Pause]
type = Pause
trigger1 = time=0
time = 15
movetime = 1

[state 101, changestate]
type=changestate
trigger1=animtime=0
value=0
ctrl=1

;---------------------------------------------------------------------------
; Rapid Cancel SC
[Statedef 14000]
type    = S
movetype= A
physics = S
poweradd= -1000
ctrl = 0
;velset = 0,0
;anim = 1
sprpriority = -1
facep2=1

;[state -2, powerbar add rapid]
;type = varadd
;;triggerall = parent,fvar(8)<200
;trigger1 = time = 0
;;trigger1 = parent,stateno = 14000 || parent,stateno = 14005
;fvar(8) = 1.5
;ignorehitpause = 1
;persistent = 1

[State 0, Explod]
type = Explod
trigger1 = time=0
anim =0
ID =9009
pos = 0,0
postype = p1
removetime = 5
bindtime= -1
scale = 0.13,0.13
sprpriority = 0
ontop = 0
shadow = 0,0,0
ownpal = 0
removeongethit = 0
trans=add

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 =time=1
ID =9009
pos = 0,0
postype = p1
bindtime = -1
removetime = 4
scale = 0.14,0.14

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 =time=2
ID =9009
pos = 0,0
postype = p1
bindtime = -1
removetime = 3
scale = 0.15,0.15

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 =time=3
ID =9009
pos = 0,0
postype = p1
bindtime = -1
removetime = 2
scale = 0.18,0.18

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 =time=4
ID =9009
pos = 0,0
postype = p1
bindtime = -1
removetime = 1
scale = 0.22,0.22

[State 0, PalFXWiz]
type = PalFX
trigger1 = time=0
time =5
add = 200,0,200
mul = 256,256,256
sinadd = 80,80,80,5
invertall = 0
color = 255

;[state 0, ctrl reset]
;type=ctrlset
;trigger1=time=1
;value=1

[State 210, 5]
type = ChangeState
trigger1 = 1
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Rapid Cancel A
[Statedef 14005]
type    = A
movetype= A
physics = A
poweradd= -1000
ctrl = 0
velset = vel x, ((vel y)-1)
;anim = 13505
sprpriority = -1
facep2=1

[State 0, PalFXWiz]
type = PalFX
trigger1 = time=0
time =5
add = 200,0,200
mul = 256,256,256
sinadd = 80,80,80,5
invertall = 0
color = 255

[state 0, ctrl reset]
type=ctrlset
trigger1=time=0
value=1

[State 210, 5]
type = ChangeState
trigger1 = 1
value = 50
ctrl = 1

;---------------------------------------------------------------------------
;Overdrive On
[Statedef 14010]
type    = U
movetype= U
physics = U
; juggle  = 10
; poweradd= 0
 ctrl = 0
; ;velset = 0,0
;nim = 2
; sprpriority = -1
; facep2=1
; 

; [State 0, CtrlSet]
; type = CtrlSet
; trigger1 = time=5
; value = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time=0
value = F40,1
volume = 255
channel = 1

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = 1
id =  11016

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = 1
id =  11017

[State 0, EnvShake]
type = EnvShake
trigger1 = time=0
time = 5
freq = 60
ampl = -4
phase = 90
ignorehitpause =1

[State 0, Charge Dust Top Output]
type = Explod
trigger1 = numexplod(11018)=0
trigger1 = time=0
anim=F11018
ID = 11018
pos = 0,0
postype = p1
removetime = -2
scale = 0.5,0.5
sprpriority = 5
persistent=0

[state 13505, overdrive on]
type = VarSet
trigger1 = time = 0
var(11)=1

; [state 13505, speed block on]
; type = VarSet
; trigger1 = time = 0
; var(41)=1

[State 1000, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Overdrive Off
[Statedef 14015]
type    = U
movetype= U
physics = U
; juggle  = 10
; poweradd= 0
 ctrl = 0
; ;velset = 0,0
;nim = 13505
; sprpriority = -1
; facep2=1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time=0
value = F40,2
volume = 255
channel = 1

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = 1
id =  11016

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = 1
id =  11017

[State 0, Charge Dust Top Output]
type = Explod
trigger1 = numexplod(11018)=0
trigger1 = time=0
anim=F11018
ID = 11018
pos = 0,0
postype = p1
removetime = -2
scale = 0.5,0.5
sprpriority = 5
persistent=0

[state 13505, overdrive off]
type = VarSet
trigger1 = time = 0
var(11)=0

[State 1000, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;------------------
;Flame 1
[statedef 20010]
type=S
anim=20010

[state 0, afterimage]
type=afterimage
trigger1=time=0
time = 999
palcolor = 256
palbright = 30,30,30
palcontrast = 120,120,120
paladd = 10,10,10
palmul = .65,.65,.65
trans=add
length=10
timegap=2
framegap=6

[State 0, second flame]
type = Explod
trigger1 = time=10
anim =20010
ID =20010
pos = 0,0
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
scale = 0.5,0.5

[State 0, Charge Dust Bac Output]
type = Explod
triggerall=parent,statetype!=A
trigger1 = time=0
trigger1 = numexplod(11119)=0
anim=F11019
ID = 11119
pos = 0,0
postype = p1
removetime = -2
scale = 0.5,0.5
sprpriority = -3
ignorehitpause=1
supermove=1

[State 0, Charge Dust Top Output]
type = Explod
triggerall=parent,statetype!=A
trigger1 = time=0
trigger1 = numexplod(11118)=0
anim=F11018
ID = 11118
pos = 0,0
postype = p1
removetime = -2
scale = 0.5,0.5
sprpriority = 5
persistent=0
ignorehitpause=1
supermove=1

[state 0, destroyself]
type = destroyself
trigger1 = animtime=0

;------------------
;Flame 2
[statedef 20011]
type=S
anim=20011

[State 0, second flame]
type = Explod
trigger1 = time=13
anim =20011
ID =20011
pos = 0,0
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
scale = 0.5,0.5

[state 0, afterimage]
type=afterimage
trigger1=time=0
time = 999
palcolor = 256
palbright = 30,30,30
palcontrast = 120,120,120
paladd = 10,10,10
palmul = .65,.65,.65
trans=add
length=10
timegap=2
framegap=6

[state 0, destroyself]
type = destroyself
trigger1 = animtime=0

;------------------
;Flame 3
[statedef 20012]
type=S
anim=20012

[State 0, second flame]
type = Explod
trigger1 = time=16
anim =20012
ID =20012
pos = 0,0
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
scale = 0.5,0.5

[state 0, afterimage]
type=afterimage
trigger1=time=0
time = 999
palcolor = 256
palbright = 30,30,30
palcontrast = 120,120,120
paladd = 10,10,10
palmul = .65,.65,.65
trans=add

[state 0, destroyself]
type = destroyself
trigger1 = animtime=0

;------------------
;Flame 4
[statedef 20013]
type=S
anim=20013

[State 0, second flame]
type = Explod
trigger1 = time=19
anim =20013
ID =20013
pos = 0,0
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
scale = 0.5,0.5

[state 0, afterimage]
type=afterimage
trigger1=time=0
time = 999
palcolor = 256
palbright = 30,30,30
palcontrast = 120,120,120
paladd = 10,10,10
palmul = .65,.65,.65
trans=add
length=10
timegap=2
framegap=6

[state 0, destroyself]
type = destroyself
trigger1 = animtime=0

;------------------
;Flame 5
[statedef 20014]
type=S
anim=20014

[State 0, second flame]
type = Explod
trigger1 = time=21
anim =20014
ID =20014
pos = 0,0
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
scale = 0.5,0.5

[state 0, afterimage]
type=afterimage
trigger1=time=0
time = 999
palcolor = 256
palbright = 30,30,30
palcontrast = 120,120,120
paladd = 10,10,10
palmul = .65,.65,.65
trans=add
length=10
timegap=2
framegap=6

[state 0, destroyself]
type = destroyself
trigger1 = animtime=0

;------------------
;Flame 6
[statedef 20015]
type=S
anim=20015

[State 0, second flame]
type = Explod
trigger1 = time=24
anim =20015
ID =20015
pos = 0,0
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
scale = 0.5,0.5

[state 0, afterimage]
type=afterimage
trigger1=time=0
time = 999
palcolor = 256
palbright = 30,30,30
palcontrast = 120,120,120
paladd = 10,10,10
palmul = .65,.65,.65
trans=add
length=10
timegap=2
framegap=6

[state 0, destroyself]
type = destroyself
trigger1 = animtime=0

;---------------------------------------
;AIR COMBO------------------
[Statedef 262000]
type = S
movetype = I
physics = S
ctrl = 0
velset = 0,0
sprpriority = 7
;anim = 40000

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = invisible
ignorehitpause=1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
time=1

[State 9393, ]
type = BindToRoot
trigger1 = 1
ignorehitpause = 1

;[State 0, TargetBind]
;type = TargetBind
;trigger1 = animtime = [5,8]
;trigger1 = enemy,movetype=H && enemy,statetype=A
;trigger1 = root, stateno=[600,699]
;time = 10
;id = -1
;pos = 30,10
;ignorehitpause = 1
;;persistent =

;---------------------------------------
;HIT COUNTER----------------
[Statedef 270005]
type = S
movetype = I
physics = S
ctrl = 0
velset = 0,0
sprpriority = 7
anim = 40000

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
;trigger1 = parent,var(2)=0
flag = invisible
ignorehitpause=1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

; [State 0, PosSet]
; type = PosSet
; trigger1 = 1
; trigger1 = parent,teamside= 2
; trigger1 = screenpos y <= 0
; x = 130
; y = -105
; ignorehitpause = 1
; 
; [State 0, PosSet]
; type = PosSet
; trigger1 = 1
; trigger1 = parent,teamside= 2
; trigger1 = screenpos y >= 1
; x = 130
; y = -105 - screenpos y
; ignorehitpause = 1

[state 0, 1000+ binding]
type = bindtoroot
trigger1 = 1
trigger1 = parent,facing=1
time = 1
facing = 0
pos = 7,ifelse(name="Taeko",-110,ifelse(name="Nadia",-110,ifelse(name="Zppr",-80,ifelse(name="Yoko",-110,ifelse(name="Tsukiko",-110,ifelse(name="Sofie",-40,ifelse(name="Lil' Slugger",-100,ifelse(name="Oliver",-80,ifelse(name="Natalia",-110,ifelse(name="M.C. Supercut",-90,ifelse(name="Charlotte",-110,-110 ) ) ) ) ) ) ) ) ) ))

[state 0, 1000+ binding]
type = bindtoroot
trigger1 = 1
trigger1 = parent,facing=-1
time = 1
facing = 0
pos = 0,ifelse(name="Taeko",-110,ifelse(name="Nadia",-110,ifelse(name="Zppr",-80,ifelse(name="Yoko",-110,ifelse(name="Tsukiko",-110,ifelse(name="Sofie",-40,ifelse(name="Lil' Slugger",-100,ifelse(name="Oliver",-80,ifelse(name="Natalia",-110,ifelse(name="M.C. Supercut",-90,ifelse(name="Charlotte",-110,-110 ) ) ) ) ) ) ) ) ) ))

[State 0, single digit reset 0]
type = ChangeAnim
trigger1 = 1
value = 40000
elem = parent,var(2)
ignorehitpause = 1
persistent = 1

;---------------------------------------------
;BONUS COUNTER--------------------
[Statedef 275001]
type = S
movetype = I
physics = S
ctrl = 0
velset = 0,0
sprpriority = 7
anim = 270000

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 0, PalFXWiz]
type = PalFX
trigger1 = time%2
time = 3
add = 0,50,180
mul = 256,256,256
sinadd = 56,56,56,3
invertall = 0
color = 0
;ignorehitpause = 0
;persistent = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
;trigger1 = parent,var(26)=0
;trigger2 = enemynear,movetype != H
flag = invisible
ignorehitpause=1

[State 0, BindToParent]
type = bindtoparent
trigger1 = 1
trigger1 = parent,facing=1
time = 1
facing = 0
pos = 7,ifelse(name="Taeko",-96,ifelse(name="Nadia",-96,ifelse(name="Zppr",-66,ifelse(name="Yoko",-96,ifelse(name="Tsukiko",-96,ifelse(name="Sofie",-66,ifelse(name="Lil' Slugger",-86,ifelse(name="Oliver",-66,ifelse(name="Natalia",-96,ifelse(name="M.C. Supercut",-76,ifelse(name="Charlotte",-96,-96 ) ) ) ) ) ) ) ) ) ))

[State 0, BindToParent]
type = bindtoparent
trigger1 = 1
trigger1 = parent,facing=-1
time = 1
facing = 0
pos = 0,ifelse(name="Taeko",-96,ifelse(name="Nadia",-96,ifelse(name="Zppr",-66,ifelse(name="Yoko",-96,ifelse(name="Tsukiko",-96,ifelse(name="Sofie",-66,ifelse(name="Lil' Slugger",-86,ifelse(name="Oliver",-66,ifelse(name="Natalia",-96,ifelse(name="M.C. Supercut",-76,ifelse(name="Charlotte",-96,-96 ) ) ) ) ) ) ) ) ) ))

[State 0, single digit reset 0]
type = ChangeAnim
trigger1 = 1
value = 40000
elem = -(parent,var(26))
ignorehitpause = 1
persistent = 1

;==============================================================================
; Overdrive Helper
[Statedef 275010]
type = S

[state -1,invisible]
type = assertspecial
trigger1 = 1
flag = invisible
ignorehitpause = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[state -2, power meter p1]
type = Explod
triggerall = root,var(27)=1
trigger1 = numexplod(30)=0
trigger1 = root,teamside=1
anim = 290002
ID = 30
pos = 38, 24
postype =left
facing = 1
vfacing = 1
bindtime = -1
scale = 0.25,0.25
sprpriority =5
removetime=-1

[state -2, power meter p2]
type = Explod
triggerall = root,var(27)=1
trigger1 = numexplod(30)=0
trigger1 = root,teamside=2
anim = 290002
ID = 30
pos = -36, 24
postype =right
facing = -1
vfacing = 1
bindtime = -1
scale = 0.25,0.25
sprpriority =5
removetime=-1

[state -2, powerbar scaling]
type = modifyexplod
triggerall = root,var(27)=1
trigger1 = numexplod(30)=1
ID=30
scale =0.25*((root,fvar(8)-100)/100),0.25

[state -2, powerbar minimum]
type = parentvarset
trigger1 = parent,fvar(8)<100
fvar(8)=100

[state -2, powerbar maximum]
type = parentvarset
trigger1 = parent,fvar(8)>200
fvar(8)=200

; [State -2, speed power drain]
; type=poweradd
; triggerall=parent,var(11)=1
; trigger1=parent,time%1=0
; value=-9

[state -2, powerbar set]
type = parentvarset
trigger1 = power=0
var(11)=0

[state -2, powerbar set]
type = parentvarset
trigger1 = roundstate = 0 && roundno = 1
fvar(8) = 100

[state -2, powerbar add]
type = parentvaradd
triggerall = parent,fvar(8) < 200
triggerall = parent,stateno != [12300,12399]
triggerall = parent,stateno != [3500,3504]
triggerall = (parent,name = "oliver" && parent,var(27) = 1 && parent,var(9) = 0) || parent,name != "Oliver"
trigger1 = p2stateno = [5000,5210]
trigger1 = enemy,movetype = H
trigger1 = enemy,time = 1
fvar(8) = ((0.03*(enemy,GetHitVar(HitShakeTime)))*enemy,gethitvar(hitcount));0.5
ignorehitpause = 1
persistent = 1

;---------------------------------------------------
;Alignment Basics
[statedef 276000]
type=S
movetype=I
physics=N

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
time = 999999

[state -1,invisible]
type = assertspecial
trigger1 = 1
flag = invisible
ignorehitpause = 1

[state -2, light power limiter]
type = PowerSet
trigger1 = parent,var(27)=0
trigger1 = parent,power>2000
value = 2000

[state -2, dark power limiter]
type = PowerSet
trigger1 = parent,var(27)=1
trigger1 = parent,power>3000
value = 3000

[state -2, yyang power limiter]
type = PowerSet
trigger1 = parent,var(27)=3
trigger1 = parent,power>1000
value = 1000

[state -2, remove dawn icon]
type = removeexplod
trigger1 = roundstate=2
id = 300001

[state -2, remove midnight icon]
type = removeexplod
trigger1 = roundstate=2
id = 300000

[state -2, remove twilight icon]
type = removeexplod
trigger1 = roundstate=2
id = 300002

[state -2, remove doom icon]
type = removeexplod
trigger1 = roundstate=2
id = 300003

[state -2, remove dawn icon]
type = removeexplod
trigger1 = roundstate=2
id = 300011

[state -2, remove midnight icon]
type = removeexplod
trigger1 = roundstate=2
id = 300010

[state -2, remove twilight icon]
type = removeexplod
trigger1 = roundstate=2
id = 300012

[state -2, remove doom icon]
type = removeexplod
trigger1 = roundstate=2
id = 300013

[state -2, remove soul subt]
type = removeexplod
trigger1 = stateno!=191
id = 300023

[state -2, remove timer]
type = removeexplod
trigger1 = stateno!=191
id = 300100

;----------------------------------------------------
;Power Level
[Statedef 280001]
type = S
movetype = I
physics = S
ctrl = 0
velset = 0,0
sprpriority = 7
;anim = 270000

[state -1,invisible]
type = assertspecial
trigger1 = 1
flag = invisible
ignorehitpause = 1

;==============================================================================
; Scaling + Bonus
[statedef 292000]
type = S
movetype = I
physics = N

[State 0, VarSet]
type = VarSet
trigger1 = 1
v = 3
value = parent,var(3)
ignorehitpause = 1
;persistent =

;============================================================================

[State 0, parry reset]
type = parentvarset
trigger1 = parent,stateno=0
trigger2 = parent,movetype=H
trigger3 = parent,movetype=A
v = 18
value = 0

;[state 0, damage scaling change]
;type = parentvarset
;trigger1 = parent,movehit = 1
;fvar(13)=fvar(13)*0.92
;persistent = 0

;;Damage Scaling
;
;[State -2, normal scaling 100]
;type= parentvarset
;trigger1 = enemynear, gethitvar(hitcount) = 0
;;trigger1= numenemy
;trigger1= parent,stateno != [3000,3999]
;trigger1= parent,stateno != [30000,39999]
;trigger1= parent,stateno != [300000,399999]
;;trigger2= parent,stateno = [12300,12400]
;fv=13
;value= 1.00
;ignorehitpause= 1
;
;[State -2, normal scaling 90]
;type= parentvarset
;triggerall = enemynear, gethitvar(hitcount) = 1
;;trigger1= numenemy
;trigger1= parent,stateno != [3000,3999]
;trigger1= parent,stateno != [30000,39999]
;trigger1= parent,stateno != [300000,399999]
;trigger1= parent,stateno != [12300,12400]
;fv=13
;value= 1.00;0.90
;ignorehitpause= 1
;
;[State -2, normal scaling 80]
;type= parentvarset
;triggerall = enemynear, gethitvar(hitcount) = 2
;;trigger1= numenemy
;trigger1= parent,stateno != [3000,3999]
;trigger1= parent,stateno != [30000,39999]
;trigger1= parent,stateno != [300000,399999]
;trigger1= parent,stateno != [12300,12400]
;fv=13
;value= 0.95;0.80
;ignorehitpause= 1
;
;[State -2, normal scaling 70]
;type= parentvarset
;triggerall = enemynear, gethitvar(hitcount) = 3
;;trigger1= numenemy
;trigger1= parent,stateno != [3000,3999]
;trigger1= parent,stateno != [30000,39999]
;trigger1= parent,stateno != [300000,399999]
;trigger1= parent,stateno != [12300,12400]
;fv=13
;value= 0.90;0.60
;ignorehitpause= 1
;
;[State -2, normal scaling 60]
;type= parentvarset
;triggerall = enemynear, gethitvar(hitcount) = 4
;;trigger1= numenemy
;trigger1= parent,stateno != [3000,3999]
;trigger1= parent,stateno != [30000,39999]
;trigger1= parent,stateno != [300000,399999]
;trigger1= parent,stateno != [12300,12400]
;fv=13
;value= 0.80;0.40
;ignorehitpause= 1
;
;[State -2, normal scaling 50]
;type= parentvarset
;triggerall = enemynear, gethitvar(hitcount) = 5
;;trigger1= numenemy
;trigger1= parent,stateno != [3000,3999]
;trigger1= parent,stateno != [30000,39999]
;trigger1= parent,stateno != [300000,399999]
;trigger1= parent,stateno != [12300,12400]
;fv=13
;value= 0.70;0.25
;ignorehitpause= 1
;
;[State -2, normal scaling 40]
;type= parentvarset
;triggerall = enemynear, gethitvar(hitcount) >= 6
;;trigger1= numenemy
;trigger1= parent,stateno != [3000,3999]
;trigger1= parent,stateno != [30000,39999]
;trigger1= parent,stateno != [300000,399999]
;trigger1= parent,stateno != [12300,12400]
;fv=13
;value= 0.60;0.25
;ignorehitpause= 1
;
;;============================================================
;;============================================================
;
;[State -2, scaling reset]
;type= parentvarset
;;trigger1= numenemy
;trigger1= enemynear,movetype!=H || (enemynear,stateno=[120,155])
;;trigger2= parent,stateno = [12300,12400]
;fv=13
;value= 1.00
;ignorehitpause= 1
;
;[State -2, super scaling 3-9 hits]
;type= parentvarset
;;triggerall= numenemy
;triggerall= enemynear, gethitvar(hitcount) = [1,9]
;trigger1= parent,stateno = [3000,3999]
;trigger2= parent,stateno = [30000,39999]
;trigger3= parent,stateno = [300000,399999]
;trigger4= parent,stateno = [12300,12400]
;fv=13
;value= 1.00
;ignorehitpause= 1
;
;[State -2, super scaling 10-19 hits]
;type= parentvarset
;;triggerall= numenemy
;triggerall= enemynear, gethitvar(hitcount) = [10,19]
;trigger1= parent,stateno = [3000,3999]
;trigger2= parent,stateno = [30000,39999]
;trigger3= parent,stateno = [300000,399999]
;trigger4= parent,stateno = [12300,12400]
;fv=13
;value= 0.95
;ignorehitpause= 1
;
;[State -2, super scaling 20-29 hits]
;type= parentvarset
;;triggerall= numenemy
;triggerall= enemynear, gethitvar(hitcount) = [20,29]
;trigger1= parent,stateno = [3000,3999]
;trigger2= parent,stateno = [30000,39999]
;trigger3= parent,stateno = [300000,399999]
;trigger4= parent,stateno = [12300,12400]
;fv=13
;value= 0.90
;ignorehitpause= 1
;
;[State -2, super scaling 30+ hits]
;type= parentvarset
;;triggerall= numenemy
;triggerall= enemynear, gethitvar(hitcount) >= 30
;trigger1= parent,stateno = [3000,3999]
;trigger2= parent,stateno = [30000,39999]
;trigger3= parent,stateno = [300000,399999]
;trigger4= parent,stateno = [12300,12400]
;fv=13
;value= 0.85
;ignorehitpause= 1

[state -1,invisible]
type = assertspecial
trigger1 = 1
flag = invisible
ignorehitpause = 1

; ====================
; ===== STANDARD =====
; ====================

[state -2, combo bonus damage <10]
type = parentvarset
trigger1 = enemy,var(27)!=1
trigger1 = parent,gethitvar(hitcount)=[0,9]
var(25) = 0

[state -2, combo bonus damage 10,12]
type = parentvarset
trigger1 = enemy,var(27)!=1
trigger1 = parent,gethitvar(hitcount)=[10,12]
var(25) = -10

[state -2, combo bonus damage 13,16]
type = parentvarset
trigger1 = enemy,var(27)!=1
trigger1 = parent,gethitvar(hitcount)=[13,16]
var(25) = -20

[state -2, combo bonus damage 17,22]
type = parentvarset
trigger1 = enemy,var(27)!=1
trigger1 = parent,gethitvar(hitcount)=[17,22]
var(25) = -30

[state -2, combo bonus damage 23,28]
type = parentvarset
trigger1 = enemy,var(27)!=1
trigger1 = parent,gethitvar(hitcount)=[23,28]
var(25) = -40

[state -2, combo bonus damage 29,39]
type = parentvarset
trigger1 = enemy,var(27)!=1
trigger1 = parent,gethitvar(hitcount)=[29,39]
var(25) = -50

[state -2, combo bonus damage 40,55]
type = parentvarset
trigger1 = enemy,var(27)!=1
trigger1 = parent,gethitvar(hitcount)=[40,55]
var(25) = -60

[state -2, combo bonus damage 56+]
type = parentvarset
trigger1 = enemy,var(27)!=1
trigger1 = parent,gethitvar(hitcount)=[56,999999]
var(25) = -70

; ==================
; ===== BINARY =====
; ==================

[state -2, combo bonus damage 3-]
type = parentvarset
trigger1 = enemy,var(27)=1
trigger1 = parent,gethitvar(hitcount)<3
;trigger2 = parent,movetype!=H
var(25) = 0

[state -2, combo bonus damage 3,5]
type = parentvarset
trigger1 = enemy,var(27)=1
trigger1 = parent,gethitvar(hitcount)=[3,5]
var(25) = ceil(-10 * parent,fvar(6))

[state -2, combo bonus damage 6,9]
type = parentvarset
trigger1 = enemy,var(27)=1
trigger1 = parent,gethitvar(hitcount)=[6,9]
var(25) = ceil(-20 * parent,fvar(6))

[state -2, combo bonus damage 10,12]
type = parentvarset
trigger1 = enemy,var(27)=1
trigger1 = parent,gethitvar(hitcount)=[10,12]
var(25) = ceil(-30 * parent,fvar(6))

[state -2, combo bonus damage 13,16]
type = parentvarset
trigger1 = enemy,var(27)=1
trigger1 = parent,gethitvar(hitcount)=[13,16]
var(25) = ceil(-40 * parent,fvar(6))

[state -2, combo bonus damage 17,22]
type = parentvarset
trigger1 = enemy,var(27)=1
trigger1 = parent,gethitvar(hitcount)=[17,22]
var(25) = ceil(-50 * parent,fvar(6))

[state -2, combo bonus damage 23,28]
type = parentvarset
trigger1 = enemy,var(27)=1
trigger1 = parent,gethitvar(hitcount)=[23,28]
var(25) = ceil(-60 * parent,fvar(6))

[state -2, combo bonus damage 29,39]
type = parentvarset
trigger1 = enemy,var(27)=1
trigger1 = parent,gethitvar(hitcount)=[29,39]
var(25) = ceil(-70 * parent,fvar(6))

[state -2, combo bonus damage 40,55]
type = parentvarset
trigger1 = enemy,var(27)=1
trigger1 = parent,gethitvar(hitcount)=[40,55]
var(25) = ceil(-80 * parent,fvar(6))

[state -2, combo bonus damage 56+]
type = parentvarset
trigger1 = enemy,var(27)=1
trigger1 = parent,gethitvar(hitcount)=[56,999999]
var(25) = ceil(-90 * parent,fvar(6))

;==================================================================
;Combo Sound
;==================================================================

;[State -3, Yes Sound]
;type = PlaySnd
;;trigger1 = var(52) = 3
;;trigger1 = Parent, MoveType != H ;&& var(52) > 0
;;trigger1 = (TeamMode = Single) || (TeamMode = Turns)
;trigger1 = enemynear, gethitvar(hitcount) = 3
;value = F25, 0
;abspan = 0
;volume = 999

;[State -3, Yes Notify]
;trigger1 = var(52) = 3
;trigger1 = Parent, MoveType != H && var(52) > 0
;trigger1 = (TeamMode = Single) || (TeamMode = Turns)
;trigger1 = var(26) < 1
;type = Explod
;ownpal = 1
;anim = F800 + ifelse(TeamSide = 1, 20, 0)
;scale = .5,.5
;postype = left
;pos = ifelse(TeamSide = 1, 310, 10), 83
;ontop = 1
;bindtime = -1
;
;[State -3, Good Sound]
;type = PlaySnd
;trigger1 = var(52) = [4,5]
;trigger1 = Parent, MoveType != H && var(52) > 0
;trigger1 = (TeamMode = Single) || (TeamMode = Turns)
;trigger1 = var(26) < 1
;value = F25, 1
;abspan = 0
;volume = 999
;
;[State -3, Good Notify]
;trigger1 = var(52) = [4,5]
;trigger1 = Parent, MoveType != H && var(52) > 0
;trigger1 = (TeamMode = Single) || (TeamMode = Turns)
;trigger1 = var(26) < 1
;type = Explod
;ownpal = 1
;anim = F801 + ifelse(TeamSide = 1, 20, 0)
;scale = .5,.5
;postype = left
;pos = ifelse(TeamSide = 1, 310, 10), 83
;ontop = 1
;bindtime = -1
;
;[State -3, Great Sound]
;type = PlaySnd
;trigger1 = var(52) = [6,7]
;trigger1 = Parent, MoveType != H && var(52) > 0
;trigger1 = (TeamMode = Single) || (TeamMode = Turns)
;trigger1 = var(26) < 1
;value = F25, 2
;abspan = 0
;volume = 999
;
;[State -3, Great Notify]
;trigger1 = var(52) = [6,7]
;trigger1 = Parent, MoveType != H && var(52) > 0
;trigger1 = (TeamMode = Single) || (TeamMode = Turns)
;trigger1 = var(26) < 1
;type = Explod
;ownpal = 1
;anim = F802 + ifelse(TeamSide = 1, 20, 0)
;scale = .5,.5
;postype = left
;pos = ifelse(TeamSide = 1, 310, 10), 83
;ontop = 1
;bindtime = -1
;
;[State -3, VGood Sound]
;type = PlaySnd
;trigger1 = var(52) = [8,9]
;trigger1 = Parent, MoveType != H && var(52) > 0
;trigger1 = (TeamMode = Single) || (TeamMode = Turns)
;trigger1 = var(26) < 1
;value = F25, 3
;abspan = 0
;volume = 999
;
;[State -3, VGood Notify]
;trigger1 = var(52) = [8,9]
;trigger1 = Parent, MoveType != H && var(52) > 0
;trigger1 = (TeamMode = Single) || (TeamMode = Turns)
;trigger1 = var(26) < 1
;type = Explod
;ownpal = 1
;anim = F803 + ifelse(TeamSide = 1, 20, 0)
;scale = .5,.5
;postype = left
;pos = ifelse(TeamSide = 1, 310, 10), 83
;ontop = 1
;bindtime = -1
;
;[State -3, Wonderful Sound]
;type = PlaySnd
;trigger1 = var(52) = [10,29]
;trigger1 = Parent, MoveType != H && var(52) > 0
;trigger1 = (TeamMode = Single) || (TeamMode = Turns)
;trigger1 = var(26) < 1
;value = F25, 4
;abspan = 0
;volume = 999
;
;[State -3, Wonderful Notify]
;trigger1 = var(52) = [10,29]
;trigger1 = Parent, MoveType != H && var(52) > 0
;trigger1 = (TeamMode = Single) || (TeamMode = Turns)
;trigger1 = var(26) < 1
;type = Explod
;ownpal = 1
;anim = F804 + ifelse(TeamSide = 1, 20, 0)
;scale = .5,.5
;postype = left
;pos = ifelse(TeamSide = 1, 310, 10), 83
;ontop = 1
;bindtime = -1
;
;[State -3, Fantastic Sound]
;type = PlaySnd
;trigger1 = var(52) = [30,49]
;trigger1 = Parent, MoveType != H && var(52) > 0
;trigger1 = (TeamMode = Single) || (TeamMode = Turns)
;trigger1 = var(26) < 1
;value = F25, 5
;abspan = 0
;volume = 999
;
;[State -3, Fantastic Notify]
;trigger1 = var(52) = [30,49]
;trigger1 = Parent, MoveType != H && var(52) > 0
;trigger1 = (TeamMode = Single) || (TeamMode = Turns)
;trigger1 = var(26) < 1
;type = Explod
;ownpal = 1
;anim = F805 + ifelse(TeamSide = 1, 20, 0)
;scale = .5,.5
;postype = left
;pos = ifelse(TeamSide = 1, 310, 10), 83
;ontop = 1
;bindtime = -1
;
;[State -3, Monster Sound]
;type = PlaySnd
;trigger1 = var(52) = [50,99]
;trigger1 = Parent, MoveType != H && var(52) > 0
;trigger1 = (TeamMode = Single) || (TeamMode = Turns)
;trigger1 = var(26) < 1
;value = F25, 6
;abspan = 0
;volume = 999
;
;[State -3, Monster Notify]
;trigger1 = var(52) = [50,79]
;trigger1 = Parent, MoveType != H && var(52) > 0
;trigger1 = (TeamMode = Single) || (TeamMode = Turns)
;trigger1 = var(26) < 1
;type = Explod
;ownpal = 1
;anim = F806 + ifelse(TeamSide = 1, 20, 0)
;scale = .5,.5
;postype = left
;pos = ifelse(TeamSide = 1, 310, 10), 83
;ontop = 1
;bindtime = -1
;
;[State -3, Ultra Sound]
;type = PlaySnd
;trigger1 = var(52) = 80
;trigger1 = Parent, MoveType != H && var(52) > 0
;trigger1 = (TeamMode = Single) || (TeamMode = Turns)
;trigger1 = var(26) < 1
;value = F80, 0
;abspan = 0
;volume = 999
;
;[State -3, Ultra Notify]
;trigger1 = var(52) = 80
;trigger1 = Parent, MoveType != H && var(52) > 0
;trigger1 = (TeamMode = Single) || (TeamMode = Turns)
;trigger1 = var(26) < 1
;type = Explod
;ownpal = 1
;anim = F860 + ifelse(TeamSide = 1, 20, 0)
;scale = .5,.5
;postype = left
;pos = ifelse(TeamSide = 1, 310, 10), 83
;ontop = 1
;bindtime = -1
;
;[State -3, Marvelous Sound]
;type = PlaySnd
;trigger1 = var(52) > 81
;trigger1 = Parent, MoveType != H && var(52) > 0
;trigger1 = var(26) < 1
;trigger1 = (TeamMode = Single) || (TeamMode = Turns)
;value = F25, 7
;abspan = 0
;volume = 999
;
;[State -3, Marvelous Notify]
;trigger1 = var(52) > 81
;trigger1 = Parent, MoveType != H && var(52) > 0
;trigger1 = (TeamMode = Single) || (TeamMode = Turns)
;trigger1 = var(26) < 1
;type = Explod
;ownpal = 1
;anim = F807 + ifelse(TeamSide = 1, 20, 0)
;scale = .5,.5
;postype = left
;pos = ifelse(TeamSide = 1, 310, 10), 83
;ontop = 1
;bindtime = -1
;;==========================================================
;
;[State -3: Reset Stuff]
;type = VarSet
;trigger1 = Parent, MoveType != H
;trigger2 = Parent, StateNo = [120, 155]
;var(52) = (var(21) := (var(22) := (var(23) := (var(24) := (var(26) := 0)))))
;ignorehitpause = 1

;==================================================================
;Parry reset
;==================================================================

;[State 0, VarAdd]
;type = VarAdd
;trigger1 = parent,stateno != [11070,11071] 
;v = 1
;value = 1
;ignorehitpause = 1
;persistent = 1
;
;[State 0, VarSet]
;type = VarSet
;trigger1 = parent,stateno = [11070,11071]
;v = 1 
;value = 0
;ignorehitpause = 1
;persistent = 1

;[State 0, ParentVarSet]
;type = ParentVarSet
;trigger1 = parent,stateno != [11070,11071]
;;trigger1 = var(1)>=30
;v = 8
;value = 0
;ignorehitpause = 1
;persistent = 1



[State 1338: Invisibo]
type = AssertSpecial
trigger1 = 1
flag = invisible
ignorehitpause = 1

[State 1338: Invincibo]
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause = 1

;==============================================================================
; Power Meter Helper
[Statedef 294000]
type = S
movetype = I
physics = N

[state -1,invisible]
type = assertspecial
trigger1 = 1
flag = invisible
ignorehitpause = 1

[state -1, life disable]
type=ctrlset
trigger1 = parent,life=0 && p2life=0
trigger2 = roundstate = 4
value=0

[state -1, life disable]
type=varset
trigger1 = parent,life=0 && p2life=0
trigger2 = roundstate = 4
var(15)=0

[state -2, projectile destruction variable reset]
type = varset
trigger1 = parent,stateno != 10202
var(58)=0

[state -2, power meter p1]
type = Explod
trigger1 = numexplod(27)=0
trigger1 = parent,teamside=1
anim = 290000
ID = 27
pos = 104, 21
postype =left
facing = 1
vfacing = 1
bindtime = -1
scale = 0.25,0.25
sprpriority =999
removetime=-1

[state -2, power meter p2]
type = Explod
trigger1 = numexplod(27)=0
trigger1 = parent,teamside=2
anim = 290000
ID = 27
pos = -141, 21
postype =right
facing = 1
vfacing = 1
bindtime = -1
scale = 0.25,0.25
sprpriority =999
removetime=-1

[state -2, base range set]
type = varset
trigger1 = parent,power<=1000
fv=2
value = 0.25*(0.001*(parent,power))

[state -2, 1000 range set]
type = varset
trigger1 = parent,power=[1001,2000]
fv=2
value = 0.25*(0.001*(parent,power-1000))

[state -2, 2000 range set]
type = varset
trigger1 = parent,power=[2001,3000]
fv=2
value = 0.25*(0.001*(parent,power-2000))

[state -2, 3000 range set]
type = varset
trigger1 = parent,power=[3001,4000]
fv=2
value = 0.25*(0.001*(parent,power-3000))

[state -2, 4000 range set]
type = varset
trigger1 = parent,power=[4001,5000]
fv=2
value = 0.25*(0.001*(parent,power-4000))

[state -2, powerbar scaling]
type = modifyexplod
trigger1 = numexplod(27)=1
ID=27
scale = fvar(2),0.25

;==============================================================================
; Guard Meter Helper
[Statedef 294010]
type = S
movetype = I
physics = N
anim=270000

;=============================
;pallette effect

[State -3, 90 percent]
type = PalFX
triggerall = (parent,GetHitVar(HitShakeTime) > 0)
trigger1 = (parent,StateNo = 150) || (parent,StateNo = 152)
trigger1 = fvar(0)=[90,99]
time = 5
add = 250,250,250
mul = 150,150,150
sinadd = 0,0,0,0
invertall = 0
color = 255

[State -3, 80 percent]
type = PalFX
triggerall = (parent,GetHitVar(HitShakeTime) > 0)
trigger1 = (parent,StateNo = 150) || (parent,StateNo = 152)
trigger1 = fvar(0)=[80,89]
time = 5
add = 250,220,220
mul = 150,150,150
sinadd = 0,0,0,0
invertall = 0
color = 255

[State -3, 70 percent]
type = PalFX
triggerall = (parent,GetHitVar(HitShakeTime) > 0)
trigger1 = (parent,StateNo = 150) || (parent,StateNo = 152)
trigger1 = fvar(0)=[70,79]
time = 5
add = 250,190,190
mul = 150,150,150
sinadd = 0,0,0,0
invertall = 0
color = 255

[State -3, 60 percent]
type = PalFX
triggerall = (parent,GetHitVar(HitShakeTime) > 0)
trigger1 = (parent,StateNo = 150) || (parent,StateNo = 152)
trigger1 = fvar(0)=[60,69]
time = 5
add = 250,160,160
mul = 150,150,150
sinadd = 0,0,0,0
invertall = 0
color = 255

[State -3, 50 percent]
type = PalFX
triggerall = (parent,GetHitVar(HitShakeTime) > 0)
trigger1 = (parent,StateNo = 150) || (parent,StateNo = 152)
trigger1 = fvar(0)=[50,59]
time = 5
add = 250,130,130
mul = 150,150,150
sinadd = 0,0,0,0
invertall = 0
color = 255

[State -3, 40 percent]
type = PalFX
triggerall = (parent,GetHitVar(HitShakeTime) > 0)
trigger1 = (parent,StateNo = 150) || (parent,StateNo = 152)
trigger1 = fvar(0)=[40,49]
time = 5
add = 250,110,110
mul = 150,150,150
sinadd = 0,0,0,0
invertall = 0
color = 255

[State -3, 30 percent]
type = PalFX
triggerall = (parent,GetHitVar(HitShakeTime) > 0)
trigger1 = (parent,StateNo = 150) || (parent,StateNo = 152)
trigger1 = fvar(0)=[30,39]
time = 5
add = 250, 80, 80
mul = 150,150,150
sinadd = 0,0,0,0
invertall = 0
color = 255

[State -3, 20 percent]
type = PalFX
triggerall = (parent,GetHitVar(HitShakeTime) > 0)
trigger1 = (parent,StateNo = 150) || (parent,StateNo = 152)
trigger1 = fvar(0)=[20,29]
time = 5
add = 250, 55, 55
mul = 150,150,150
sinadd = 0,0,0,0
invertall = 0
color = 255

[State -3, 10 percent]
type = PalFX
triggerall = (parent,GetHitVar(HitShakeTime) > 0)
trigger1 = (parent,StateNo = 150) || (parent,StateNo = 152)
trigger1 = fvar(0)=[10,19]
time = 5
add = 250, 30, 30
mul = 150,150,150
sinadd = 0,0,0,0
invertall = 0
color = 255

[State -3, 0 percent]
type = PalFX
triggerall = (parent,GetHitVar(HitShakeTime) > 0)
trigger1 = (parent,StateNo = 150) || (parent,StateNo = 152)
trigger1 = fvar(0)=[1,9]
time = 5
add = 250,  0,  0
mul = 150,150,150
sinadd = 0,0,0,0
invertall = 0
color = 255

;==========================================================================
;Combo Count
[Statedef 295000]
type = S
movetype = I
physics = N

[State 1338: Invisibo]
type = AssertSpecial
trigger1 = 1
flag = invisible
ignorehitpause = 1

[State 1338: Invincibo]
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause = 1

[State -3, Yes Sound]
type = PlaySnd
trigger1 = var(52) = 3
trigger1 = Parent, MoveType != H && var(52) > 0
trigger1 = (TeamMode = Single) || (TeamMode = Turns)
trigger1 = var(26) < 1
value = F25, 0
abspan = 0
volume = 999

[State -3, Yes Notify]
trigger1 = var(52) = 3
trigger1 = Parent, MoveType != H && var(52) > 0
trigger1 = (TeamMode = Single) || (TeamMode = Turns)
trigger1 = var(26) < 1
type = Explod
ownpal = 1
anim = F800 + ifelse(TeamSide = 1, 20, 0)
scale = .5,.5
postype = left
pos = ifelse(TeamSide = 1, 310, 10), 83
ontop = 1
bindtime = -1

[State -3, Good Sound]
type = PlaySnd
trigger1 = var(52) = [4,5]
trigger1 = Parent, MoveType != H && var(52) > 0
trigger1 = (TeamMode = Single) || (TeamMode = Turns)
trigger1 = var(26) < 1
value = F25, 1
abspan = 0
volume = 999

[State -3, Good Notify]
trigger1 = var(52) = [4,5]
trigger1 = Parent, MoveType != H && var(52) > 0
trigger1 = (TeamMode = Single) || (TeamMode = Turns)
trigger1 = var(26) < 1
type = Explod
ownpal = 1
anim = F801 + ifelse(TeamSide = 1, 20, 0)
scale = .5,.5
postype = left
pos = ifelse(TeamSide = 1, 310, 10), 83
ontop = 1
bindtime = -1

[State -3, Great Sound]
type = PlaySnd
trigger1 = var(52) = [6,7]
trigger1 = Parent, MoveType != H && var(52) > 0
trigger1 = (TeamMode = Single) || (TeamMode = Turns)
trigger1 = var(26) < 1
value = F25, 2
abspan = 0
volume = 999

[State -3, Great Notify]
trigger1 = var(52) = [6,7]
trigger1 = Parent, MoveType != H && var(52) > 0
trigger1 = (TeamMode = Single) || (TeamMode = Turns)
trigger1 = var(26) < 1
type = Explod
ownpal = 1
anim = F802 + ifelse(TeamSide = 1, 20, 0)
scale = .5,.5
postype = left
pos = ifelse(TeamSide = 1, 310, 10), 83
ontop = 1
bindtime = -1

[State -3, VGood Sound]
type = PlaySnd
trigger1 = var(52) = [8,9]
trigger1 = Parent, MoveType != H && var(52) > 0
trigger1 = (TeamMode = Single) || (TeamMode = Turns)
trigger1 = var(26) < 1
value = F25, 3
abspan = 0
volume = 999

[State -3, VGood Notify]
trigger1 = var(52) = [8,9]
trigger1 = Parent, MoveType != H && var(52) > 0
trigger1 = (TeamMode = Single) || (TeamMode = Turns)
trigger1 = var(26) < 1
type = Explod
ownpal = 1
anim = F803 + ifelse(TeamSide = 1, 20, 0)
scale = .5,.5
postype = left
pos = ifelse(TeamSide = 1, 310, 10), 83
ontop = 1
bindtime = -1

[State -3, Wonderful Sound]
type = PlaySnd
trigger1 = var(52) = [10,29]
trigger1 = Parent, MoveType != H && var(52) > 0
trigger1 = (TeamMode = Single) || (TeamMode = Turns)
trigger1 = var(26) < 1
value = F25, 4
abspan = 0
volume = 999

[State -3, Wonderful Notify]
trigger1 = var(52) = [10,29]
trigger1 = Parent, MoveType != H && var(52) > 0
trigger1 = (TeamMode = Single) || (TeamMode = Turns)
trigger1 = var(26) < 1
type = Explod
ownpal = 1
anim = F804 + ifelse(TeamSide = 1, 20, 0)
scale = .5,.5
postype = left
pos = ifelse(TeamSide = 1, 310, 10), 83
ontop = 1
bindtime = -1

[State -3, Fantastic Sound]
type = PlaySnd
trigger1 = var(52) = [30,49]
trigger1 = Parent, MoveType != H && var(52) > 0
trigger1 = (TeamMode = Single) || (TeamMode = Turns)
trigger1 = var(26) < 1
value = F25, 5
abspan = 0
volume = 999

[State -3, Fantastic Notify]
trigger1 = var(52) = [30,49]
trigger1 = Parent, MoveType != H && var(52) > 0
trigger1 = (TeamMode = Single) || (TeamMode = Turns)
trigger1 = var(26) < 1
type = Explod
ownpal = 1
anim = F805 + ifelse(TeamSide = 1, 20, 0)
scale = .5,.5
postype = left
pos = ifelse(TeamSide = 1, 310, 10), 83
ontop = 1
bindtime = -1

[State -3, Monster Sound]
type = PlaySnd
trigger1 = var(52) = [50,99]
trigger1 = Parent, MoveType != H && var(52) > 0
trigger1 = (TeamMode = Single) || (TeamMode = Turns)
trigger1 = var(26) < 1
value = F25, 6
abspan = 0
volume = 999

[State -3, Monster Notify]
trigger1 = var(52) = [50,79]
trigger1 = Parent, MoveType != H && var(52) > 0
trigger1 = (TeamMode = Single) || (TeamMode = Turns)
trigger1 = var(26) < 1
type = Explod
ownpal = 1
anim = F806 + ifelse(TeamSide = 1, 20, 0)
scale = .5,.5
postype = left
pos = ifelse(TeamSide = 1, 310, 10), 83
ontop = 1
bindtime = -1

[State -3, Ultra Sound]
type = PlaySnd
trigger1 = var(52) = 80
trigger1 = Parent, MoveType != H && var(52) > 0
trigger1 = (TeamMode = Single) || (TeamMode = Turns)
trigger1 = var(26) < 1
value = F80, 0
abspan = 0
volume = 999

[State -3, Ultra Notify]
trigger1 = var(52) = 80
trigger1 = Parent, MoveType != H && var(52) > 0
trigger1 = (TeamMode = Single) || (TeamMode = Turns)
trigger1 = var(26) < 1
type = Explod
ownpal = 1
anim = F860 + ifelse(TeamSide = 1, 20, 0)
scale = .5,.5
postype = left
pos = ifelse(TeamSide = 1, 310, 10), 83
ontop = 1
bindtime = -1

[State -3, Marvelous Sound]
type = PlaySnd
trigger1 = var(52) > 81
trigger1 = Parent, MoveType != H && var(52) > 0
trigger1 = var(26) < 1
trigger1 = (TeamMode = Single) || (TeamMode = Turns)
value = F25, 7
abspan = 0
volume = 999

[State -3, Marvelous Notify]
trigger1 = var(52) > 81
trigger1 = Parent, MoveType != H && var(52) > 0
trigger1 = (TeamMode = Single) || (TeamMode = Turns)
trigger1 = var(26) < 1
type = Explod
ownpal = 1
anim = F807 + ifelse(TeamSide = 1, 20, 0)
scale = .5,.5
postype = left
pos = ifelse(TeamSide = 1, 310, 10), 83
ontop = 1
bindtime = -1
;==========================================================

[State -3: Reset Stuff]
type = VarSet
trigger1 = Parent, MoveType != H
trigger2 = Parent, StateNo = [120, 155]
var(52) = (var(21) := (var(22) := (var(23) := (var(24) := (var(26) := 0)))))
ignorehitpause = 1

;======================================
; Counter Code
;======================================
[State Counter: Counter an Attack]
type = Null;Helper
trigger1 = Parent, HitDefAttr = SCA, AA && Parent, MoveHit
trigger1 = var(53) ;&& EnemyNear, MoveType = H && !EnemyNear, Time
name = "Counter"
ID = 1338000002
stateno = 1338000002
ignorehitpause = 1

[State Counter: Counter Var]
type = Null;VarSet
trigger1 = 1
var(53) = ifelse(EnemyNear, MoveType = A, 1, 0)
;ignorehitpause = 1

;==============================================================================
; Counter Helper
;==============================================================================
[Statedef 295010]
type = S
movetype = I
physics = N

[State 0, PosSet]
type = PosSet
trigger1 = 1
x = 0
y = -3000

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = invisible
ignorehitpause = 1

[State -2, COUNTER CHECK]
type = ParentVarSet
trigger1 = enemy, movetype = A
var(46) = 1
ignorehitpause = 1

[State -2, IDLE STATUS RESET]
type = ParentVarSet
trigger1 = enemy, movetype = I 
var(46) = 0
ignorehitpause = 1

[State -2, COUNTER HIT SUCCESS]
type = ParentVarSet
trigger1 = parent,var(46) = 1 && parent,movehit 
trigger1 = parent,stateno != [190,199] 
trigger1 = parent,stateno != [800,820] 
trigger2 = parent,var(46) = 1
var(47) = 1
ignorehitpause = 1

[State -2, COUNTER RESET]
type = ParentVarSet
trigger1 = enemynear, ctrl = 1
trigger2 = parent,moveguarded
var(47) = 0
ignorehitpause = 1



;---------------------------------------------------------------------------
; = = Death FX
[Statedef 296000]
type = S
movetype=I
physics=N
ctrl = 0
anim = 0
velset = 0,0
sprpriority=5
hitcountpersist=1
poweradd = 0; ifelse(fvar(17)=0,0,0)

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = invisible
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
;trigger1 = roundstate != 4
trigger1 = parent,var(10)=1
flag = nobardisplay
flag2 = nobg
flag3 = nofg
ignorehitpause = 1

[State 0, EnvColor]
type = EnvColor
;trigger1 = parent, life =0
trigger1 = roundstate = 3
;trigger1 = time = 0
;trigger2 = time = 4
;trigger3 = time = 8
;trigger4 = time = 12
value = 200,0,0
time = 3
ignorehitpause = 1
persistent = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = roundstate = 3
value = F29,4
volume = 255
channel = 3
ignorehitpause = 1
persistent = 0

[State 0, EnvShake]
type = EnvShake
;trigger1 = parent, life =0
trigger1 = roundstate = 3
;trigger1 = time = 0
time = 49
freq = 100
ampl = 2
phase = 90
ignorehitpause = 1
persistent = 0

[State 0, overdrive bg]
type = Explod
trigger1 = roundstate = 3
anim = 50000
ID = 50000
pos = 0,0
postype = left
scale = 0.25,0.25
sprpriority = 1
ontop = 0
bindtime=-1
supermove = 1
supermovetime = 999999
pausemovetime = 999999
persistent = 0

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
;value2 = S,NA
time = 1
;ignorehitpause = 
;persistent = 

[State 0, DestroySelf]
type = DestroySelf
trigger1 = roundstate = 3 && enemy,movetype=H
;trigger1 = parent,life=0
;trigger2 = enemynear,life=0
;trigger4 = time = 49
;trigger1 = time = 60
ignorehitpause = 1
persistent = 0

;---------------------------------------------------------------------------
; = = Camera
[Statedef 297000]
type = S
movetype=I
physics=N
ctrl = 0
anim = 0
velset = 0,0
sprpriority=5
hitcountpersist=1
poweradd = 0

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = invisible
ignorehitpause = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 1

[state 0, 1000+ binding]
type = bindtoroot
trigger1 = 1
time = 1
facing = 0
pos = 7,-110

[State 0, ScreenBound]
type = ScreenBound 
trigger1 = 1
value = 0
movecamera = 1,0

[State 0, DestroySelf]
type = DestroySelf
trigger1 = parent,stateno = 7000
ignorehitpause = 1
persistent = 0



;==============================================================================
;==============================================================================
;==============================================================================
;==============================================================================
;==============================================================================
; Back up code
[Statedef 923000]
type = S
movetype = I
physics = N

[State 0, Null]
type = Null
trigger1 =1

; [State -2, Damage Dampener]; Scaling in action
; type= attackmulset
; triggerall=var(27)!=1
; trigger1= numenemy
; value= ifelse(enemynear, gethitvar(hitcount) = 0, 1, ifelse(enemynear, gethitvar(hitcount) = 1, 0.9, 0.8**enemynear, gethitvar(hitcount)))
; ignorehitpause= 1
;
; [State -2, Damage Dampener]; Full damage
; type= attackmulset
; triggerall=var(27)!=1
; trigger1= numenemy
; trigger1= enemynear,movetype!=H || (enemynear,stateno=[120,155])
; trigger2= stateno = 3052 || stateno = 30201 || stateno = 30301 || stateno = 3000 || stateno = 3050
; value= 1.0
; ignorehitpause= 1
;
; [State -2, Damage Dampener (Midnight)]; Scaling in action
; type= attackmulset
; triggerall=var(27)=1
; triggerall=var(11)=0
; trigger1= numenemy
; value= ifelse(enemynear, gethitvar(hitcount) = 0, 1, ifelse(enemynear, gethitvar(hitcount) = 1, 0.9, 0.8**enemynear, gethitvar(hitcount)))
; ignorehitpause= 1
;
; [State -2, Damage Dampener (Midnight)]; Full damage
; type= attackmulset
; triggerall=var(27)=1
; triggerall=var(11)=0
; trigger1= numenemy
; trigger1= enemynear,movetype!=H || (enemynear,stateno=[120,155])
; ;trigger2= stateno = 3052 || stateno = 30201 || stateno = 30301 || stateno = 3000 || stateno = 3050
; value= 1.0
; ignorehitpause= 1
;
; [State -2, Damage Dampener (Midnight+Overdrive)]; Scaling in action
; type= attackmulset
; triggerall=var(27)=1
; triggerall=var(11)=1
; trigger1= numenemy
; value= ifelse(enemynear, gethitvar(hitcount) = 0, 1*(fvar(8)/100), ifelse(enemynear, gethitvar(hitcount) = 1*fvar(8), 0.9*(fvar(8)/100), (0.8*(fvar(8)/100))**enemynear, gethitvar(hitcount)))
; ignorehitpause= 1
;
; [State -2, Damage Dampener(Midnight+Overdrive)]; Full damage
; type= attackmulset
; triggerall=var(27)=1
; triggerall=var(11)=1
; trigger1= numenemy
; trigger1= enemynear,movetype!=H || (enemynear,stateno=[120,155])
; ;;trigger2= stateno = 3052 || stateno = 30201 || stateno = 30301 || stateno = 3000 || stateno = 3050
; value= 1.0*(fvar(8)/100)
; ignorehitpause= 1

;;;;===== CAMERA =====
;;;;==================
;
;[State 0, p1 camera control]
;type = ScreenBound 
;;triggerall = teamside = 1
;trigger1 = var(55)=0
;value = 1
;movecamera = 1,0
;ignorehitpause = 1
;persistent = 1
;
;;[State 0, p2 camera lock]
;;type = ScreenBound 
;;triggerall = teamside = 2
;;trigger1 = 1
;;value = 1
;;movecamera = 1,0
;
;[State 0, camera lock on]
;type = VarSet
;;triggerall = teamside = 1
;trigger1 = statetype != A
;;trigger2 = p2statetype != A
;var(55) = 0
;ignorehitpause = 1
;persistent = 1
;
;[State 0, camera lock off]
;type = VarSet
;;triggerall = teamside = 1
;trigger1 = stateno = 7000 
;;trigger2 = p2stateno = 7000
;;trigger2 = enemy,screenpos y < 0
;var(55) = 1
;ignorehitpause = 1
;persistent = 1